

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pandas.core.groupby &mdash; Pandas Doc</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Pandas Doc" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Pandas Doc
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api1.html">Input/Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#pickling">Pickling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_pickle.html">pandas.read_pickle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#flat-file">Flat File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_table.html">pandas.read_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_csv.html">pandas.read_csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_fwf.html">pandas.read_fwf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#clipboard">Clipboard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_clipboard.html">pandas.read_clipboard</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#excel">Excel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_excel.html">pandas.read_excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.ExcelFile.parse.html">pandas.ExcelFile.parse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#json">JSON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_json.html">pandas.read_json</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.json.json_normalize.html">pandas.io.json.json_normalize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#html">HTML</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_html.html">pandas.read_html</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#hdfstore-pytables-hdf5">HDFStore: PyTables (HDF5)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_hdf.html">pandas.read_hdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.HDFStore.put.html">pandas.HDFStore.put</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.HDFStore.append.html">pandas.HDFStore.append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.HDFStore.get.html">pandas.HDFStore.get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.HDFStore.select.html">pandas.HDFStore.select</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#sas">SAS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_sas.html">pandas.read_sas</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#sql">SQL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_sql_table.html">pandas.read_sql_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_sql_query.html">pandas.read_sql_query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_sql.html">pandas.read_sql</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#google-bigquery">Google BigQuery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.gbq.read_gbq.html">pandas.io.gbq.read_gbq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.gbq.to_gbq.html">pandas.io.gbq.to_gbq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api1.html#stata">STATA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.read_stata.html">pandas.read_stata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.stata.StataReader.data.html">pandas.io.stata.StataReader.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.stata.StataReader.data_label.html">pandas.io.stata.StataReader.data_label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.stata.StataReader.value_labels.html">pandas.io.stata.StataReader.value_labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.stata.StataReader.variable_labels.html">pandas.io.stata.StataReader.variable_labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.io.stata.StataWriter.write_file.html">pandas.io.stata.StataWriter.write_file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api2.html">General functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api2.html#data-manipulations">Data manipulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.melt.html">pandas.melt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.pivot.html">pandas.pivot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.pivot_table.html">pandas.pivot_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.crosstab.html">pandas.crosstab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.cut.html">pandas.cut</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.qcut.html">pandas.qcut</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.merge.html">pandas.merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.merge_ordered.html">pandas.merge_ordered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.merge_asof.html">pandas.merge_asof</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.concat.html">pandas.concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.get_dummies.html">pandas.get_dummies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.factorize.html">pandas.factorize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api2.html#top-level-missing-data">Top-level missing data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.isnull.html">pandas.isnull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.notnull.html">pandas.notnull</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api2.html#top-level-conversions">Top-level conversions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.to_numeric.html">pandas.to_numeric</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api2.html#top-level-dealing-with-datetimelike">Top-level dealing with datetimelike</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.to_datetime.html">pandas.to_datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.to_timedelta.html">pandas.to_timedelta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.date_range.html">pandas.date_range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.bdate_range.html">pandas.bdate_range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.period_range.html">pandas.period_range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.timedelta_range.html">pandas.timedelta_range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.infer_freq.html">pandas.infer_freq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api2.html#top-level-evaluation">Top-level evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.eval.html">pandas.eval</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api2.html#testing">Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.test.html">pandas.test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api3.html">Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#constructor">Constructor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.html">pandas.Series</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#attributes">Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.values.html">pandas.Series.values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dtype.html">pandas.Series.dtype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.ftype.html">pandas.Series.ftype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.shape.html">pandas.Series.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.nbytes.html">pandas.Series.nbytes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.ndim.html">pandas.Series.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.size.html">pandas.Series.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.strides.html">pandas.Series.strides</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.itemsize.html">pandas.Series.itemsize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.base.html">pandas.Series.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.T.html">pandas.Series.T</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.memory_usage.html">pandas.Series.memory_usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.astype.html">pandas.Series.astype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.copy.html">pandas.Series.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.isnull.html">pandas.Series.isnull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.notnull.html">pandas.Series.notnull</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#indexing-iteration">Indexing, iteration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.get.html">pandas.Series.get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.at.html">pandas.Series.at</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.iat.html">pandas.Series.iat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.ix.html">pandas.Series.ix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.loc.html">pandas.Series.loc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.iloc.html">pandas.Series.iloc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.__iter__.html">pandas.Series.__iter__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.iteritems.html">pandas.Series.iteritems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#binary-operator-functions">Binary operator functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.add.html">pandas.Series.add</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sub.html">pandas.Series.sub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.mul.html">pandas.Series.mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.div.html">pandas.Series.div</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.truediv.html">pandas.Series.truediv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.floordiv.html">pandas.Series.floordiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.mod.html">pandas.Series.mod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.pow.html">pandas.Series.pow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.radd.html">pandas.Series.radd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rsub.html">pandas.Series.rsub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rmul.html">pandas.Series.rmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rdiv.html">pandas.Series.rdiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rtruediv.html">pandas.Series.rtruediv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rfloordiv.html">pandas.Series.rfloordiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rmod.html">pandas.Series.rmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rpow.html">pandas.Series.rpow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.combine.html">pandas.Series.combine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.combine_first.html">pandas.Series.combine_first</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.round.html">pandas.Series.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.lt.html">pandas.Series.lt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.gt.html">pandas.Series.gt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.le.html">pandas.Series.le</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.ge.html">pandas.Series.ge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.ne.html">pandas.Series.ne</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.eq.html">pandas.Series.eq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#function-application-groupby-window">Function application, GroupBy &amp; Window</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.apply.html">pandas.Series.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.map.html">pandas.Series.map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.groupby.html">pandas.Series.groupby</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rolling.html">pandas.Series.rolling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.expanding.html">pandas.Series.expanding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.ewm.html">pandas.Series.ewm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#computations-descriptive-stats">Computations / Descriptive Stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.abs.html">pandas.Series.abs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.all.html">pandas.Series.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.any.html">pandas.Series.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.autocorr.html">pandas.Series.autocorr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.between.html">pandas.Series.between</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.clip.html">pandas.Series.clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.clip_lower.html">pandas.Series.clip_lower</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.clip_upper.html">pandas.Series.clip_upper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.corr.html">pandas.Series.corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.count.html">pandas.Series.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cov.html">pandas.Series.cov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cummax.html">pandas.Series.cummax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cummin.html">pandas.Series.cummin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cumprod.html">pandas.Series.cumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cumsum.html">pandas.Series.cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.describe.html">pandas.Series.describe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.diff.html">pandas.Series.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.factorize.html">pandas.Series.factorize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.kurt.html">pandas.Series.kurt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.mad.html">pandas.Series.mad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.max.html">pandas.Series.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.mean.html">pandas.Series.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.median.html">pandas.Series.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.min.html">pandas.Series.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.mode.html">pandas.Series.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.nlargest.html">pandas.Series.nlargest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.nsmallest.html">pandas.Series.nsmallest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.pct_change.html">pandas.Series.pct_change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.prod.html">pandas.Series.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.quantile.html">pandas.Series.quantile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rank.html">pandas.Series.rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sem.html">pandas.Series.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.skew.html">pandas.Series.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.std.html">pandas.Series.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sum.html">pandas.Series.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.var.html">pandas.Series.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.unique.html">pandas.Series.unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.nunique.html">pandas.Series.nunique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.is_unique.html">pandas.Series.is_unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.is_monotonic.html">pandas.Series.is_monotonic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.is_monotonic_increasing.html">pandas.Series.is_monotonic_increasing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.is_monotonic_decreasing.html">pandas.Series.is_monotonic_decreasing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.value_counts.html">pandas.Series.value_counts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#reindexing-selection-label-manipulation">Reindexing / Selection / Label manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.align.html">pandas.Series.align</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.drop.html">pandas.Series.drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.drop_duplicates.html">pandas.Series.drop_duplicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.duplicated.html">pandas.Series.duplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.equals.html">pandas.Series.equals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.first.html">pandas.Series.first</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.head.html">pandas.Series.head</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.idxmax.html">pandas.Series.idxmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.idxmin.html">pandas.Series.idxmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.isin.html">pandas.Series.isin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.last.html">pandas.Series.last</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.reindex.html">pandas.Series.reindex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.reindex_like.html">pandas.Series.reindex_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rename.html">pandas.Series.rename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.rename_axis.html">pandas.Series.rename_axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.reset_index.html">pandas.Series.reset_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sample.html">pandas.Series.sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.select.html">pandas.Series.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.take.html">pandas.Series.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.tail.html">pandas.Series.tail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.truncate.html">pandas.Series.truncate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.where.html">pandas.Series.where</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.mask.html">pandas.Series.mask</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#missing-data-handling">Missing data handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dropna.html">pandas.Series.dropna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.fillna.html">pandas.Series.fillna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.interpolate.html">pandas.Series.interpolate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#reshaping-sorting">Reshaping, sorting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.argsort.html">pandas.Series.argsort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.reorder_levels.html">pandas.Series.reorder_levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sort_values.html">pandas.Series.sort_values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sort_index.html">pandas.Series.sort_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.sortlevel.html">pandas.Series.sortlevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.swaplevel.html">pandas.Series.swaplevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.unstack.html">pandas.Series.unstack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.searchsorted.html">pandas.Series.searchsorted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#combining-joining-merging">Combining / joining / merging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.append.html">pandas.Series.append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.replace.html">pandas.Series.replace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.update.html">pandas.Series.update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#time-series-related">Time series-related</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.asfreq.html">pandas.Series.asfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.asof.html">pandas.Series.asof</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.shift.html">pandas.Series.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.first_valid_index.html">pandas.Series.first_valid_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.last_valid_index.html">pandas.Series.last_valid_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.resample.html">pandas.Series.resample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.tz_convert.html">pandas.Series.tz_convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.tz_localize.html">pandas.Series.tz_localize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#datetimelike-properties">Datetimelike Properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.date.html">pandas.Series.dt.date</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.time.html">pandas.Series.dt.time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.year.html">pandas.Series.dt.year</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.month.html">pandas.Series.dt.month</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.day.html">pandas.Series.dt.day</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.hour.html">pandas.Series.dt.hour</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.minute.html">pandas.Series.dt.minute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.second.html">pandas.Series.dt.second</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.microsecond.html">pandas.Series.dt.microsecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.nanosecond.html">pandas.Series.dt.nanosecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.week.html">pandas.Series.dt.week</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.weekofyear.html">pandas.Series.dt.weekofyear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.dayofweek.html">pandas.Series.dt.dayofweek</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.weekday.html">pandas.Series.dt.weekday</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.weekday_name.html">pandas.Series.dt.weekday_name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.dayofyear.html">pandas.Series.dt.dayofyear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.quarter.html">pandas.Series.dt.quarter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_month_start.html">pandas.Series.dt.is_month_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_month_end.html">pandas.Series.dt.is_month_end</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_quarter_start.html">pandas.Series.dt.is_quarter_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_quarter_end.html">pandas.Series.dt.is_quarter_end</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_year_start.html">pandas.Series.dt.is_year_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_year_end.html">pandas.Series.dt.is_year_end</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.is_leap_year.html">pandas.Series.dt.is_leap_year</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.daysinmonth.html">pandas.Series.dt.daysinmonth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.days_in_month.html">pandas.Series.dt.days_in_month</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.tz.html">pandas.Series.dt.tz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.freq.html">pandas.Series.dt.freq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.to_period.html">pandas.Series.dt.to_period</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.to_pydatetime.html">pandas.Series.dt.to_pydatetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.tz_localize.html">pandas.Series.dt.tz_localize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.tz_convert.html">pandas.Series.dt.tz_convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.normalize.html">pandas.Series.dt.normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.strftime.html">pandas.Series.dt.strftime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.round.html">pandas.Series.dt.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.floor.html">pandas.Series.dt.floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.ceil.html">pandas.Series.dt.ceil</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.days.html">pandas.Series.dt.days</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.seconds.html">pandas.Series.dt.seconds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.microseconds.html">pandas.Series.dt.microseconds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.nanoseconds.html">pandas.Series.dt.nanoseconds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.components.html">pandas.Series.dt.components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.to_pytimedelta.html">pandas.Series.dt.to_pytimedelta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.dt.total_seconds.html">pandas.Series.dt.total_seconds</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#string-handling">String handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.capitalize.html">pandas.Series.str.capitalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.cat.html">pandas.Series.str.cat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.center.html">pandas.Series.str.center</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.contains.html">pandas.Series.str.contains</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.count.html">pandas.Series.str.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.decode.html">pandas.Series.str.decode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.encode.html">pandas.Series.str.encode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.endswith.html">pandas.Series.str.endswith</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.extract.html">pandas.Series.str.extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.extractall.html">pandas.Series.str.extractall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.find.html">pandas.Series.str.find</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.findall.html">pandas.Series.str.findall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.get.html">pandas.Series.str.get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.index.html">pandas.Series.str.index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.join.html">pandas.Series.str.join</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.len.html">pandas.Series.str.len</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.ljust.html">pandas.Series.str.ljust</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.lower.html">pandas.Series.str.lower</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.lstrip.html">pandas.Series.str.lstrip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.match.html">pandas.Series.str.match</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.normalize.html">pandas.Series.str.normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.pad.html">pandas.Series.str.pad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.partition.html">pandas.Series.str.partition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.repeat.html">pandas.Series.str.repeat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.replace.html">pandas.Series.str.replace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.rfind.html">pandas.Series.str.rfind</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.rindex.html">pandas.Series.str.rindex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.rjust.html">pandas.Series.str.rjust</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.rpartition.html">pandas.Series.str.rpartition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.rstrip.html">pandas.Series.str.rstrip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.slice.html">pandas.Series.str.slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.slice_replace.html">pandas.Series.str.slice_replace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.split.html">pandas.Series.str.split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.rsplit.html">pandas.Series.str.rsplit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.startswith.html">pandas.Series.str.startswith</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.strip.html">pandas.Series.str.strip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.swapcase.html">pandas.Series.str.swapcase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.title.html">pandas.Series.str.title</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.translate.html">pandas.Series.str.translate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.upper.html">pandas.Series.str.upper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.wrap.html">pandas.Series.str.wrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.zfill.html">pandas.Series.str.zfill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isalnum.html">pandas.Series.str.isalnum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isalpha.html">pandas.Series.str.isalpha</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isdigit.html">pandas.Series.str.isdigit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isspace.html">pandas.Series.str.isspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.islower.html">pandas.Series.str.islower</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isupper.html">pandas.Series.str.isupper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.istitle.html">pandas.Series.str.istitle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isnumeric.html">pandas.Series.str.isnumeric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.isdecimal.html">pandas.Series.str.isdecimal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.str.get_dummies.html">pandas.Series.str.get_dummies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#categorical">Categorical</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.categories.html">pandas.Series.cat.categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.ordered.html">pandas.Series.cat.ordered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.codes.html">pandas.Series.cat.codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.rename_categories.html">pandas.Series.cat.rename_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.reorder_categories.html">pandas.Series.cat.reorder_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.add_categories.html">pandas.Series.cat.add_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.remove_categories.html">pandas.Series.cat.remove_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.remove_unused_categories.html">pandas.Series.cat.remove_unused_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.set_categories.html">pandas.Series.cat.set_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.as_ordered.html">pandas.Series.cat.as_ordered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.cat.as_unordered.html">pandas.Series.cat.as_unordered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Categorical.html">pandas.Categorical</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Categorical.from_codes.html">pandas.Categorical.from_codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Categorical.__array__.html">pandas.Categorical.__array__</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#plotting">Plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.html">pandas.Series.plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.area.html">pandas.Series.plot.area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.bar.html">pandas.Series.plot.bar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.barh.html">pandas.Series.plot.barh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.box.html">pandas.Series.plot.box</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.density.html">pandas.Series.plot.density</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.hist.html">pandas.Series.plot.hist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.kde.html">pandas.Series.plot.kde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.line.html">pandas.Series.plot.line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.plot.pie.html">pandas.Series.plot.pie</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.hist.html">pandas.Series.hist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#serialization-io-conversion">Serialization / IO / Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.from_csv.html">pandas.Series.from_csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_pickle.html">pandas.Series.to_pickle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_csv.html">pandas.Series.to_csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_dict.html">pandas.Series.to_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_frame.html">pandas.Series.to_frame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_xarray.html">pandas.Series.to_xarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_hdf.html">pandas.Series.to_hdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_sql.html">pandas.Series.to_sql</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_msgpack.html">pandas.Series.to_msgpack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_json.html">pandas.Series.to_json</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_sparse.html">pandas.Series.to_sparse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_dense.html">pandas.Series.to_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_string.html">pandas.Series.to_string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Series.to_clipboard.html">pandas.Series.to_clipboard</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api3.html#sparse-methods">Sparse methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.SparseSeries.to_coo.html">pandas.SparseSeries.to_coo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.SparseSeries.from_coo.html">pandas.SparseSeries.from_coo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api4.html">DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#constructor">Constructor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.html">pandas.DataFrame</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#attributes-and-underlying-data">Attributes and underlying data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.as_matrix.html">pandas.DataFrame.as_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.dtypes.html">pandas.DataFrame.dtypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.ftypes.html">pandas.DataFrame.ftypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.get_dtype_counts.html">pandas.DataFrame.get_dtype_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.get_ftype_counts.html">pandas.DataFrame.get_ftype_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.select_dtypes.html">pandas.DataFrame.select_dtypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.values.html">pandas.DataFrame.values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.axes.html">pandas.DataFrame.axes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.ndim.html">pandas.DataFrame.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.size.html">pandas.DataFrame.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.shape.html">pandas.DataFrame.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.memory_usage.html">pandas.DataFrame.memory_usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.astype.html">pandas.DataFrame.astype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.convert_objects.html">pandas.DataFrame.convert_objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.copy.html">pandas.DataFrame.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.isnull.html">pandas.DataFrame.isnull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.notnull.html">pandas.DataFrame.notnull</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#indexing-iteration">Indexing, iteration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.head.html">pandas.DataFrame.head</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.at.html">pandas.DataFrame.at</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.iat.html">pandas.DataFrame.iat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.ix.html">pandas.DataFrame.ix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.loc.html">pandas.DataFrame.loc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.iloc.html">pandas.DataFrame.iloc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.insert.html">pandas.DataFrame.insert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.__iter__.html">pandas.DataFrame.__iter__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.iteritems.html">pandas.DataFrame.iteritems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.iterrows.html">pandas.DataFrame.iterrows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.itertuples.html">pandas.DataFrame.itertuples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.lookup.html">pandas.DataFrame.lookup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.pop.html">pandas.DataFrame.pop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.tail.html">pandas.DataFrame.tail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.xs.html">pandas.DataFrame.xs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.isin.html">pandas.DataFrame.isin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.where.html">pandas.DataFrame.where</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.mask.html">pandas.DataFrame.mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.query.html">pandas.DataFrame.query</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#binary-operator-functions">Binary operator functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.add.html">pandas.DataFrame.add</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sub.html">pandas.DataFrame.sub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.mul.html">pandas.DataFrame.mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.div.html">pandas.DataFrame.div</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.truediv.html">pandas.DataFrame.truediv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.floordiv.html">pandas.DataFrame.floordiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.mod.html">pandas.DataFrame.mod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.pow.html">pandas.DataFrame.pow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.radd.html">pandas.DataFrame.radd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rsub.html">pandas.DataFrame.rsub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rmul.html">pandas.DataFrame.rmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rdiv.html">pandas.DataFrame.rdiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rtruediv.html">pandas.DataFrame.rtruediv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rfloordiv.html">pandas.DataFrame.rfloordiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rmod.html">pandas.DataFrame.rmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rpow.html">pandas.DataFrame.rpow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.lt.html">pandas.DataFrame.lt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.gt.html">pandas.DataFrame.gt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.le.html">pandas.DataFrame.le</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.ge.html">pandas.DataFrame.ge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.ne.html">pandas.DataFrame.ne</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.eq.html">pandas.DataFrame.eq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.combine.html">pandas.DataFrame.combine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.combine_first.html">pandas.DataFrame.combine_first</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#function-application-groupby-window">Function application, GroupBy &amp; Window</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.apply.html">pandas.DataFrame.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.applymap.html">pandas.DataFrame.applymap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.groupby.html">pandas.DataFrame.groupby</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rolling.html">pandas.DataFrame.rolling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.expanding.html">pandas.DataFrame.expanding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.ewm.html">pandas.DataFrame.ewm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#computations-descriptive-stats">Computations / Descriptive Stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.abs.html">pandas.DataFrame.abs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.all.html">pandas.DataFrame.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.any.html">pandas.DataFrame.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.clip.html">pandas.DataFrame.clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.clip_lower.html">pandas.DataFrame.clip_lower</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.clip_upper.html">pandas.DataFrame.clip_upper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.corr.html">pandas.DataFrame.corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.corrwith.html">pandas.DataFrame.corrwith</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.count.html">pandas.DataFrame.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.cov.html">pandas.DataFrame.cov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.cummax.html">pandas.DataFrame.cummax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.cummin.html">pandas.DataFrame.cummin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.cumprod.html">pandas.DataFrame.cumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.cumsum.html">pandas.DataFrame.cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.describe.html">pandas.DataFrame.describe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.diff.html">pandas.DataFrame.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.eval.html">pandas.DataFrame.eval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.kurt.html">pandas.DataFrame.kurt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.mad.html">pandas.DataFrame.mad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.max.html">pandas.DataFrame.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.mean.html">pandas.DataFrame.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.median.html">pandas.DataFrame.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.min.html">pandas.DataFrame.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.mode.html">pandas.DataFrame.mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.pct_change.html">pandas.DataFrame.pct_change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.prod.html">pandas.DataFrame.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.quantile.html">pandas.DataFrame.quantile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rank.html">pandas.DataFrame.rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.round.html">pandas.DataFrame.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sem.html">pandas.DataFrame.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.skew.html">pandas.DataFrame.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sum.html">pandas.DataFrame.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.std.html">pandas.DataFrame.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.var.html">pandas.DataFrame.var</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#reindexing-selection-label-manipulation">Reindexing / Selection / Label manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.add_prefix.html">pandas.DataFrame.add_prefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.add_suffix.html">pandas.DataFrame.add_suffix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.align.html">pandas.DataFrame.align</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.drop.html">pandas.DataFrame.drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.drop_duplicates.html">pandas.DataFrame.drop_duplicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.duplicated.html">pandas.DataFrame.duplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.equals.html">pandas.DataFrame.equals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.filter.html">pandas.DataFrame.filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.first.html">pandas.DataFrame.first</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.head.html">pandas.DataFrame.head</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.idxmax.html">pandas.DataFrame.idxmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.idxmin.html">pandas.DataFrame.idxmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.last.html">pandas.DataFrame.last</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.reindex.html">pandas.DataFrame.reindex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.reindex_axis.html">pandas.DataFrame.reindex_axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.reindex_like.html">pandas.DataFrame.reindex_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rename.html">pandas.DataFrame.rename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.rename_axis.html">pandas.DataFrame.rename_axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.reset_index.html">pandas.DataFrame.reset_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sample.html">pandas.DataFrame.sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.select.html">pandas.DataFrame.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.set_index.html">pandas.DataFrame.set_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.tail.html">pandas.DataFrame.tail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.take.html">pandas.DataFrame.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.truncate.html">pandas.DataFrame.truncate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#missing-data-handling">Missing data handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.dropna.html">pandas.DataFrame.dropna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.fillna.html">pandas.DataFrame.fillna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.replace.html">pandas.DataFrame.replace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#reshaping-sorting-transposing">Reshaping, sorting, transposing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.pivot.html">pandas.DataFrame.pivot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.reorder_levels.html">pandas.DataFrame.reorder_levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sort_values.html">pandas.DataFrame.sort_values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sort_index.html">pandas.DataFrame.sort_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.sortlevel.html">pandas.DataFrame.sortlevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.nlargest.html">pandas.DataFrame.nlargest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.nsmallest.html">pandas.DataFrame.nsmallest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.swaplevel.html">pandas.DataFrame.swaplevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.stack.html">pandas.DataFrame.stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.unstack.html">pandas.DataFrame.unstack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.T.html">pandas.DataFrame.T</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_panel.html">pandas.DataFrame.to_panel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_xarray.html">pandas.DataFrame.to_xarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.transpose.html">pandas.DataFrame.transpose</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#combining-joining-merging">Combining / joining / merging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.append.html">pandas.DataFrame.append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.assign.html">pandas.DataFrame.assign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.join.html">pandas.DataFrame.join</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.merge.html">pandas.DataFrame.merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.update.html">pandas.DataFrame.update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#time-series-related">Time series-related</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.asfreq.html">pandas.DataFrame.asfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.asof.html">pandas.DataFrame.asof</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.shift.html">pandas.DataFrame.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.first_valid_index.html">pandas.DataFrame.first_valid_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.last_valid_index.html">pandas.DataFrame.last_valid_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.resample.html">pandas.DataFrame.resample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_period.html">pandas.DataFrame.to_period</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_timestamp.html">pandas.DataFrame.to_timestamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.tz_convert.html">pandas.DataFrame.tz_convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.tz_localize.html">pandas.DataFrame.tz_localize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#plotting">Plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.html">pandas.DataFrame.plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.area.html">pandas.DataFrame.plot.area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.bar.html">pandas.DataFrame.plot.bar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.barh.html">pandas.DataFrame.plot.barh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.box.html">pandas.DataFrame.plot.box</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.density.html">pandas.DataFrame.plot.density</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.hexbin.html">pandas.DataFrame.plot.hexbin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.hist.html">pandas.DataFrame.plot.hist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.kde.html">pandas.DataFrame.plot.kde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.line.html">pandas.DataFrame.plot.line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.pie.html">pandas.DataFrame.plot.pie</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.plot.scatter.html">pandas.DataFrame.plot.scatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.boxplot.html">pandas.DataFrame.boxplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.hist.html">pandas.DataFrame.hist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api4.html#serialization-io-conversion">Serialization / IO / Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.from_csv.html">pandas.DataFrame.from_csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.from_dict.html">pandas.DataFrame.from_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.from_items.html">pandas.DataFrame.from_items</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.from_records.html">pandas.DataFrame.from_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.info.html">pandas.DataFrame.info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_pickle.html">pandas.DataFrame.to_pickle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_csv.html">pandas.DataFrame.to_csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_hdf.html">pandas.DataFrame.to_hdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_sql.html">pandas.DataFrame.to_sql</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_dict.html">pandas.DataFrame.to_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_excel.html">pandas.DataFrame.to_excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_json.html">pandas.DataFrame.to_json</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_html.html">pandas.DataFrame.to_html</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_latex.html">pandas.DataFrame.to_latex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_stata.html">pandas.DataFrame.to_stata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_msgpack.html">pandas.DataFrame.to_msgpack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_gbq.html">pandas.DataFrame.to_gbq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_records.html">pandas.DataFrame.to_records</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_sparse.html">pandas.DataFrame.to_sparse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_dense.html">pandas.DataFrame.to_dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_string.html">pandas.DataFrame.to_string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DataFrame.to_clipboard.html">pandas.DataFrame.to_clipboard</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api5.html">Panel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#constructor">Constructor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.html">pandas.Panel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#attributes-and-underlying-data">Attributes and underlying data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.values.html">pandas.Panel.values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.axes.html">pandas.Panel.axes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.ndim.html">pandas.Panel.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.size.html">pandas.Panel.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.shape.html">pandas.Panel.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.dtypes.html">pandas.Panel.dtypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.ftypes.html">pandas.Panel.ftypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.get_dtype_counts.html">pandas.Panel.get_dtype_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.get_ftype_counts.html">pandas.Panel.get_ftype_counts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.astype.html">pandas.Panel.astype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.copy.html">pandas.Panel.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.isnull.html">pandas.Panel.isnull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.notnull.html">pandas.Panel.notnull</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#getting-and-setting">Getting and setting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.get_value.html">pandas.Panel.get_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.set_value.html">pandas.Panel.set_value</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#indexing-iteration-slicing">Indexing, iteration, slicing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.at.html">pandas.Panel.at</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.iat.html">pandas.Panel.iat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.ix.html">pandas.Panel.ix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.loc.html">pandas.Panel.loc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.iloc.html">pandas.Panel.iloc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.__iter__.html">pandas.Panel.__iter__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.iteritems.html">pandas.Panel.iteritems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.pop.html">pandas.Panel.pop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.xs.html">pandas.Panel.xs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.major_xs.html">pandas.Panel.major_xs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.minor_xs.html">pandas.Panel.minor_xs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#binary-operator-functions">Binary operator functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.add.html">pandas.Panel.add</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.sub.html">pandas.Panel.sub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.mul.html">pandas.Panel.mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.div.html">pandas.Panel.div</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.truediv.html">pandas.Panel.truediv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.floordiv.html">pandas.Panel.floordiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.mod.html">pandas.Panel.mod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.pow.html">pandas.Panel.pow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.radd.html">pandas.Panel.radd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rsub.html">pandas.Panel.rsub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rmul.html">pandas.Panel.rmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rdiv.html">pandas.Panel.rdiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rtruediv.html">pandas.Panel.rtruediv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rfloordiv.html">pandas.Panel.rfloordiv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rmod.html">pandas.Panel.rmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rpow.html">pandas.Panel.rpow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.lt.html">pandas.Panel.lt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.gt.html">pandas.Panel.gt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.le.html">pandas.Panel.le</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.ge.html">pandas.Panel.ge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.ne.html">pandas.Panel.ne</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.eq.html">pandas.Panel.eq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#function-application-groupby">Function application, GroupBy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.apply.html">pandas.Panel.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.groupby.html">pandas.Panel.groupby</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#computations-descriptive-stats">Computations / Descriptive Stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.abs.html">pandas.Panel.abs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.clip.html">pandas.Panel.clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.clip_lower.html">pandas.Panel.clip_lower</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.clip_upper.html">pandas.Panel.clip_upper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.count.html">pandas.Panel.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.cummax.html">pandas.Panel.cummax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.cummin.html">pandas.Panel.cummin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.cumprod.html">pandas.Panel.cumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.cumsum.html">pandas.Panel.cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.max.html">pandas.Panel.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.mean.html">pandas.Panel.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.median.html">pandas.Panel.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.min.html">pandas.Panel.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.pct_change.html">pandas.Panel.pct_change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.prod.html">pandas.Panel.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.sem.html">pandas.Panel.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.skew.html">pandas.Panel.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.sum.html">pandas.Panel.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.std.html">pandas.Panel.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.var.html">pandas.Panel.var</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#reindexing-selection-label-manipulation">Reindexing / Selection / Label manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.add_prefix.html">pandas.Panel.add_prefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.add_suffix.html">pandas.Panel.add_suffix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.drop.html">pandas.Panel.drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.equals.html">pandas.Panel.equals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.filter.html">pandas.Panel.filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.first.html">pandas.Panel.first</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.last.html">pandas.Panel.last</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.reindex.html">pandas.Panel.reindex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.reindex_axis.html">pandas.Panel.reindex_axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.reindex_like.html">pandas.Panel.reindex_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.rename.html">pandas.Panel.rename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.sample.html">pandas.Panel.sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.select.html">pandas.Panel.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.take.html">pandas.Panel.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.truncate.html">pandas.Panel.truncate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#missing-data-handling">Missing data handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.dropna.html">pandas.Panel.dropna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.fillna.html">pandas.Panel.fillna</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#reshaping-sorting-transposing">Reshaping, sorting, transposing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.sort_index.html">pandas.Panel.sort_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.swaplevel.html">pandas.Panel.swaplevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.transpose.html">pandas.Panel.transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.swapaxes.html">pandas.Panel.swapaxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.conform.html">pandas.Panel.conform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#combining-joining-merging">Combining / joining / merging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.join.html">pandas.Panel.join</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.update.html">pandas.Panel.update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#time-series-related">Time series-related</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.asfreq.html">pandas.Panel.asfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.shift.html">pandas.Panel.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.resample.html">pandas.Panel.resample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.tz_convert.html">pandas.Panel.tz_convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.tz_localize.html">pandas.Panel.tz_localize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api5.html#serialization-io-conversion">Serialization / IO / Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.from_dict.html">pandas.Panel.from_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_pickle.html">pandas.Panel.to_pickle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_excel.html">pandas.Panel.to_excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_hdf.html">pandas.Panel.to_hdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_sparse.html">pandas.Panel.to_sparse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_frame.html">pandas.Panel.to_frame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_xarray.html">pandas.Panel.to_xarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel.to_clipboard.html">pandas.Panel.to_clipboard</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api6.html">Panel4D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api6.html#constructor">Constructor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.html">pandas.Panel4D</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api6.html#serialization-io-conversion">Serialization / IO / Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.to_xarray.html">pandas.Panel4D.to_xarray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api6.html#attributes-and-underlying-data">Attributes and underlying data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.values.html">pandas.Panel4D.values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.axes.html">pandas.Panel4D.axes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.ndim.html">pandas.Panel4D.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.size.html">pandas.Panel4D.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.shape.html">pandas.Panel4D.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.dtypes.html">pandas.Panel4D.dtypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.ftypes.html">pandas.Panel4D.ftypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.get_dtype_counts.html">pandas.Panel4D.get_dtype_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.get_ftype_counts.html">pandas.Panel4D.get_ftype_counts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api6.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.astype.html">pandas.Panel4D.astype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.copy.html">pandas.Panel4D.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.isnull.html">pandas.Panel4D.isnull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Panel4D.notnull.html">pandas.Panel4D.notnull</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api7.html">Index</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/pandas.Index.html">pandas.Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#attributes">Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.values.html">pandas.Index.values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.is_monotonic.html">pandas.Index.is_monotonic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.is_monotonic_increasing.html">pandas.Index.is_monotonic_increasing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.is_monotonic_decreasing.html">pandas.Index.is_monotonic_decreasing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.is_unique.html">pandas.Index.is_unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.has_duplicates.html">pandas.Index.has_duplicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.dtype.html">pandas.Index.dtype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.inferred_type.html">pandas.Index.inferred_type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.is_all_dates.html">pandas.Index.is_all_dates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.shape.html">pandas.Index.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.nbytes.html">pandas.Index.nbytes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.ndim.html">pandas.Index.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.size.html">pandas.Index.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.strides.html">pandas.Index.strides</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.itemsize.html">pandas.Index.itemsize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.base.html">pandas.Index.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.T.html">pandas.Index.T</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.memory_usage.html">pandas.Index.memory_usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#modifying-and-computations">Modifying and Computations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.all.html">pandas.Index.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.any.html">pandas.Index.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.argmin.html">pandas.Index.argmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.argmax.html">pandas.Index.argmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.copy.html">pandas.Index.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.delete.html">pandas.Index.delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.drop.html">pandas.Index.drop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.drop_duplicates.html">pandas.Index.drop_duplicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.duplicated.html">pandas.Index.duplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.equals.html">pandas.Index.equals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.factorize.html">pandas.Index.factorize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.identical.html">pandas.Index.identical</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.insert.html">pandas.Index.insert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.min.html">pandas.Index.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.max.html">pandas.Index.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.reindex.html">pandas.Index.reindex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.repeat.html">pandas.Index.repeat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.where.html">pandas.Index.where</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.take.html">pandas.Index.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.putmask.html">pandas.Index.putmask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.set_names.html">pandas.Index.set_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.unique.html">pandas.Index.unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.nunique.html">pandas.Index.nunique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.value_counts.html">pandas.Index.value_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.fillna.html">pandas.Index.fillna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.dropna.html">pandas.Index.dropna</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.astype.html">pandas.Index.astype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.tolist.html">pandas.Index.tolist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.to_datetime.html">pandas.Index.to_datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.to_series.html">pandas.Index.to_series</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#sorting">Sorting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.argsort.html">pandas.Index.argsort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.sort_values.html">pandas.Index.sort_values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#time-specific-operations">Time-specific operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.shift.html">pandas.Index.shift</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#combining-joining-set-operations">Combining / joining / set operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.append.html">pandas.Index.append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.join.html">pandas.Index.join</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.intersection.html">pandas.Index.intersection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.union.html">pandas.Index.union</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.difference.html">pandas.Index.difference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.symmetric_difference.html">pandas.Index.symmetric_difference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api7.html#selecting">Selecting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.get_indexer.html">pandas.Index.get_indexer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.get_indexer_non_unique.html">pandas.Index.get_indexer_non_unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.get_level_values.html">pandas.Index.get_level_values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.get_loc.html">pandas.Index.get_loc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.get_value.html">pandas.Index.get_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.isin.html">pandas.Index.isin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.slice_indexer.html">pandas.Index.slice_indexer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Index.slice_locs.html">pandas.Index.slice_locs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api8.html">CategoricalIndex</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.html">pandas.CategoricalIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api8.html#categorical-components">Categorical Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.codes.html">pandas.CategoricalIndex.codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.categories.html">pandas.CategoricalIndex.categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.ordered.html">pandas.CategoricalIndex.ordered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.rename_categories.html">pandas.CategoricalIndex.rename_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.reorder_categories.html">pandas.CategoricalIndex.reorder_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.add_categories.html">pandas.CategoricalIndex.add_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.remove_categories.html">pandas.CategoricalIndex.remove_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.remove_unused_categories.html">pandas.CategoricalIndex.remove_unused_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.set_categories.html">pandas.CategoricalIndex.set_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.as_ordered.html">pandas.CategoricalIndex.as_ordered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.CategoricalIndex.as_unordered.html">pandas.CategoricalIndex.as_unordered</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api9.html">MultiIndex</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/pandas.MultiIndex.html">pandas.MultiIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api9.html#multiindex-components">MultiIndex Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.from_arrays.html">pandas.MultiIndex.from_arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.from_tuples.html">pandas.MultiIndex.from_tuples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.from_product.html">pandas.MultiIndex.from_product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.set_levels.html">pandas.MultiIndex.set_levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.set_labels.html">pandas.MultiIndex.set_labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.to_hierarchical.html">pandas.MultiIndex.to_hierarchical</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.is_lexsorted.html">pandas.MultiIndex.is_lexsorted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.droplevel.html">pandas.MultiIndex.droplevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.swaplevel.html">pandas.MultiIndex.swaplevel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.MultiIndex.reorder_levels.html">pandas.MultiIndex.reorder_levels</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api10.html">DatetimeIndex</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.html">pandas.DatetimeIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api10.html#time-date-components">Time/Date Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.year.html">pandas.DatetimeIndex.year</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.month.html">pandas.DatetimeIndex.month</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.day.html">pandas.DatetimeIndex.day</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.hour.html">pandas.DatetimeIndex.hour</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.minute.html">pandas.DatetimeIndex.minute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.second.html">pandas.DatetimeIndex.second</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.microsecond.html">pandas.DatetimeIndex.microsecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.nanosecond.html">pandas.DatetimeIndex.nanosecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.date.html">pandas.DatetimeIndex.date</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.time.html">pandas.DatetimeIndex.time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.dayofyear.html">pandas.DatetimeIndex.dayofyear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.weekofyear.html">pandas.DatetimeIndex.weekofyear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.week.html">pandas.DatetimeIndex.week</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.dayofweek.html">pandas.DatetimeIndex.dayofweek</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.weekday.html">pandas.DatetimeIndex.weekday</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.weekday_name.html">pandas.DatetimeIndex.weekday_name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.quarter.html">pandas.DatetimeIndex.quarter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.tz.html">pandas.DatetimeIndex.tz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.freq.html">pandas.DatetimeIndex.freq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.freqstr.html">pandas.DatetimeIndex.freqstr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_month_start.html">pandas.DatetimeIndex.is_month_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_month_end.html">pandas.DatetimeIndex.is_month_end</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_quarter_start.html">pandas.DatetimeIndex.is_quarter_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_quarter_end.html">pandas.DatetimeIndex.is_quarter_end</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_year_start.html">pandas.DatetimeIndex.is_year_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_year_end.html">pandas.DatetimeIndex.is_year_end</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.is_leap_year.html">pandas.DatetimeIndex.is_leap_year</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.inferred_freq.html">pandas.DatetimeIndex.inferred_freq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api10.html#selecting">Selecting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.indexer_at_time.html">pandas.DatetimeIndex.indexer_at_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.indexer_between_time.html">pandas.DatetimeIndex.indexer_between_time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api10.html#time-specific-operations">Time-specific operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.normalize.html">pandas.DatetimeIndex.normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.strftime.html">pandas.DatetimeIndex.strftime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.snap.html">pandas.DatetimeIndex.snap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.tz_convert.html">pandas.DatetimeIndex.tz_convert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.tz_localize.html">pandas.DatetimeIndex.tz_localize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.round.html">pandas.DatetimeIndex.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.floor.html">pandas.DatetimeIndex.floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.ceil.html">pandas.DatetimeIndex.ceil</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api10.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.to_datetime.html">pandas.DatetimeIndex.to_datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.to_period.html">pandas.DatetimeIndex.to_period</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.to_perioddelta.html">pandas.DatetimeIndex.to_perioddelta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.to_pydatetime.html">pandas.DatetimeIndex.to_pydatetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.DatetimeIndex.to_series.html">pandas.DatetimeIndex.to_series</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api11.html">TimedeltaIndex</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.html">pandas.TimedeltaIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api11.html#components">Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.days.html">pandas.TimedeltaIndex.days</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.seconds.html">pandas.TimedeltaIndex.seconds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.microseconds.html">pandas.TimedeltaIndex.microseconds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.nanoseconds.html">pandas.TimedeltaIndex.nanoseconds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.components.html">pandas.TimedeltaIndex.components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.inferred_freq.html">pandas.TimedeltaIndex.inferred_freq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api11.html#conversion">Conversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.to_pytimedelta.html">pandas.TimedeltaIndex.to_pytimedelta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.to_series.html">pandas.TimedeltaIndex.to_series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.round.html">pandas.TimedeltaIndex.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.floor.html">pandas.TimedeltaIndex.floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.TimedeltaIndex.ceil.html">pandas.TimedeltaIndex.ceil</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api12.html">Window</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api12.html#standard-moving-window-functions">Standard moving window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.count.html">pandas.core.window.Rolling.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.sum.html">pandas.core.window.Rolling.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.mean.html">pandas.core.window.Rolling.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.median.html">pandas.core.window.Rolling.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.var.html">pandas.core.window.Rolling.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.std.html">pandas.core.window.Rolling.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.min.html">pandas.core.window.Rolling.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.max.html">pandas.core.window.Rolling.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.corr.html">pandas.core.window.Rolling.corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.cov.html">pandas.core.window.Rolling.cov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.skew.html">pandas.core.window.Rolling.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.kurt.html">pandas.core.window.Rolling.kurt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.apply.html">pandas.core.window.Rolling.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Rolling.quantile.html">pandas.core.window.Rolling.quantile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Window.mean.html">pandas.core.window.Window.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Window.sum.html">pandas.core.window.Window.sum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api12.html#standard-expanding-window-functions">Standard expanding window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.count.html">pandas.core.window.Expanding.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.sum.html">pandas.core.window.Expanding.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.mean.html">pandas.core.window.Expanding.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.median.html">pandas.core.window.Expanding.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.var.html">pandas.core.window.Expanding.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.std.html">pandas.core.window.Expanding.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.min.html">pandas.core.window.Expanding.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.max.html">pandas.core.window.Expanding.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.corr.html">pandas.core.window.Expanding.corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.cov.html">pandas.core.window.Expanding.cov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.skew.html">pandas.core.window.Expanding.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.kurt.html">pandas.core.window.Expanding.kurt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.apply.html">pandas.core.window.Expanding.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.Expanding.quantile.html">pandas.core.window.Expanding.quantile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api12.html#exponentially-weighted-moving-window-functions">Exponentially-weighted moving window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.EWM.mean.html">pandas.core.window.EWM.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.EWM.std.html">pandas.core.window.EWM.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.EWM.var.html">pandas.core.window.EWM.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.EWM.corr.html">pandas.core.window.EWM.corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.window.EWM.cov.html">pandas.core.window.EWM.cov</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api13.html">GroupBy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api13.html#indexing-iteration">Indexing, iteration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.__iter__.html">pandas.core.groupby.GroupBy.__iter__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.groups.html">pandas.core.groupby.GroupBy.groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.indices.html">pandas.core.groupby.GroupBy.indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.get_group.html">pandas.core.groupby.GroupBy.get_group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.Grouper.html">pandas.Grouper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api13.html#function-application">Function application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.apply.html">pandas.core.groupby.GroupBy.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.aggregate.html">pandas.core.groupby.GroupBy.aggregate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.transform.html">pandas.core.groupby.GroupBy.transform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api13.html#computations-descriptive-stats">Computations / Descriptive Stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.count.html">pandas.core.groupby.GroupBy.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.cumcount.html">pandas.core.groupby.GroupBy.cumcount</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.first.html">pandas.core.groupby.GroupBy.first</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.head.html">pandas.core.groupby.GroupBy.head</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.last.html">pandas.core.groupby.GroupBy.last</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.max.html">pandas.core.groupby.GroupBy.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.mean.html">pandas.core.groupby.GroupBy.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.median.html">pandas.core.groupby.GroupBy.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.min.html">pandas.core.groupby.GroupBy.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.nth.html">pandas.core.groupby.GroupBy.nth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.ohlc.html">pandas.core.groupby.GroupBy.ohlc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.prod.html">pandas.core.groupby.GroupBy.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.size.html">pandas.core.groupby.GroupBy.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.sem.html">pandas.core.groupby.GroupBy.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.std.html">pandas.core.groupby.GroupBy.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.sum.html">pandas.core.groupby.GroupBy.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.var.html">pandas.core.groupby.GroupBy.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.GroupBy.tail.html">pandas.core.groupby.GroupBy.tail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.agg.html">pandas.core.groupby.DataFrameGroupBy.agg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.all.html">pandas.core.groupby.DataFrameGroupBy.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.any.html">pandas.core.groupby.DataFrameGroupBy.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.bfill.html">pandas.core.groupby.DataFrameGroupBy.bfill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.corr.html">pandas.core.groupby.DataFrameGroupBy.corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.count.html">pandas.core.groupby.DataFrameGroupBy.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.cov.html">pandas.core.groupby.DataFrameGroupBy.cov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.cummax.html">pandas.core.groupby.DataFrameGroupBy.cummax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.cummin.html">pandas.core.groupby.DataFrameGroupBy.cummin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.cumprod.html">pandas.core.groupby.DataFrameGroupBy.cumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.cumsum.html">pandas.core.groupby.DataFrameGroupBy.cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.describe.html">pandas.core.groupby.DataFrameGroupBy.describe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.diff.html">pandas.core.groupby.DataFrameGroupBy.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.ffill.html">pandas.core.groupby.DataFrameGroupBy.ffill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.fillna.html">pandas.core.groupby.DataFrameGroupBy.fillna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.hist.html">pandas.core.groupby.DataFrameGroupBy.hist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.idxmax.html">pandas.core.groupby.DataFrameGroupBy.idxmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.idxmin.html">pandas.core.groupby.DataFrameGroupBy.idxmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.mad.html">pandas.core.groupby.DataFrameGroupBy.mad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.pct_change.html">pandas.core.groupby.DataFrameGroupBy.pct_change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.plot.html">pandas.core.groupby.DataFrameGroupBy.plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.quantile.html">pandas.core.groupby.DataFrameGroupBy.quantile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.rank.html">pandas.core.groupby.DataFrameGroupBy.rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.resample.html">pandas.core.groupby.DataFrameGroupBy.resample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.shift.html">pandas.core.groupby.DataFrameGroupBy.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.size.html">pandas.core.groupby.DataFrameGroupBy.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.skew.html">pandas.core.groupby.DataFrameGroupBy.skew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.take.html">pandas.core.groupby.DataFrameGroupBy.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.tshift.html">pandas.core.groupby.DataFrameGroupBy.tshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.SeriesGroupBy.nlargest.html">pandas.core.groupby.SeriesGroupBy.nlargest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.SeriesGroupBy.nsmallest.html">pandas.core.groupby.SeriesGroupBy.nsmallest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.SeriesGroupBy.nunique.html">pandas.core.groupby.SeriesGroupBy.nunique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.SeriesGroupBy.unique.html">pandas.core.groupby.SeriesGroupBy.unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.SeriesGroupBy.value_counts.html">pandas.core.groupby.SeriesGroupBy.value_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.corrwith.html">pandas.core.groupby.DataFrameGroupBy.corrwith</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.boxplot.html">pandas.core.groupby.DataFrameGroupBy.boxplot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api14.html">Resampling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api14.html#indexing-iteration">Indexing, iteration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.__iter__.html">pandas.tseries.resample.Resampler.__iter__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.groups.html">pandas.tseries.resample.Resampler.groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.indices.html">pandas.tseries.resample.Resampler.indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.get_group.html">pandas.tseries.resample.Resampler.get_group</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api14.html#function-application">Function application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.apply.html">pandas.tseries.resample.Resampler.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.aggregate.html">pandas.tseries.resample.Resampler.aggregate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.transform.html">pandas.tseries.resample.Resampler.transform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api14.html#upsampling">Upsampling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.ffill.html">pandas.tseries.resample.Resampler.ffill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.backfill.html">pandas.tseries.resample.Resampler.backfill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.bfill.html">pandas.tseries.resample.Resampler.bfill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.pad.html">pandas.tseries.resample.Resampler.pad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.fillna.html">pandas.tseries.resample.Resampler.fillna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.asfreq.html">pandas.tseries.resample.Resampler.asfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.interpolate.html">pandas.tseries.resample.Resampler.interpolate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api14.html#computations-descriptive-stats">Computations / Descriptive Stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.count.html">pandas.tseries.resample.Resampler.count</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.nunique.html">pandas.tseries.resample.Resampler.nunique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.first.html">pandas.tseries.resample.Resampler.first</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.last.html">pandas.tseries.resample.Resampler.last</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.max.html">pandas.tseries.resample.Resampler.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.mean.html">pandas.tseries.resample.Resampler.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.median.html">pandas.tseries.resample.Resampler.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.min.html">pandas.tseries.resample.Resampler.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.ohlc.html">pandas.tseries.resample.Resampler.ohlc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.prod.html">pandas.tseries.resample.Resampler.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.size.html">pandas.tseries.resample.Resampler.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.sem.html">pandas.tseries.resample.Resampler.sem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.std.html">pandas.tseries.resample.Resampler.std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.sum.html">pandas.tseries.resample.Resampler.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.tseries.resample.Resampler.var.html">pandas.tseries.resample.Resampler.var</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api15.html">Style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api15.html#constructor">Constructor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.html">pandas.formats.style.Styler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api15.html#style-application">Style Application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.apply.html">pandas.formats.style.Styler.apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.applymap.html">pandas.formats.style.Styler.applymap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.format.html">pandas.formats.style.Styler.format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.set_precision.html">pandas.formats.style.Styler.set_precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.set_table_styles.html">pandas.formats.style.Styler.set_table_styles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.set_caption.html">pandas.formats.style.Styler.set_caption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.set_properties.html">pandas.formats.style.Styler.set_properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.set_uuid.html">pandas.formats.style.Styler.set_uuid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.clear.html">pandas.formats.style.Styler.clear</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api15.html#builtin-styles">Builtin Styles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.highlight_max.html">pandas.formats.style.Styler.highlight_max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.highlight_min.html">pandas.formats.style.Styler.highlight_min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.highlight_null.html">pandas.formats.style.Styler.highlight_null</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.background_gradient.html">pandas.formats.style.Styler.background_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.bar.html">pandas.formats.style.Styler.bar</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api15.html#style-export-and-import">Style Export and Import</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.render.html">pandas.formats.style.Styler.render</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.export.html">pandas.formats.style.Styler.export</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.formats.style.Styler.use.html">pandas.formats.style.Styler.use</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api16.html">General utility functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api16.html#working-with-options">Working with options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.describe_option.html">pandas.describe_option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.reset_option.html">pandas.reset_option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.get_option.html">pandas.get_option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.set_option.html">pandas.set_option</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../generated/pandas.option_context.html">pandas.option_context</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../10min/10min.html">10 Minutes to pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min1.html">1 Object Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min2.html">2 Viewing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min3.html">3 Selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min3.html#getting">3.1 Getting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min3.html#selection-by-label">3.2 Selection by Label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min3.html#selection-by-position">3.3 Selection by Position</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min3.html#boolean-indexing">3.4 Boolean Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min3.html#setting">3.5 Setting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min4.html">4 Missing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min5.html">5 Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min5.html#stats">5.1 Stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min5.html#apply">5.2 Apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min5.html#histogramming">5.3 Histogramming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min5.html#string-methods">5.4 String Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min6.html">6 Merge</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min6.html#concat">6.1 Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min6.html#join">6.2 Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min6.html#append">6.3 Append</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min7.html">7 Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min8.html">8 Reshaping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min8.html#stack">8.1 Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min8.html#pivot-tables">8.2 Pivot Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min9.html">9 Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min10.html">10 Categoricals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min11.html">11 Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min12.html">12 Getting Data In/Out</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min12.html#csv">12.1 CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min12.html#hdf5">12.2 HDF5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../10min/10min12.html#excel">12.3 Excel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../10min/10min13.html">13 Gotchas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../dsintro/dsintro.html">Intro to Data Structures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dsintro/dsintro1.html">1 Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro1.html#series-is-ndarray-like">1.1 Series is ndarray-like</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro1.html#series-is-dict-like">1.2 Series is dict-like</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro1.html#vectorized-operations-and-label-alignment-with-series">1.3 Vectorized operations and label alignment with Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro1.html#name-attribute">1.4 Name attribute</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsintro/dsintro2.html">2 DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#from-dict-of-series-or-dicts">2.1 From dict of Series or dicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#from-dict-of-ndarrays-lists">2.2 From dict of ndarrays / lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#from-structured-or-record-array">2.3 From structured or record array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#from-a-list-of-dicts">2.4 From a list of dicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#from-a-dict-of-tuples">2.5 From a dict of tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#from-a-series">2.6 From a Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#alternate-constructors">2.7 Alternate Constructors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#column-selection-addition-deletion">2.8 Column selection, addition, deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#assigning-new-columns-in-method-chains">2.9 Assigning New Columns in Method Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#indexing-selection">2.10 Indexing / Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#data-alignment-and-arithmetic">2.11 Data alignment and arithmetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#transposing">2.12 Transposing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#dataframe-interoperability-with-numpy-functions">2.13 DataFrame interoperability with NumPy functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#console-display">2.14 Console display</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro2.html#dataframe-column-attribute-access-and-ipython-completion">2.15 DataFrame column attribute access and IPython completion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsintro/dsintro3.html">3 Panel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#from-3d-ndarray-with-optional-axis-labels">3.1 From 3D ndarray with optional axis labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#from-dict-of-dataframe-objects">3.2 From dict of DataFrame objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#from-dataframe-using-to-panel-method">3.3 From DataFrame using <code class="docutils literal"><span class="pre">to_panel</span></code> method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#item-selection-addition-deletion">3.4 Item selection / addition / deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#transposing">3.5 Transposing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#indexing-selection">3.6 Indexing / Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#squeezing">3.7 Squeezing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro3.html#conversion-to-dataframe">3.8 Conversion to DataFrame</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsintro/dsintro4.html">4 Panel4D (Experimental)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro4.html#from-4d-ndarray-with-optional-axis-labels">4.1 From 4D ndarray with optional axis labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro4.html#from-dict-of-panel-objects">4.2 From dict of Panel objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro4.html#slicing">4.3 Slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsintro/dsintro4.html#transposing">4.4 Transposing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsintro/dsintro5.html">5 PanelND (Experimental)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../basics/basics.html">Essential Basic Functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics1.html">1 Head and Tail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics2.html">2 Attributes and the raw ndarray(s)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics3.html">3 Accelerated operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics4.html">4 Flexible binary operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#matching-broadcasting-behavior">4.1 Matching / broadcasting behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#missing-data-operations-with-fill-values">4.2 Missing data / operations with fill values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#flexible-comparisons">4.3 Flexible Comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#boolean-reductions">4.4 Boolean Reductions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#comparing-if-objects-are-equivalent">4.5 Comparing if objects are equivalent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#comparing-array-like-objects">4.6 Comparing array-like objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#combining-overlapping-data-sets">4.7 Combining overlapping data sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics4.html#general-dataframe-combine">4.8 General DataFrame Combine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics5.html">5 Descriptive statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics5.html#summarizing-data-describe">5.1 Summarizing data: describe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics5.html#index-of-min-max-values">5.2 Index of Min/Max Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics5.html#value-counts-histogramming-mode">5.3 Value counts (histogramming) / Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics5.html#discretization-and-quantiling">5.4 Discretization and quantiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics6.html">6 Function application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics6.html#tablewise-function-application">6.1 Tablewise Function Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics6.html#row-or-column-wise-function-application">6.2 Row or Column-wise Function Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics6.html#applying-elementwise-python-functions">6.3 Applying elementwise Python functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics6.html#applying-with-a-panel">6.4 Applying with a Panel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics7.html">7 Reindexing and altering labels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics7.html#reindexing-to-align-with-another-object">7.1 Reindexing to align with another object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics7.html#aligning-objects-with-each-other-with-align">7.2 Aligning objects with each other with <code class="docutils literal"><span class="pre">align</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics7.html#filling-while-reindexing">7.3 Filling while reindexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics7.html#limits-on-filling-while-reindexing">7.4 Limits on filling while reindexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics7.html#dropping-labels-from-an-axis">7.5 Dropping labels from an axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics7.html#renaming-mapping-labels">7.6 Renaming / mapping labels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics8.html">8 Iteration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics8.html#iteritems">8.1 iteritems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics8.html#iterrows">8.2 iterrows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics8.html#itertuples">8.3 itertuples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics9.html">9 .dt accessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics10.html">10 Vectorized string methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics11.html">11 Sorting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics11.html#by-index">11.1 By Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics11.html#by-values">11.2 By Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics11.html#searchsorted">11.3 searchsorted</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics11.html#smallest-largest-values">11.4 smallest / largest values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics11.html#sorting-by-a-multi-index-column">11.5 Sorting by a multi-index column</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics12.html">12 Copying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics13.html">13 dtypes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics13.html#defaults">13.1 defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics13.html#upcasting">13.2 upcasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics13.html#astype">13.3 astype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics13.html#object-conversion">13.4 object conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../basics/basics13.html#gotchas">13.5 gotchas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/basics14.html">14 Selecting columns based on <code class="docutils literal"><span class="pre">dtype</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../part1.html">Part1 (freqeuntly used)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../options/options.html">1 Options and Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options1.html">1.1 Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options2.html">1.2 Getting and Setting Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options3.html">1.3 Setting Startup Options in python/ipython Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options4.html">1.4 Frequently Used Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options5.html">1.5 Available Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options6.html">1.6 Number Formatting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../options/options7.html">1.7 Unicode Formatting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../indexing/indexing.html">2 Indexing and Selecting Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing1.html">2.1 Different Choices for Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing2.html">2.2 Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing3.html">2.3 Attribute Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing4.html">2.4 Slicing ranges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing5.html">2.5 Selection By Label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing6.html">2.6 Selection By Position</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing7.html">2.7 Selection By Callable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing8.html">2.8 Selecting Random Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing9.html">2.9 Setting With Enlargement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing10.html">2.10 Fast scalar value getting and setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing11.html">2.11 Boolean indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing12.html">2.12 Indexing with isin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing13.html">2.13 The <code class="docutils literal"><span class="pre">where()</span></code> Method and Masking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing14.html">2.14 The <code class="docutils literal"><span class="pre">query()</span></code> Method (Experimental)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#multiindex-query-syntax">2.14.1 <code class="docutils literal"><span class="pre">MultiIndex</span></code> <code class="docutils literal"><span class="pre">query()</span></code> Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#query-use-cases">2.14.2 <code class="docutils literal"><span class="pre">query()</span></code> Use Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#query-python-versus-pandas-syntax-comparison">2.14.3 <code class="docutils literal"><span class="pre">query()</span></code> Python versus pandas Syntax Comparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#the-in-and-not-in-operators">2.14.4 The <code class="docutils literal"><span class="pre">in</span></code> and <code class="docutils literal"><span class="pre">not</span> <span class="pre">in</span></code> operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#special-use-of-the-operator-with-list-objects">2.14.5 Special use of the <code class="docutils literal"><span class="pre">==</span></code> operator with <code class="docutils literal"><span class="pre">list</span></code> objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#boolean-operators">2.14.6 Boolean Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing14.html#performance-of-query">2.14.7 Performance of <code class="docutils literal"><span class="pre">query()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing15.html">2.15 Duplicate Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing16.html">2.16 Dictionary-like <code class="docutils literal"><span class="pre">get()</span></code> method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing17.html">2.17 The <code class="docutils literal"><span class="pre">select()</span></code> Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing18.html">2.18 The <code class="docutils literal"><span class="pre">lookup()</span></code> Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing19.html">2.19 Index objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing19.html#setting-metadata">2.19.1 Setting metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing19.html#set-operations-on-index-objects">2.19.2 Set operations on Index objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing19.html#missing-values">2.19.3 Missing values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing20.html">2.20 Set / Reset Index</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing20.html#set-an-index">2.20.1 Set an index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing20.html#reset-the-index">2.20.2 Reset the index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing20.html#adding-an-ad-hoc-index">2.20.3 Adding an ad hoc index</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../indexing/indexing21.html">2.21 Returning a view versus a copy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing21.html#why-does-assignment-fail-when-using-chained-indexing">2.21.1 Why does assignment fail when using chained indexing?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../indexing/indexing21.html#evaluation-order-matters">2.21.2 Evaluation order matters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../advanced/advanced.html">3 MultiIndex / Advanced Indexing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../advanced/advanced1.html">3.1 Hierarchical indexing (MultiIndex)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced1.html#creating-a-multiindex-hierarchical-index-object">3.1.1 Creating a MultiIndex (hierarchical index) object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced1.html#reconstructing-the-level-labels">3.1.2 Reconstructing the level labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced1.html#basic-indexing-on-axis-with-multiindex">3.1.3 Basic indexing on axis with MultiIndex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced1.html#data-alignment-and-using-reindex">3.1.4 Data alignment and using <code class="docutils literal"><span class="pre">reindex</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../advanced/advanced2.html">3.2 Advanced indexing with hierarchical index</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced2.html#using-slicers">3.2.1 Using slicers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced2.html#cross-section">3.2.2 Cross-section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced2.html#advanced-reindexing-and-alignment">3.2.3 Advanced reindexing and alignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced2.html#swapping-levels-with-swaplevel">3.2.4 Swapping levels with <code class="docutils literal"><span class="pre">swaplevel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced2.html#reordering-levels-with-reorder-levels">3.2.5 Reordering levels with <code class="docutils literal"><span class="pre">reorder_levels()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../advanced/advanced3.html">3.3 Sorting a <code class="docutils literal"><span class="pre">MultiIndex</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../advanced/advanced4.html">3.4 Take Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../advanced/advanced5.html">3.5 Index Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced5.html#categoricalindex">3.5.1 CategoricalIndex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced5.html#int64index-and-rangeindex">3.5.2 Int64Index and RangeIndex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced/advanced5.html#float64index">3.5.3 Float64Index</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../missing/missing.html">4 Working with missing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../missing/missing1.html">4.1 Missing data basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing1.html#when-why-does-data-become-missing">4.1.1 When / why does data become missing?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing1.html#values-considered-missing">4.1.2 Values considered &#8220;missing&#8221;</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../missing/missing2.html">4.2 Datetimes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../missing/missing3.html">4.3 Inserting missing data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../missing/missing4.html">4.4 Calculations with missing data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing4.html#na-values-in-groupby">4.4.1 NA values in GroupBy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../missing/missing5.html">4.5 Cleaning / filling missing data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#filling-missing-values-fillna">4.5.1 Filling missing values: fillna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#filling-with-a-pandasobject">4.5.2 Filling with a PandasObject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#dropping-axis-labels-with-missing-data-dropna">4.5.3 Dropping axis labels with missing data: dropna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#interpolation">4.5.4 Interpolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#replacing-generic-values">4.5.5 Replacing Generic Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#string-regular-expression-replacement">4.5.6 String/Regular Expression Replacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../missing/missing5.html#numeric-replacement">4.5.7 Numeric Replacement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../missing/missing6.html">4.6 Missing data casting rules and indexing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../groupby/groupby.html">5 Group By: split-apply-combine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby1.html">5.1 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby2.html">5.2 Splitting an object into groups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby2.html#groupby-sorting">5.2.1 GroupBy sorting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby2.html#groupby-object-attributes">5.2.2 GroupBy object attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby2.html#groupby-with-multiindex">5.2.3 GroupBy with MultiIndex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby2.html#dataframe-column-selection-in-groupby">5.2.4 DataFrame column selection in GroupBy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby3.html">5.3 Iterating through groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby3.html#selecting-a-group">5.4 Selecting a group</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby4.html">5.5 Aggregation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby4.html#applying-multiple-functions-at-once">5.5.1 Applying multiple functions at once</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby4.html#applying-different-functions-to-dataframe-columns">5.5.2 Applying different functions to DataFrame columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby4.html#cython-optimized-aggregation-functions">5.5.3 Cython-optimized aggregation functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby5.html">5.6 Transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby6.html">5.7 Filtration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby7.html">5.8 Dispatching to instance methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby8.html">5.9 Flexible <code class="docutils literal"><span class="pre">apply</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby9.html">5.10 Other useful features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#automatic-exclusion-of-nuisance-columns">5.10.1 Automatic exclusion of &#8220;nuisance&#8221; columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#na-and-nat-group-handling">5.10.2 NA and NaT group handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#grouping-with-ordered-factors">5.10.3 Grouping with ordered factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#grouping-with-a-grouper-specification">5.10.4 Grouping with a Grouper specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#taking-the-first-rows-of-each-group">5.10.5 Taking the first rows of each group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#taking-the-nth-row-of-each-group">5.10.6 Taking the nth row of each group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#enumerate-group-items">5.10.7 Enumerate group items</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby9.html#plotting">5.10.8 Plotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../groupby/groupby10.html">5.11 Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby10.html#regrouping-by-factor">5.11.1 Regrouping by factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby10.html#groupby-by-indexer-to-resample-data">5.11.2 Groupby by Indexer to &#8216;resample&#8217; data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../groupby/groupby10.html#returning-a-series-to-propagate-names">5.11.3 Returning a Series to propagate names</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../merging/merging.html">6 Merge, join, and concatenate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../merging/merging1.html">6.1 Concatenating objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging1.html#set-logic-on-the-other-axes">6.1.1 Set logic on the other axes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging1.html#concatenating-using-append">6.1.2 Concatenating using <code class="docutils literal"><span class="pre">append</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging1.html#ignoring-indexes-on-the-concatenation-axis">6.1.3 Ignoring indexes on the concatenation axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging1.html#concatenating-with-mixed-ndims">6.1.4 Concatenating with mixed ndims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging1.html#more-concatenating-with-group-keys">6.1.5 More concatenating with group keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging1.html#appending-rows-to-a-dataframe">6.1.6 Appending rows to a DataFrame</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../merging/merging2.html">6.2 Database-style DataFrame joining/merging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#brief-primer-on-merge-methods-relational-algebra">6.2.1 Brief primer on merge methods (relational algebra)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#the-merge-indicator">6.2.2 The merge indicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#joining-on-index">6.2.3 Joining on index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#joining-key-columns-on-an-index">6.2.4 Joining key columns on an index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#joining-a-single-index-to-a-multi-index">6.2.5 Joining a single Index to a Multi-index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#joining-with-two-multi-indexes">6.2.6 Joining with two multi-indexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#overlapping-value-columns">6.2.7 Overlapping value columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#joining-multiple-dataframe-or-panel-objects">6.2.8 Joining multiple DataFrame or Panel objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging2.html#merging-together-values-within-series-or-dataframe-columns">6.2.9 Merging together values within Series or DataFrame columns</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../merging/merging3.html">6.3 Timeseries friendly merging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging3.html#merging-ordered-data">6.3.1 Merging Ordered Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../merging/merging3.html#merging-asof">6.3.2 Merging AsOf</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reshaping/reshaping.html">7 Reshaping and Pivot Tables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping1.html">7.1 Reshaping by pivoting DataFrame objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping2.html">7.2 Reshaping by stacking and unstacking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reshaping/reshaping2.html#multiple-levels">7.2.1 Multiple Levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reshaping/reshaping2.html#missing-data">7.2.2 Missing Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reshaping/reshaping2.html#with-a-multiindex">7.2.3 With a MultiIndex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping3.html">7.3 Reshaping by Melt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping4.html">7.4 Combining with stats and GroupBy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping5.html">7.5 Pivot tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reshaping/reshaping5.html#adding-margins">7.5.1 Adding margins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping6.html">7.6 Cross tabulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reshaping/reshaping6.html#normalization">7.6.1 Normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reshaping/reshaping6.html#adding-margins">7.6.2 Adding Margins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping7.html">7.7 Tiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping8.html">7.8 Computing indicator / dummy variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reshaping/reshaping9.html">7.9 Factorizing values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualization/visualization.html">8 Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization1.html">8.1 Basic Plotting: <code class="docutils literal"><span class="pre">plot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization2.html">8.2 Other Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#bar-plots">8.2.1 Bar plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#histograms">8.2.2 Histograms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#box-plots">8.2.3 Box Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#area-plot">8.2.4 Area Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#scatter-plot">8.2.5 Scatter Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#hexagonal-bin-plot">8.2.6 Hexagonal Bin Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization2.html#pie-plot">8.2.7 Pie plot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization3.html">8.3 Plotting with Missing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization4.html">8.4 Plotting Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#scatter-matrix-plot">8.4.1 Scatter Matrix Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#density-plot">8.4.2 Density Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#andrews-curves">8.4.3 Andrews Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#parallel-coordinates">8.4.4 Parallel Coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#lag-plot">8.4.5 Lag Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#autocorrelation-plot">8.4.6 Autocorrelation Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#bootstrap-plot">8.4.7 Bootstrap Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization4.html#radviz">8.4.8 RadViz</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization5.html">8.5 Plot Formatting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#controlling-the-legend">8.5.1 Controlling the Legend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#scales">8.5.2 Scales</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#plotting-on-a-secondary-y-axis">8.5.3 Plotting on a Secondary Y-axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#suppressing-tick-resolution-adjustment">8.5.4 Suppressing Tick Resolution Adjustment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#subplots">8.5.5 Subplots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#using-layout-and-targeting-multiple-axes">8.5.6 Using Layout and Targeting Multiple Axes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#plotting-with-error-bars">8.5.7 Plotting With Error Bars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#plotting-tables">8.5.8 Plotting Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../visualization/visualization5.html#colormaps">8.5.9 Colormaps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization6.html">8.6 Plotting directly with matplotlib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../visualization/visualization7.html">8.7 Trellis plotting interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../text/text.html">9 Working with Text Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text1.html">9.1 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text2.html">9.2 Splitting and Replacing Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text3.html">9.3 Indexing with <code class="docutils literal"><span class="pre">.str</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text4.html">9.4 Extracting Substrings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../text/text4.html#extract-first-match-in-each-subject-extract">9.4.1 Extract first match in each subject (extract)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../text/text4.html#extract-all-matches-in-each-subject-extractall">9.4.2 Extract all matches in each subject (extractall)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text5.html">9.5 Testing for Strings that Match or Contain a Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text6.html">9.6 Creating Indicator Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../text/text7.html">9.7 Method Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../io/io.html">10 IO Tools (Text, CSV, HDF5, ...)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io1.html">10.1 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io2.html">10.2 CSV &amp; Text files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#parsing-options">10.2.1 Parsing options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#specifying-column-data-types">10.2.2 Specifying column data types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#naming-and-using-columns">10.2.3 Naming and Using Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#duplicate-names-parsing">10.2.4 Duplicate names parsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#comments-and-empty-lines">10.2.5 Comments and Empty Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#dealing-with-unicode-data">10.2.6 Dealing with Unicode Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#index-columns-and-trailing-delimiters">10.2.7 Index columns and trailing delimiters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#date-handling">10.2.8 Date Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#specifying-method-for-floating-point-conversion">10.2.9 Specifying method for floating-point conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#thousand-separators">10.2.10 Thousand Separators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#na-values">10.2.11 NA Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#infinity">10.2.12 Infinity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#returning-series">10.2.13 Returning Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#boolean-values">10.2.14 Boolean values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#handling-bad-lines">10.2.15 Handling &#8220;bad&#8221; lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#quoting-and-escape-characters">10.2.16 Quoting and Escape Characters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#files-with-fixed-width-columns">10.2.17 Files with Fixed Width Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#indexes">10.2.18 Indexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#automatically-sniffing-the-delimiter">10.2.19 Automatically &#8220;sniffing&#8221; the delimiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#iterating-through-files-chunk-by-chunk">10.2.20 Iterating through files chunk by chunk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#specifying-the-parser-engine">10.2.21 Specifying the parser engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io2.html#writing-out-data">10.2.22 Writing out Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io3.html">10.3 JSON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io3.html#writing-json">10.3.1 Writing JSON</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io3.html#reading-json">10.3.2 Reading JSON</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io3.html#normalization">10.3.3 Normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io3.html#line-delimited-json">10.3.4 Line delimited json</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io4.html">10.4 HTML</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io4.html#reading-html-content">10.4.1 Reading HTML Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io4.html#writing-to-html-files">10.4.2 Writing to HTML files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io5.html">10.5 Excel files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io5.html#reading-excel-files">10.5.1 Reading Excel Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io5.html#writing-excel-files">10.5.2 Writing Excel Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io5.html#excel-writer-engines">10.5.3 Excel writer engines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io6.html">10.6 Clipboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io7.html">10.7 Pickling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io8.html">10.8 msgpack (experimental)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io8.html#read-write-api">10.8.1 Read/Write API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io9.html">10.9 HDF5 (PyTables)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#read-write-api">10.9.1 Read/Write API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#fixed-format">10.9.2 Fixed Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#table-format">10.9.3 Table Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#hierarchical-keys">10.9.4 Hierarchical Keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#storing-types">10.9.5 Storing Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#querying">10.9.6 Querying</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#delete-from-a-table">10.9.7 Delete from a Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#notes-caveats">10.9.8 Notes &amp; Caveats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#datatypes">10.9.9 DataTypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#external-compatibility">10.9.10 External Compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#backwards-compatibility">10.9.11 Backwards Compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#performance">10.9.12 Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io9.html#experimental">10.9.13 Experimental</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io10.html">10.10 SQL Queries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/generated/pandas.read_sql_table.html">10.10.1 pandas.read_sql_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/generated/pandas.read_sql_query.html">10.10.2 pandas.read_sql_query</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/generated/pandas.read_sql.html">10.10.3 pandas.read_sql</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/generated/pandas.DataFrame.to_sql.html">10.10.4 pandas.DataFrame.to_sql</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#writing-dataframes">10.10.5 Writing DataFrames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#reading-tables">10.10.6 Reading Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#schema-support">10.10.7 Schema support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#querying">10.10.8 Querying</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#engine-connection-examples">10.10.9 Engine connection examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#advanced-sqlalchemy-queries">10.10.10 Advanced SQLAlchemy queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io10.html#sqlite-fallback">10.10.11 Sqlite fallback</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io11.html">10.11 Google BigQuery (Experimental)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/generated/pandas.io.gbq.read_gbq.html">10.11.1 pandas.io.gbq.read_gbq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/generated/pandas.io.gbq.to_gbq.html">10.11.2 pandas.io.gbq.to_gbq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io11.html#authentication">10.11.3 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io11.html#querying">10.11.4 Querying</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io11.html#writing-dataframes">10.11.5 Writing DataFrames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io11.html#creating-bigquery-tables">10.11.6 Creating BigQuery Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io12.html">10.12 Stata Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io12.html#writing-to-stata-format">10.12.1 Writing to Stata format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io12.html#reading-from-stata-format">10.12.2 Reading from Stata format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io13.html">10.13 SAS Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io14.html">10.14 Other file formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../io/io14.html#netcdf">10.14.1 netCDF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../io/io15.html">10.15 Performance Considerations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../part2.html">Part 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../sparse/sparse.html">1 Sparse data structures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse/sparse.html#sparsearray">1.1 SparseArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse/sparse.html#sparselist">1.2 SparseList</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse/sparse.html#sparseindex-objects">1.3 SparseIndex objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse/sparse.html#sparse-calculation">1.4 Sparse Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sparse/sparse.html#interaction-with-scipy-sparse">1.5 Interaction with scipy.sparse</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../cookbook/cookbook.html">2 Cookbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook1.html">2.1 Idioms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook1.html#if-then">2.1.1 if-then...</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook1.html#splitting">2.1.2 Splitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook1.html#building-criteria">2.1.3 Building Criteria</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook2.html">2.2 Selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook2.html#dataframes">2.2.1 DataFrames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook2.html#panels">2.2.2 Panels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook2.html#new-columns">2.2.3 New Columns</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook3.html">2.3 MultiIndexing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook3.html#arithmetic">2.3.1 Arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook3.html#slicing">2.3.2 Slicing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook3.html#sorting">2.3.3 Sorting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook3.html#levels">2.3.4 Levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook3.html#panelnd">2.3.5 panelnd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook4.html">2.4 Missing Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook4.html#replace">2.4.1 Replace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook5.html">2.5 Grouping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook5.html#expanding-data">2.5.1 Expanding Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook5.html#splitting">2.5.2 Splitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook5.html#pivot">2.5.3 Pivot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook5.html#apply">2.5.4 Apply</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook6.html">2.6 Timeseries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook6.html#resampling">2.6.1 Resampling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook7.html">2.7 Merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook8.html">2.8 Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook9.html">2.9 Data In/Out</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook9.html#csv">2.9.1 CSV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook9.html#sql">2.9.2 SQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook9.html#excel">2.9.3 Excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook9.html#html">2.9.4 HTML</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook9.html#hdfstore">2.9.5 HDFStore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cookbook/cookbook9.html#binary-files">2.9.6 Binary Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook10.html">2.10 Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook11.html">2.11 Timedeltas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook12.html">2.12 Aliasing Axis Names</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cookbook/cookbook13.html">2.13 Creating Example Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../computation/computation.html">3 Computational tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../computation/computation1.html">3.1 Statistical Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation1.html#percent-change">3.1.1 Percent Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation1.html#covariance">3.1.2 Covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation1.html#correlation">3.1.3 Correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation1.html#data-ranking">3.1.4 Data ranking</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../computation/computation2.html">3.2 Window Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#method-summary">3.2.1 Method Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#rolling-windows">3.2.2 Rolling Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#time-aware-rolling">3.2.3 Time-aware Rolling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#time-aware-rolling-vs-resampling">3.2.4 Time-aware Rolling vs. Resampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#centering-windows">3.2.5 Centering Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#binary-window-functions">3.2.6 Binary Window Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation2.html#computing-rolling-pairwise-covariances-and-correlations">3.2.7 Computing rolling pairwise covariances and correlations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../computation/computation3.html">3.3 Aggregation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation3.html#applying-multiple-functions-at-once">3.3.1 Applying multiple functions at once</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation3.html#applying-different-functions-to-dataframe-columns">3.3.2 Applying different functions to DataFrame columns</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../computation/computation4.html">3.4 Expanding Windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../computation/computation4.html#method-summary">3.4.1 Method Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../computation/computation5.html">3.5 Exponentially Weighted Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../timeseries/timeseries.html">Time Series / Date functionality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries1.html">1 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries2.html">2 Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries3.html">3 Time Stamps vs. Time Spans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries4.html">4 Converting to Timestamps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries4.html#invalid-data">4.1 Invalid Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries4.html#epoch-timestamps">4.2 Epoch Timestamps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries5.html">5 Generating Ranges of Timestamps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries6.html">6 Timestamp limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries7.html">7 DatetimeIndex</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries7.html#datetimeindex-partial-string-indexing">7.1 DatetimeIndex Partial String Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries7.html#datetime-indexing">7.2 Datetime Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries7.html#truncating-fancy-indexing">7.3 Truncating &amp; Fancy Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries7.html#time-date-components">7.4 Time/Date Components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries8.html">8 DateOffset objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#parametric-offsets">8.1 Parametric offsets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#using-offsets-with-series-datetimeindex">8.2 Using offsets with <code class="docutils literal"><span class="pre">Series</span></code> / <code class="docutils literal"><span class="pre">DatetimeIndex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#custom-business-days-experimental">8.3 Custom Business Days (Experimental)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#business-hour">8.4 Business Hour</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#custom-business-hour">8.5 Custom Business Hour</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#offset-aliases">8.6 Offset Aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#combining-aliases">8.7 Combining Aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#anchored-offsets">8.8 Anchored Offsets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#anchored-offset-semantics">8.9 Anchored Offset Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries8.html#holidays-holiday-calendars">8.10 Holidays / Holiday Calendars</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries9.html">9 Time series-related instance methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries9.html#shifting-lagging">9.1 Shifting / lagging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries9.html#frequency-conversion">9.2 Frequency conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries9.html#filling-forward-backward">9.3 Filling forward / backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries9.html#converting-to-python-datetimes">9.4 Converting to Python datetimes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries10.html">10 Resampling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries10.html#up-sampling">10.1 Up Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries10.html#sparse-resampling">10.2 Sparse Resampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries10.html#aggregation">10.3 Aggregation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries11.html">11 Time Span Representation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries11.html#period">11.1 Period</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries11.html#periodindex-and-period-range">11.2 PeriodIndex and period_range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries11.html#period-dtypes">11.3 Period Dtypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries11.html#periodindex-partial-string-indexing">11.4 PeriodIndex Partial String Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries11.html#frequency-conversion-and-resampling-with-periodindex">11.5 Frequency Conversion and Resampling with PeriodIndex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries12.html">12 Converting between Representations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries13.html">13 Representing out-of-bounds spans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timeseries/timeseries14.html">14 Time Zone Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries14.html#working-with-time-zones">14.1 Working with Time Zones</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries14.html#ambiguous-times-when-localizing">14.2 Ambiguous Times when Localizing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timeseries/timeseries14.html#tz-aware-dtypes">14.3 TZ aware Dtypes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../timedeltas/timedeltas.html">4 Time Deltas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#parsing">4.1 Parsing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timedeltas/timedeltas.html#to-timedelta">4.1.1 to_timedelta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timedeltas/timedeltas.html#timedelta-limitations">4.1.2 Timedelta limitations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#operations">4.2 Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#reductions">4.3 Reductions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#frequency-conversion">4.4 Frequency Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#attributes">4.5 Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#timedeltaindex">4.6 TimedeltaIndex</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../timedeltas/timedeltas.html#using-the-timedeltaindex">4.6.1 Using the TimedeltaIndex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timedeltas/timedeltas.html#id1">4.6.2 Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../timedeltas/timedeltas.html#conversions">4.6.3 Conversions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../timedeltas/timedeltas.html#resampling">4.7 Resampling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../categorical/categorical.html">5 Categorical Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical1.html">5.1 Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical2.html">5.2 Object Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical3.html">5.3 Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical4.html">5.4 Working with categories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical4.html#renaming-categories">5.4.1 Renaming categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical4.html#appending-new-categories">5.4.2 Appending new categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical4.html#removing-categories">5.4.3 Removing categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical4.html#removing-unused-categories">5.4.4 Removing unused categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical4.html#setting-categories">5.4.5 Setting categories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical5.html">5.5 Sorting and Order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical5.html#reordering">5.5.1 Reordering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical5.html#multi-column-sorting">5.5.2 Multi Column Sorting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical6.html">5.6 Comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical7.html">5.7 Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical8.html">5.8 Data munging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical8.html#getting">5.8.1 Getting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical8.html#string-and-datetime-accessors">5.8.2 String and datetime accessors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical8.html#setting">5.8.3 Setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical8.html#merging">5.8.4 Merging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical8.html#unioning">5.8.5 Unioning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical9.html">5.9 Getting Data In/Out</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical10.html">5.10 Missing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical11.html">5.11 Differences to R&#8217;s <cite>factor</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../categorical/categorical12.html">5.12 Gotchas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical12.html#memory-usage">5.12.1 Memory Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical12.html#old-style-constructor-usage">5.12.2 Old style constructor usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical12.html#categorical-is-not-a-numpy-array">5.12.3 <cite>Categorical</cite> is not a <cite>numpy</cite> array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical12.html#dtype-in-apply">5.12.4 dtype in apply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical12.html#categorical-index">5.12.5 Categorical Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../categorical/categorical12.html#side-effects">5.12.6 Side Effects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../remote_data/remote_data.html">6 Remote Data Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../remote_data/remote_data.html#datareader">6.1 DataReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../remote_data/remote_data.html#google-analytics">6.2 Google Analytics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../remote_data/remote_data.html#configuring-access-to-google-analytics">6.2.1 Configuring Access to Google Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../remote_data/remote_data.html#using-the-google-analytics-api">6.2.2 Using the Google Analytics API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../enhancingperf/enhancingperf.html">7 Enhancing Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../enhancingperf/enhancingperf1.html">7.1 Cython (Writing C extensions for pandas)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf1.html#pure-python">7.1.1 Pure python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf1.html#plain-cython">7.1.2 Plain cython</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf1.html#adding-type">7.1.3 Adding type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf1.html#using-ndarray">7.1.4 Using ndarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf1.html#more-advanced-techniques">7.1.5 More advanced techniques</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../enhancingperf/enhancingperf2.html">7.2 Using numba</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf2.html#jit">7.2.1 Jit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf2.html#vectorize">7.2.2 Vectorize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf2.html#caveats">7.2.3 Caveats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html">7.3 Expression Evaluation via <code class="docutils literal"><span class="pre">eval()</span></code> (Experimental)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#supported-syntax">7.3.1 Supported Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#eval-examples">7.3.2 <code class="docutils literal"><span class="pre">eval()</span></code> Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#the-dataframe-eval-method-experimental">7.3.3 The <code class="docutils literal"><span class="pre">DataFrame.eval</span></code> method (Experimental)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#local-variables">7.3.4 Local Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#pandas-eval-parsers">7.3.5 <code class="docutils literal"><span class="pre">pandas.eval()</span></code> Parsers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#pandas-eval-backends">7.3.6 <code class="docutils literal"><span class="pre">pandas.eval()</span></code> Backends</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#pandas-eval-performance">7.3.7 <code class="docutils literal"><span class="pre">pandas.eval()</span></code> Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../enhancingperf/enhancingperf3.html#technical-minutia-regarding-expression-evaluation">7.3.8 Technical Minutia Regarding Expression Evaluation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../part3.html">Part 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../gotchas/gotchas.html">1 Caveats and Gotchas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas1.html">1.1 Using If/Truth Statements with pandas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas1.html#bitwise-boolean">1.1.1 Bitwise boolean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas1.html#using-the-in-operator">1.1.2 Using the <code class="docutils literal"><span class="pre">in</span></code> operator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas2.html">1.2 <code class="docutils literal"><span class="pre">NaN</span></code>, Integer <code class="docutils literal"><span class="pre">NA</span></code> values and <code class="docutils literal"><span class="pre">NA</span></code> type promotions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas2.html#choice-of-na-representation">1.2.1 Choice of <code class="docutils literal"><span class="pre">NA</span></code> representation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas2.html#support-for-integer-na">1.2.2 Support for integer <code class="docutils literal"><span class="pre">NA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas2.html#na-type-promotions">1.2.3 <code class="docutils literal"><span class="pre">NA</span></code> type promotions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas2.html#why-not-make-numpy-like-r">1.2.4 Why not make NumPy like R?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas3.html">1.3 Integer indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas4.html">1.4 Label-based slicing conventions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas4.html#non-monotonic-indexes-require-exact-matches">1.4.1 Non-monotonic indexes require exact matches</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas4.html#endpoints-are-inclusive">1.4.2 Endpoints are inclusive</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas5.html">1.5 Miscellaneous indexing gotchas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas5.html#reindex-versus-ix-gotchas">1.5.1 Reindex versus ix gotchas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gotchas/gotchas5.html#reindex-potentially-changes-underlying-series-dtype">1.5.2 Reindex potentially changes underlying Series dtype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas6.html">1.6 Parsing Dates from Text Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas7.html">1.7 Differences with NumPy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas8.html">1.8 Thread-safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas9.html">1.9 HTML Table Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gotchas/gotchas10.html">1.10 Byte-Ordering Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../r_interface/r_interface.html">2 rpy2 / R interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../r_interface/r_interface.html#updating-your-code-to-use-rpy2-functions">2.1 Updating your code to use rpy2 functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../r_interface/r_interface.html#r-interface-with-rpy2">2.2 R interface with rpy2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../r_interface/r_interface.html#transferring-r-data-sets-into-python">2.3 Transferring R data sets into Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../r_interface/r_interface.html#converting-dataframes-into-r-objects">2.4 Converting DataFrames into R objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../r_interface/r_interface.html#calling-r-functions-with-pandas-objects">2.5 Calling R functions with pandas objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../r_interface/r_interface.html#high-level-interface-to-r-estimators">2.6 High-level interface to R estimators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../ecosystem/ecosystem.html">3 pandas Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../ecosystem/ecosystem.html#statistics-and-machine-learning">3.1 Statistics and Machine Learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#statsmodels">3.1.1 Statsmodels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#sklearn-pandas">3.1.2 sklearn-pandas</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ecosystem/ecosystem.html#visualization">3.2 Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#bokeh">3.2.1 Bokeh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#yhat-ggplot">3.2.2 yhat/ggplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#seaborn">3.2.3 Seaborn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#vincent">3.2.4 Vincent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#ipython-vega">3.2.5 IPython Vega</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#plotly">3.2.6 Plotly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#pandas-qt">3.2.7 Pandas-Qt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ecosystem/ecosystem.html#ecosystem-ide">3.3 IDE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#ipython">3.3.1 IPython</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#quantopian-qgrid">3.3.2 quantopian/qgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#spyder">3.3.3 Spyder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ecosystem/ecosystem.html#api">3.4 API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#pandas-datareader">3.4.1 pandas-datareader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#quandl-python">3.4.2 quandl/Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#pydatastream">3.4.3 pydatastream</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#pandasdmx">3.4.4 pandaSDMX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#fredapi">3.4.5 fredapi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ecosystem/ecosystem.html#domain-specific">3.5 Domain Specific</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#geopandas">3.5.1 Geopandas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#xarray">3.5.2 xarray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ecosystem/ecosystem.html#out-of-core">3.6 Out-of-core</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#dask">3.6.1 Dask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#blaze">3.6.2 Blaze</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../ecosystem/ecosystem.html#odo">3.6.3 Odo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r.html">4 Comparison with R / R libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r1.html">4.1 Quick Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r1.html#querying-filtering-sampling">4.1.1 Querying, Filtering, Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r1.html#sorting">4.1.2 Sorting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r1.html#transforming">4.1.3 Transforming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r1.html#grouping-and-summarizing">4.1.4 Grouping and Summarizing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html">4.2 Base R</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html#slicing-with-r-s-c">4.2.1 Slicing with R&#8217;s |c|_</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html#aggregate">4.2.2 |aggregate|_</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html#match">4.2.3 |match|_</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html#tapply">4.2.4 |tapply|_</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html#subset">4.2.5 |subset|_</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r2.html#with">4.2.6 |with|_</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r3.html">4.3 plyr</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r3.html#ddply">4.3.1 |ddply|_</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r4.html">4.4 reshape / reshape2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r4.html#meltarray">4.4.1 <code class="docutils literal"><span class="pre">melt.array</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r4.html#meltlist">4.4.2 <code class="docutils literal"><span class="pre">melt.list</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r4.html#meltdf">4.4.3 <code class="docutils literal"><span class="pre">melt.data.frame</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r4.html#cast">4.4.4 <code class="docutils literal"><span class="pre">cast</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_r/comparison_with_r4.html#factor">4.4.5 <code class="docutils literal"><span class="pre">factor</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql.html">5 Comparison with SQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql1.html">5.1 SELECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql2.html">5.2 WHERE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql3.html">5.3 GROUP BY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql4.html">5.4 JOIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql4.html#inner-join">5.4.1 INNER JOIN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql4.html#left-outer-join">5.4.2 LEFT OUTER JOIN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql4.html#right-join">5.4.3 RIGHT JOIN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql4.html#full-join">5.4.4 FULL JOIN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql5.html">5.5 UNION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql6.html">5.6 Pandas equivalents for some SQL analytic and aggregate functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql6.html#top-n-rows-with-offset">5.6.1 Top N rows with offset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql6.html#top-n-rows-per-group">5.6.2 Top N rows per group</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql7.html">5.7 UPDATE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sql/comparison_with_sql8.html">5.8 DELETE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html">6 Comparison with SAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#data-structures">6.1 Data Structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#general-terminology-translation">6.1.1 General Terminology Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#dataframe-series">6.1.2 <code class="docutils literal"><span class="pre">DataFrame</span></code> / <code class="docutils literal"><span class="pre">Series</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#index">6.1.3 <code class="docutils literal"><span class="pre">Index</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#data-input-output">6.2 Data Input / Output</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#constructing-a-dataframe-from-values">6.2.1 Constructing a DataFrame from Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#reading-external-data">6.2.2 Reading External Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#exporting-data">6.2.3 Exporting Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#data-operations">6.3 Data Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#operations-on-columns">6.3.1 Operations on Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#filtering">6.3.2 Filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#if-then-logic">6.3.3 If/Then Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#date-functionality">6.3.4 Date Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#selection-of-columns">6.3.5 Selection of Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#sorting-by-values">6.3.6 Sorting by Values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#merging">6.4 Merging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#missing-data">6.5 Missing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#groupby">6.6 GroupBy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#aggregation">6.6.1 Aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#transformation">6.6.2 Transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#by-group-processing">6.6.3 By Group Processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#other-considerations">6.7 Other Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#disk-vs-memory">6.7.1 Disk vs Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../comparison_with_sas/comparison_with_sas.html#data-interop">6.7.2 Data Interop</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../internals/internals.html">7 Internals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../internals/internals.html#indexing">7.1 Indexing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../internals/internals.html#multiindex">7.1.1 MultiIndex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../internals/internals.html#subclassing-pandas-data-structures">7.2 Subclassing pandas Data Structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../internals/internals.html#override-constructor-properties">7.2.1 Override Constructor Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../internals/internals.html#define-original-properties">7.2.2 Define Original Properties</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Pandas Doc</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pandas.core.groupby</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pandas.core.groupby</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">types</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">pandas.compat</span> <span class="kn">import</span><span class="p">(</span>
    <span class="nb">zip</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="nb">long</span><span class="p">,</span> <span class="n">lzip</span><span class="p">,</span>
    <span class="nb">callable</span><span class="p">,</span> <span class="nb">map</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">compat</span>
<span class="kn">from</span> <span class="nn">pandas.compat.numpy</span> <span class="kn">import</span> <span class="n">function</span> <span class="k">as</span> <span class="n">nv</span>
<span class="kn">from</span> <span class="nn">pandas.compat.numpy</span> <span class="kn">import</span> <span class="n">_np_version_under1p8</span>

<span class="kn">from</span> <span class="nn">pandas.types.common</span> <span class="kn">import</span> <span class="p">(</span><span class="n">_DATELIKE_DTYPES</span><span class="p">,</span>
                                 <span class="n">is_numeric_dtype</span><span class="p">,</span>
                                 <span class="n">is_timedelta64_dtype</span><span class="p">,</span> <span class="n">is_datetime64_dtype</span><span class="p">,</span>
                                 <span class="n">is_categorical_dtype</span><span class="p">,</span>
                                 <span class="n">is_datetime_or_timedelta_dtype</span><span class="p">,</span>
                                 <span class="n">is_bool</span><span class="p">,</span> <span class="n">is_integer_dtype</span><span class="p">,</span>
                                 <span class="n">is_complex_dtype</span><span class="p">,</span>
                                 <span class="n">is_bool_dtype</span><span class="p">,</span>
                                 <span class="n">is_scalar</span><span class="p">,</span>
                                 <span class="n">_ensure_float64</span><span class="p">,</span>
                                 <span class="n">_ensure_platform_int</span><span class="p">,</span>
                                 <span class="n">_ensure_int64</span><span class="p">,</span>
                                 <span class="n">_ensure_object</span><span class="p">,</span>
                                 <span class="n">_ensure_float</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas.types.cast</span> <span class="kn">import</span> <span class="n">_possibly_downcast_to_dtype</span>
<span class="kn">from</span> <span class="nn">pandas.types.missing</span> <span class="kn">import</span> <span class="n">isnull</span><span class="p">,</span> <span class="n">notnull</span><span class="p">,</span> <span class="n">_maybe_fill</span>

<span class="kn">from</span> <span class="nn">pandas.core.common</span> <span class="kn">import</span> <span class="n">_values_from_object</span><span class="p">,</span> <span class="n">AbstractMethodError</span>
<span class="kn">from</span> <span class="nn">pandas.core.base</span> <span class="kn">import</span> <span class="p">(</span><span class="n">PandasObject</span><span class="p">,</span> <span class="n">SelectionMixin</span><span class="p">,</span> <span class="n">GroupByError</span><span class="p">,</span>
                              <span class="n">DataError</span><span class="p">,</span> <span class="n">SpecificationError</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas.core.categorical</span> <span class="kn">import</span> <span class="n">Categorical</span>
<span class="kn">from</span> <span class="nn">pandas.core.frame</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pandas.core.generic</span> <span class="kn">import</span> <span class="n">NDFrame</span>
<span class="kn">from</span> <span class="nn">pandas.core.index</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">,</span> <span class="n">CategoricalIndex</span><span class="p">,</span>
                               <span class="n">_ensure_index</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas.core.internals</span> <span class="kn">import</span> <span class="n">BlockManager</span><span class="p">,</span> <span class="n">make_block</span>
<span class="kn">from</span> <span class="nn">pandas.core.series</span> <span class="kn">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">pandas.core.panel</span> <span class="kn">import</span> <span class="n">Panel</span>
<span class="kn">from</span> <span class="nn">pandas.util.decorators</span> <span class="kn">import</span> <span class="p">(</span><span class="n">cache_readonly</span><span class="p">,</span> <span class="n">Substitution</span><span class="p">,</span> <span class="n">Appender</span><span class="p">,</span>
                                    <span class="n">make_signature</span><span class="p">,</span> <span class="n">deprecate_kwarg</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas.formats.printing</span> <span class="kn">import</span> <span class="n">pprint_thing</span>
<span class="kn">from</span> <span class="nn">pandas.util.validators</span> <span class="kn">import</span> <span class="n">validate_kwargs</span>

<span class="kn">import</span> <span class="nn">pandas.core.algorithms</span> <span class="kn">as</span> <span class="nn">algos</span>
<span class="kn">import</span> <span class="nn">pandas.core.common</span> <span class="kn">as</span> <span class="nn">com</span>
<span class="kn">from</span> <span class="nn">pandas.core.config</span> <span class="kn">import</span> <span class="n">option_context</span>
<span class="kn">import</span> <span class="nn">pandas.lib</span> <span class="kn">as</span> <span class="nn">lib</span>
<span class="kn">from</span> <span class="nn">pandas.lib</span> <span class="kn">import</span> <span class="n">Timestamp</span>
<span class="kn">import</span> <span class="nn">pandas.tslib</span> <span class="kn">as</span> <span class="nn">tslib</span>
<span class="kn">import</span> <span class="nn">pandas.algos</span> <span class="kn">as</span> <span class="nn">_algos</span>
<span class="kn">import</span> <span class="nn">pandas.hashtable</span> <span class="kn">as</span> <span class="nn">_hash</span>

<span class="n">_doc_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">        See also</span>
<span class="s2">        --------</span>
<span class="s2">        pandas.Series.</span><span class="si">%(name)s</span><span class="s2"></span>
<span class="s2">        pandas.DataFrame.</span><span class="si">%(name)s</span><span class="s2"></span>
<span class="s2">        pandas.Panel.</span><span class="si">%(name)s</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># special case to prevent duplicate plots when catching exceptions when</span>
<span class="c1"># forwarding methods from NDFrames</span>
<span class="n">_plotting_methods</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s1">&#39;plot&#39;</span><span class="p">,</span> <span class="s1">&#39;boxplot&#39;</span><span class="p">,</span> <span class="s1">&#39;hist&#39;</span><span class="p">])</span>

<span class="n">_common_apply_whitelist</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span>
    <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span>
    <span class="s1">&#39;head&#39;</span><span class="p">,</span> <span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cumsum&#39;</span><span class="p">,</span> <span class="s1">&#39;cumprod&#39;</span><span class="p">,</span> <span class="s1">&#39;cummin&#39;</span><span class="p">,</span> <span class="s1">&#39;cummax&#39;</span><span class="p">,</span> <span class="s1">&#39;cumcount&#39;</span><span class="p">,</span>
    <span class="s1">&#39;resample&#39;</span><span class="p">,</span>
    <span class="s1">&#39;describe&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rank&#39;</span><span class="p">,</span> <span class="s1">&#39;quantile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fillna&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
    <span class="s1">&#39;take&#39;</span><span class="p">,</span>
    <span class="s1">&#39;idxmax&#39;</span><span class="p">,</span> <span class="s1">&#39;idxmin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;shift&#39;</span><span class="p">,</span> <span class="s1">&#39;tshift&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="s1">&#39;bfill&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pct_change&#39;</span><span class="p">,</span> <span class="s1">&#39;skew&#39;</span><span class="p">,</span>
    <span class="s1">&#39;corr&#39;</span><span class="p">,</span> <span class="s1">&#39;cov&#39;</span><span class="p">,</span> <span class="s1">&#39;diff&#39;</span><span class="p">,</span>
<span class="p">])</span> <span class="o">|</span> <span class="n">_plotting_methods</span>

<span class="n">_series_apply_whitelist</span> <span class="o">=</span> \
    <span class="p">(</span><span class="n">_common_apply_whitelist</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;boxplot&#39;</span><span class="p">]))</span> <span class="o">|</span> \
    <span class="nb">frozenset</span><span class="p">([</span><span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;unique&#39;</span><span class="p">])</span>

<span class="n">_dataframe_apply_whitelist</span> <span class="o">=</span> \
    <span class="n">_common_apply_whitelist</span> <span class="o">|</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s1">&#39;dtypes&#39;</span><span class="p">,</span> <span class="s1">&#39;corrwith&#39;</span><span class="p">])</span>

<span class="n">_cython_transforms</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s1">&#39;cumprod&#39;</span><span class="p">,</span> <span class="s1">&#39;cumsum&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">_groupby_function</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">npfunc</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                      <span class="n">_convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

    <span class="n">_local_template</span> <span class="o">=</span> <span class="s2">&quot;Compute </span><span class="si">%(f)s</span><span class="s2"> of group values&quot;</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_local_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_agg_general</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="n">numeric_only</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpecificationError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">npfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">_convert</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="n">f</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">return</span> <span class="n">f</span>


<span class="k">def</span> <span class="nf">_first_compat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_first</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">notnull</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_first</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_first</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_last_compat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_last</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">notnull</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_last</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_last</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<div class="viewcode-block" id="Grouper"><a class="viewcode-back" href="../../../generated/pandas.Grouper.html#pandas.Grouper">[docs]</a><span class="k">class</span> <span class="nc">Grouper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Grouper allows the user to specify a groupby instruction for a target</span>
<span class="sd">    object</span>

<span class="sd">    This specification will select a column via the key parameter, or if the</span>
<span class="sd">    level and/or axis parameters are given, a level of the index of the target</span>
<span class="sd">    object.</span>

<span class="sd">    These are local specifications and will override &#39;global&#39; settings,</span>
<span class="sd">    that is the parameters axis and level which are passed to the groupby</span>
<span class="sd">    itself.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : string, defaults to None</span>
<span class="sd">        groupby key, which selects the grouping column of the target</span>
<span class="sd">    level : name/number, defaults to None</span>
<span class="sd">        the level for the target index</span>
<span class="sd">    freq : string / frequency object, defaults to None</span>
<span class="sd">        This will groupby the specified frequency if the target selection</span>
<span class="sd">        (via key or level) is a datetime-like object. For full specification</span>
<span class="sd">        of available frequencies, please see</span>
<span class="sd">        `here &lt;http://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.</span>
<span class="sd">    axis : number/name of the axis, defaults to 0</span>
<span class="sd">    sort : boolean, default to False</span>
<span class="sd">        whether to sort the resulting labels</span>

<span class="sd">    additional kwargs to control time-like groupers (when freq is passed)</span>

<span class="sd">    closed : closed end of interval; left or right</span>
<span class="sd">    label : interval boundary to use for labeling; left or right</span>
<span class="sd">    convention : {&#39;start&#39;, &#39;end&#39;, &#39;e&#39;, &#39;s&#39;}</span>
<span class="sd">        If grouper is PeriodIndex</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A specification for a groupby instruction</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Syntactic sugar for ``df.groupby(&#39;A&#39;)``</span>

<span class="sd">    &gt;&gt;&gt; df.groupby(Grouper(key=&#39;A&#39;))</span>

<span class="sd">    Specify a resample operation on the column &#39;date&#39;</span>

<span class="sd">    &gt;&gt;&gt; df.groupby(Grouper(key=&#39;date&#39;, freq=&#39;60s&#39;))</span>

<span class="sd">    Specify a resample operation on the level &#39;date&#39; on the columns axis</span>
<span class="sd">    with a frequency of 60s</span>

<span class="sd">    &gt;&gt;&gt; df.groupby(Grouper(level=&#39;date&#39;, freq=&#39;60s&#39;, axis=1))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pandas.tseries.resample</span> <span class="kn">import</span> <span class="n">TimeGrouper</span>
            <span class="n">cls</span> <span class="o">=</span> <span class="n">TimeGrouper</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Grouper</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="n">sort</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexer</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span>

    <span class="k">def</span> <span class="nf">_get_grouper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : the subject object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a tuple of binner, grouper, obj (possibly sorted)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_grouper</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="n">exclusions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">_get_grouper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">],</span>
                                                          <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span>
                                                          <span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">,</span>
                                                          <span class="n">sort</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>

    <span class="k">def</span> <span class="nf">_set_grouper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        given an object and the specifications, setup the internal grouper</span>
<span class="sd">        for this particular specification</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : the subject object</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The Grouper cannot specify both a key and a level!&quot;</span><span class="p">)</span>

        <span class="c1"># the key must be a valid info item</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">_info_axis</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;The grouper name {0} is not found&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span>

                <span class="c1"># if a level is given it must be a mi level or</span>
                <span class="c1"># equivalent to the axis name</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">):</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_get_level_number</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span>
                        <span class="n">level</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;The level {0} is not valid&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">level</span><span class="p">))</span>

        <span class="c1"># possibly sort</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="ow">or</span> <span class="n">sort</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ax</span><span class="o">.</span><span class="n">is_monotonic</span><span class="p">:</span>
            <span class="c1"># use stable sort to support first, last, nth</span>
            <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexer</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indexer</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span>
                           <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">is_copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span>

    <span class="k">def</span> <span class="nf">_get_binner_for_grouping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; default to the standard binner here &quot;&quot;&quot;</span>
        <span class="n">group_axis</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Grouping</span><span class="p">(</span><span class="n">group_axis</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                        <span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">,</span> <span class="n">in_axis</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groups</span></div>


<span class="k">class</span> <span class="nc">GroupByPlot</span><span class="p">(</span><span class="n">PandasObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class implementing the .plot attribute for groupby objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupby</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_groupby</span> <span class="o">=</span> <span class="n">groupby</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="s1">&#39;plot&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groupby</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">attr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groupby</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attr</span>


<span class="k">class</span> <span class="nc">_GroupBy</span><span class="p">(</span><span class="n">PandasObject</span><span class="p">,</span> <span class="n">SelectionMixin</span><span class="p">):</span>
    <span class="n">_group_selection</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_apply_whitelist</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([])</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">grouper</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">exclusions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="n">selection</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">NDFrame</span><span class="p">):</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_consolidate_inplace</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">as_index</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;as_index=False only valid with DataFrame&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;as_index=False only valid for axis=0&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="o">=</span> <span class="n">as_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="n">keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="n">sort</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_keys</span> <span class="o">=</span> <span class="n">group_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">squeeze</span> <span class="o">=</span> <span class="n">squeeze</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutated</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mutated&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">grouper</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">grouper</span><span class="p">,</span> <span class="n">exclusions</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">_get_grouper</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span>
                                                    <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                                                    <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
                                                    <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
                                                    <span class="n">mutated</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutated</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_get_axis_number</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">grouper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclusions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclusions</span><span class="p">)</span> <span class="k">if</span> <span class="n">exclusions</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># we accept no other args</span>
        <span class="n">validate_kwargs</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">{})</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: Better unicode/repr for GroupBy object</span>
        <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_assure_grouper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        we create the grouper on instantiation</span>
<span class="sd">        sub-classes may have a different policy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; dict {group name -&gt; group labels} &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assure_grouper</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groups</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ngroups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assure_grouper</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">ngroups</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; dict {group name -&gt; group indices} &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assure_grouper</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">indices</span>

    <span class="k">def</span> <span class="nf">_get_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        safe get multiple indices, translate keys for</span>
<span class="sd">        datelike to underlying repr</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get_converter</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="c1"># possibly convert to the actual key types</span>
            <span class="c1"># in the indices, could be a Timestamp or a np.datetime64</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="n">Timestamp</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)):</span>
                <span class="k">return</span> <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
                <span class="k">return</span> <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">asm8</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="n">key</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index_sample</span> <span class="o">=</span> <span class="bp">None</span>     <span class="c1"># Dummy sample</span>

        <span class="n">name_sample</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index_sample</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_sample</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;must supply a tuple to get_group with multiple&quot;</span>
                       <span class="s2">&quot; grouping keys&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_sample</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_sample</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># If the original grouper was a tuple</span>
                    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="c1"># turns out it wasn&#39;t a tuple</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;must supply a a same-length tuple to get_group&quot;</span>
                           <span class="s2">&quot; with multiple grouping keys&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="n">converters</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_converter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">index_sample</span><span class="p">]</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">converters</span><span class="p">,</span> <span class="n">name</span><span class="p">)])</span>
                     <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">converter</span> <span class="o">=</span> <span class="n">get_converter</span><span class="p">(</span><span class="n">index_sample</span><span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">converter</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; safe get index, translate keys for datelike to underlying repr &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_indices</span><span class="p">([</span><span class="n">name</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">_selected_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_group_selection</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_selection</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_reset_group_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear group based selection. Used for methods needing to return info on</span>
<span class="sd">        each group regardless of whether a group selection was previously set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_selection</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="c1"># GH12839 clear cached selection too when changing group selection</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_cache</span><span class="p">(</span><span class="s1">&#39;_selected_obj&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_group_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create group based selection. Used when selection is not passed</span>
<span class="sd">        directly but instead via a grouper.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="s1">&#39;groupings&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_info_axis</span>
            <span class="n">groupers</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">grp</span><span class="o">.</span><span class="n">groupings</span>
                        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">level</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">g</span><span class="o">.</span><span class="n">in_axis</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupers</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_group_selection</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">Index</span><span class="p">(</span><span class="n">groupers</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="c1"># GH12839 clear selected obj cache when group selection changes</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_reset_cache</span><span class="p">(</span><span class="s1">&#39;_selected_obj&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_result_index_ordered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="c1"># set the result index on the passed values object and</span>
        <span class="c1"># return the new object, xref 8046</span>

        <span class="c1"># the values/counts are repeated according to the group index</span>
        <span class="c1"># shortcut if we have an already ordered grouper</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">is_monotonic</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">)))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="n">result</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_dir_additions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_dir_additions</span><span class="p">()</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_whitelist</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_names_set</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_wrapper</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> object has no attribute </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

    <span class="n">plot</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">GroupByPlot</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_make_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_whitelist</span><span class="p">:</span>
            <span class="n">is_callable</span> <span class="o">=</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39; callable &#39;</span> <span class="k">if</span> <span class="n">is_callable</span> <span class="k">else</span> <span class="s1">&#39; &#39;</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Cannot access{0}attribute {1!r} of {2!r} objects, try &quot;</span>
                   <span class="s2">&quot;using the &#39;apply&#39; method&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                     <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># need to setup the selection</span>
        <span class="c1"># as are not passed directly but in the grouper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># a little trickery for aggregation functions that need an axis</span>
            <span class="c1"># argument</span>
            <span class="n">kwargs_with_axis</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;axis&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs_with_axis</span> <span class="ow">or</span> \
               <span class="n">kwargs_with_axis</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">kwargs_with_axis</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>

            <span class="k">def</span> <span class="nf">curried_with_axis</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_with_axis</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">curried</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># preserve the name so we can detect it when calling plot methods,</span>
            <span class="c1"># to avoid duplicates</span>
            <span class="n">curried</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="n">curried_with_axis</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="n">name</span>

            <span class="c1"># special case otherwise extra plots are created when catching the</span>
            <span class="c1"># exception below</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">_plotting_methods</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">curried</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">curried_with_axis</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">curried</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>

                    <span class="c1"># related to : GH3688</span>
                    <span class="c1"># try item-by-item</span>
                    <span class="c1"># this can be called recursively, so need to raise</span>
                    <span class="c1"># ValueError</span>
                    <span class="c1"># if we don&#39;t have this method to indicated to aggregate to</span>
                    <span class="c1"># mark this column as an error</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_item_by_item</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                                                            <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">def</span> <span class="nf">get_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs NDFrame from group with provided name</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : object</span>
<span class="sd">            the name of the group to get as a DataFrame</span>
<span class="sd">        obj : NDFrame, default None</span>
<span class="sd">            the NDFrame to take the DataFrame out of.  If</span>
<span class="sd">            it is None, the object groupby was called on will</span>
<span class="sd">            be used</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        group : type of obj</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span>

        <span class="n">inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">inds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groupby iterator</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Generator yielding sequence of (name, subsetted object)</span>
<span class="sd">        for each group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">get_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply function and combine results together in an intelligent way. The</span>
<span class="sd">        split-apply-combine combination rules attempt to be as common sense</span>
<span class="sd">        based as possible. For example:</span>

<span class="sd">        case 1:</span>
<span class="sd">        group DataFrame</span>
<span class="sd">        apply aggregation function (f(chunk) -&gt; Series)</span>
<span class="sd">        yield DataFrame, with group axis having group labels</span>

<span class="sd">        case 2:</span>
<span class="sd">        group DataFrame</span>
<span class="sd">        apply transform function ((f(chunk) -&gt; DataFrame with same indexes)</span>
<span class="sd">        yield DataFrame with resulting chunks glued together</span>

<span class="sd">        case 3:</span>
<span class="sd">        group Series</span>
<span class="sd">        apply function with f(chunk) -&gt; DataFrame</span>
<span class="sd">        yield DataFrame with result of chunks glued together</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : function</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        See online documentation for full exposition on how to use apply.</span>

<span class="sd">        In the current implementation apply calls func twice on the</span>
<span class="sd">        first group to decide whether it can take a fast or slow code</span>
<span class="sd">        path. This can lead to unexpected behavior if func has</span>
<span class="sd">        side-effects, as they will take effect twice for the first</span>
<span class="sd">        group.</span>


<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        aggregate, transform&quot;&quot;&quot;</span>

        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_builtin_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="c1"># this is needed so we don&#39;t try and wrap strings. If we could</span>
        <span class="c1"># resolve functions to their callable functions prior, this</span>
        <span class="c1"># wouldn&#39;t be needed</span>
        <span class="k">if</span> <span class="n">args</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>

                <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;func must be a callable if args or &#39;</span>
                                 <span class="s1">&#39;kwargs are supplied&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">func</span>

        <span class="c1"># ignore SettingWithCopy here in case the user mutates</span>
        <span class="k">with</span> <span class="n">option_context</span><span class="p">(</span><span class="s1">&#39;mode.chained_assignment&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_apply_general</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_python_apply_general</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">mutated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_applied_output</span><span class="p">(</span>
            <span class="n">keys</span><span class="p">,</span>
            <span class="n">values</span><span class="p">,</span>
            <span class="n">not_indexed_same</span><span class="o">=</span><span class="n">mutated</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutated</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_iterate_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AbstractMethodError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cumcount_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ascending : bool, default True</span>
<span class="sd">            If False, number in reverse, from length of group - 1 to 0.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        this is currently implementing sort=False</span>
<span class="sd">        (though the default is sort=True) for groupby in general</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">sorter</span> <span class="o">=</span> <span class="n">_get_group_index_sorter</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">)</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="n">run</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="n">ids</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">run</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">count</span><span class="p">])</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">run</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ascending</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">run</span><span class="p">],</span> <span class="n">rep</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">run</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="bp">True</span><span class="p">]],</span> <span class="n">rep</span><span class="p">)</span> <span class="o">-</span> <span class="n">out</span>

        <span class="n">rev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>
        <span class="n">rev</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="n">rev</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_index_with_as_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Take boolean mask of index to be returned from apply, if as_index=True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO perf, it feels like this should already be somewhere...</span>
        <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
        <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">index</span>
        <span class="n">gp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">chain</span><span class="p">((</span><span class="n">gp</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">gp</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">b</span><span class="p">]]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gp</span><span class="o">.</span><span class="n">groupings</span><span class="p">))),</span>
                       <span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="n">b</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">nlevels</span><span class="p">)))</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">names</span> <span class="o">+</span> <span class="n">original</span><span class="o">.</span><span class="n">names</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">_try_cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        try to cast the result to our obj original type,</span>
<span class="sd">        we may have roundtripped thru object in the mean-time</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_possibly_downcast_to_dtype</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_cython_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_slices</span><span class="p">():</span>
            <span class="n">is_numeric</span> <span class="o">=</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">numeric_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_numeric</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GroupByError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="n">output</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="s1">&#39;No numeric types to aggregate&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_transformed_output</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cython_agg_general</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_slices</span><span class="p">():</span>
            <span class="n">is_numeric</span> <span class="o">=</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">numeric_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_numeric</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GroupByError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="n">output</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="s1">&#39;No numeric types to aggregate&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_aggregated_output</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_python_agg_general</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_builtin_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># iterate through &quot;columns&quot; ex exclusions to populate output dict</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_slices</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">agg_series</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_apply_general</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">_filter_empty_groups</span><span class="p">:</span>

            <span class="n">mask</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">compat</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>

                <span class="c1"># since we are masking, make sure that we have a float object</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">if</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">_ensure_float</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

                <span class="n">output</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_aggregated_output</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_applied_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AbstractMethodError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_concat_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">not_indexed_same</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas.tools.merge</span> <span class="kn">import</span> <span class="n">concat</span>

        <span class="k">def</span> <span class="nf">reset_identity</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="c1"># reset the identities of the components</span>
            <span class="c1"># of the values to prevent aliasing</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">_reset_identity</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">values</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">not_indexed_same</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_keys</span><span class="p">:</span>

            <span class="n">values</span> <span class="o">=</span> <span class="n">reset_identity</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>

                <span class="c1"># possible MI return case</span>
                <span class="n">group_keys</span> <span class="o">=</span> <span class="n">keys</span>
                <span class="n">group_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">levels</span>
                <span class="n">group_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span>

                <span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">group_keys</span><span class="p">,</span>
                                <span class="n">levels</span><span class="o">=</span><span class="n">group_levels</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">group_names</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="c1"># GH5610, returns a MI, with the first level being a</span>
                <span class="c1"># range index</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">reset_identity</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="ow">and</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>

            <span class="n">result</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">dropna</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">indices</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
            <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="n">mask</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">mask</span><span class="p">[</span><span class="n">indices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="c1"># mask fails to broadcast when passed to where; broadcast manually.</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>  <span class="c1"># Fill with NaNs.</span>
        <span class="k">return</span> <span class="n">filtered</span>


<span class="k">class</span> <span class="nc">GroupBy</span><span class="p">(</span><span class="n">_GroupBy</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for grouping and aggregating relational data. See aggregate,</span>
<span class="sd">    transform, and apply functions on this object.</span>

<span class="sd">    It&#39;s easiest to use obj.groupby(...) to use GroupBy, but you can also do:</span>

<span class="sd">    ::</span>

<span class="sd">        grouped = groupby(obj, ...)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : pandas object</span>
<span class="sd">    axis : int, default 0</span>
<span class="sd">    level : int, default None</span>
<span class="sd">        Level of MultiIndex</span>
<span class="sd">    groupings : list of Grouping objects</span>
<span class="sd">        Most users should ignore this</span>
<span class="sd">    exclusions : array-like, optional</span>
<span class="sd">        List of columns to exclude</span>
<span class="sd">    name : string</span>
<span class="sd">        Most users should ignore this</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    After grouping, see aggregate, apply, and transform functions. Here are</span>
<span class="sd">    some other brief notes about usage. When grouping by multiple groups, the</span>
<span class="sd">    result index will be a MultiIndex (hierarchical) by default.</span>

<span class="sd">    Iteration produces (key, group) tuples, i.e. chunking the data by group. So</span>
<span class="sd">    you can write code like:</span>

<span class="sd">    ::</span>

<span class="sd">        grouped = obj.groupby(keys, axis=axis)</span>
<span class="sd">        for key, group in grouped:</span>
<span class="sd">            # do something with the data</span>

<span class="sd">    Function calls on GroupBy, if not specially implemented, &quot;dispatch&quot; to the</span>
<span class="sd">    grouped data. So if you group a DataFrame and wish to invoke the std()</span>
<span class="sd">    method on each group, you can simply do:</span>

<span class="sd">    ::</span>

<span class="sd">        df.groupby(mapper).std()</span>

<span class="sd">    rather than</span>

<span class="sd">    ::</span>

<span class="sd">        df.groupby(mapper).aggregate(np.std)</span>

<span class="sd">    You can pass arguments to these &quot;wrapped&quot; functions, too.</span>

<span class="sd">    See the online documentation for full exposition on these topics and much</span>
<span class="sd">    more</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    **Attributes**</span>
<span class="sd">    groups : dict</span>
<span class="sd">        {group name -&gt; group labels}</span>
<span class="sd">    len(grouped) : int</span>
<span class="sd">        Number of groups</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_apply_whitelist</span> <span class="o">=</span> <span class="n">_common_apply_whitelist</span>

    <span class="k">def</span> <span class="nf">irow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DEPRECATED. Use ``.nth(i)`` instead</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># 10177</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;irow(i) is deprecated. Please use .nth(i)&quot;</span><span class="p">,</span>
                      <span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.count"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.count.html#pandas.GroupBy.count">[docs]</a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute count of group, excluding missing values&quot;&quot;&quot;</span>

        <span class="c1"># defined here for API doc</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.mean"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.mean.html#pandas.GroupBy.mean">[docs]</a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute mean of groups, excluding missing values</span>

<span class="sd">        For multiple groupings, the result index will be a MultiIndex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nv</span><span class="o">.</span><span class="n">validate_groupby_func</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_agg_general</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">GroupByError</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_agg_general</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.median"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.median.html#pandas.GroupBy.median">[docs]</a>    <span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute median of groups, excluding missing values</span>

<span class="sd">        For multiple groupings, the result index will be a MultiIndex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_agg_general</span><span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">GroupByError</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>

            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_agg_general</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.std"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.std.html#pandas.GroupBy.std">[docs]</a>    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute standard deviation of groups, excluding missing values</span>

<span class="sd">        For multiple groupings, the result index will be a MultiIndex</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ddof : integer, default 1</span>
<span class="sd">            degrees of freedom</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: implement at Cython level?</span>
        <span class="n">nv</span><span class="o">.</span><span class="n">validate_groupby_func</span><span class="p">(</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">))</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.var"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.var.html#pandas.GroupBy.var">[docs]</a>    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute variance of groups, excluding missing values</span>

<span class="sd">        For multiple groupings, the result index will be a MultiIndex</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ddof : integer, default 1</span>
<span class="sd">            degrees of freedom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nv</span><span class="o">.</span><span class="n">validate_groupby_func</span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ddof</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_agg_general</span><span class="p">(</span><span class="s1">&#39;var&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_agg_general</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.sem"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.sem.html#pandas.GroupBy.sem">[docs]</a>    <span class="k">def</span> <span class="nf">sem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute standard error of the mean of groups, excluding missing values</span>

<span class="sd">        For multiple groupings, the result index will be a MultiIndex</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ddof : integer, default 1</span>
<span class="sd">            degrees of freedom</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">())</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.size"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.size.html#pandas.GroupBy.size">[docs]</a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute group sizes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">size</span><span class="p">()</span></div>

    <span class="nb">sum</span> <span class="o">=</span> <span class="n">_groupby_function</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
    <span class="n">prod</span> <span class="o">=</span> <span class="n">_groupby_function</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span><span class="p">,</span> <span class="s1">&#39;prod&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">)</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="n">_groupby_function</span><span class="p">(</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="n">_groupby_function</span><span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">_groupby_function</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">_first_compat</span><span class="p">,</span>
                              <span class="n">numeric_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">_convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">_groupby_function</span><span class="p">(</span><span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="n">_last_compat</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                             <span class="n">_convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.ohlc"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.ohlc.html#pandas.GroupBy.ohlc">[docs]</a>    <span class="k">def</span> <span class="nf">ohlc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute sum of values, excluding missing values</span>
<span class="sd">        For multiple groupings, the result index will be a MultiIndex</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_column_groupbys</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">_cython_agg_general</span><span class="p">(</span><span class="s1">&#39;ohlc&#39;</span><span class="p">))</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provide resampling when using a TimeGrouper</span>
<span class="sd">        Return a new grouper with our resampler appended</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pandas.tseries.resample</span> <span class="kn">import</span> <span class="n">get_resampler_for_grouping</span>
        <span class="k">return</span> <span class="n">get_resampler_for_grouping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rolling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a rolling grouper, providing rolling</span>
<span class="sd">        functionaility per group</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pandas.core.window</span> <span class="kn">import</span> <span class="n">RollingGroupby</span>
        <span class="k">return</span> <span class="n">RollingGroupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">expanding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an expanding grouper, providing expanding</span>
<span class="sd">        functionaility per group</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pandas.core.window</span> <span class="kn">import</span> <span class="n">ExpandingGroupby</span>
        <span class="k">return</span> <span class="n">ExpandingGroupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Forward fill the values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit : integer, optional</span>
<span class="sd">            limit of how many values to fill</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Series.fillna</span>
<span class="sd">        DataFrame.fillna</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">))</span>
    <span class="n">ffill</span> <span class="o">=</span> <span class="n">pad</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">backfill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Backward fill the values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit : integer, optional</span>
<span class="sd">            limit of how many values to fill</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Series.fillna</span>
<span class="sd">        DataFrame.fillna</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">bfill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">))</span>
    <span class="n">bfill</span> <span class="o">=</span> <span class="n">backfill</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.nth"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.nth.html#pandas.GroupBy.nth">[docs]</a>    <span class="k">def</span> <span class="nf">nth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Take the nth row from each group if n is an int, or a subset of rows</span>
<span class="sd">        if n is a list of ints.</span>

<span class="sd">        If dropna, will take the nth non-null row, dropna is either</span>
<span class="sd">        Truthy (if a Series) or &#39;all&#39;, &#39;any&#39; (if a DataFrame);</span>
<span class="sd">        this is equivalent to calling dropna(how=dropna) before the</span>
<span class="sd">        groupby.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int or list of ints</span>
<span class="sd">            a single nth value for the row or a list of nth values</span>
<span class="sd">        dropna : None or str, optional</span>
<span class="sd">            apply the specified dropna operation before counting which row is</span>
<span class="sd">            the nth row. Needs to be None, &#39;any&#39; or &#39;all&#39;</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({&#39;A&#39;: [1, 1, 2, 1, 2],</span>
<span class="sd">        ...                    &#39;B&#39;: [np.nan, 2, 3, 4, 5]}, columns=[&#39;A&#39;, &#39;B&#39;])</span>
<span class="sd">        &gt;&gt;&gt; g = df.groupby(&#39;A&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g.nth(0)</span>
<span class="sd">             B</span>
<span class="sd">        A</span>
<span class="sd">        1  NaN</span>
<span class="sd">        2  3.0</span>
<span class="sd">        &gt;&gt;&gt; g.nth(1)</span>
<span class="sd">             B</span>
<span class="sd">        A</span>
<span class="sd">        1  2.0</span>
<span class="sd">        2  5.0</span>
<span class="sd">        &gt;&gt;&gt; g.nth(-1)</span>
<span class="sd">             B</span>
<span class="sd">        A</span>
<span class="sd">        1  4.0</span>
<span class="sd">        2  5.0</span>
<span class="sd">        &gt;&gt;&gt; g.nth([0, 1])</span>
<span class="sd">             B</span>
<span class="sd">        A</span>
<span class="sd">        1  NaN</span>
<span class="sd">        1  2.0</span>
<span class="sd">        2  3.0</span>
<span class="sd">        2  5.0</span>

<span class="sd">        Specifying ``dropna`` allows count ignoring NaN</span>

<span class="sd">        &gt;&gt;&gt; g.nth(0, dropna=&#39;any&#39;)</span>
<span class="sd">             B</span>
<span class="sd">        A</span>
<span class="sd">        1  2.0</span>
<span class="sd">        2  3.0</span>

<span class="sd">        NaNs denote group exhausted when using dropna</span>

<span class="sd">        &gt;&gt;&gt; g.nth(3, dropna=&#39;any&#39;)</span>
<span class="sd">            B</span>
<span class="sd">        A</span>
<span class="sd">        1 NaN</span>
<span class="sd">        2 NaN</span>

<span class="sd">        Specifying ``as_index=False`` in ``groupby`` keeps the original index.</span>

<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;, as_index=False).nth(1)</span>
<span class="sd">           A    B</span>
<span class="sd">        1  1  2.0</span>
<span class="sd">        4  2  5.0</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">nth_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">nth_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">dropna</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;dropna option with a list of nth values is not supported&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;n needs to be an int or a list/set/tuple of ints&quot;</span><span class="p">)</span>

        <span class="n">nth_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nth_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dropna</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cumcount_array</span><span class="p">(),</span> <span class="n">nth_values</span><span class="p">)</span> <span class="o">|</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cumcount_array</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">nth_values</span><span class="p">)</span>

            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">out</span>

            <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
            <span class="n">out</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">mask</span><span class="p">]]</span>

            <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="k">else</span> <span class="n">out</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> \
           <span class="n">dropna</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]:</span>
            <span class="c1"># Note: when agg-ing picker doesn&#39;t raise this, just returns NaN</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;For a DataFrame groupby, dropna must be &quot;</span>
                             <span class="s2">&quot;either None, &#39;any&#39; or &#39;all&#39;, &quot;</span>
                             <span class="s2">&quot;(was passed </span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dropna</span><span class="p">),)</span>

        <span class="c1"># old behaviour, but with all and any support for DataFrames.</span>
        <span class="c1"># modified in GH 7559 to have better perf</span>
        <span class="n">max_len</span> <span class="o">=</span> <span class="n">n</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n</span>
        <span class="n">dropped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="n">dropna</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="c1"># get a new grouper for our dropped obj</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="c1"># we don&#39;t have the grouper info available</span>
            <span class="c1"># (e.g. we have selected out</span>
            <span class="c1"># a column that is not in the current object)</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">axis</span>
            <span class="n">grouper</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dropped</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># create a grouper with the original parameters, but on the dropped</span>
            <span class="c1"># object</span>
            <span class="n">grouper</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_get_grouper</span><span class="p">(</span><span class="n">dropped</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">,</span>
                                         <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">,</span>
                                         <span class="n">sort</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">,</span>
                                         <span class="n">mutated</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutated</span><span class="p">)</span>

        <span class="n">grb</span> <span class="o">=</span> <span class="n">dropped</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">)</span>
        <span class="n">sizes</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">grb</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">grb</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizes</span> <span class="o">&lt;</span> <span class="n">max_len</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># set the results which don&#39;t meet the criteria</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">and</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># reset/reindex to the original groups</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">dropped</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.cumcount"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.cumcount.html#pandas.GroupBy.cumcount">[docs]</a>    <span class="k">def</span> <span class="nf">cumcount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number each item in each group from 0 to the length of that group - 1.</span>

<span class="sd">        Essentially this is equivalent to</span>

<span class="sd">        &gt;&gt;&gt; self.apply(lambda x: Series(np.arange(len(x)), x.index))</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ascending : bool, default True</span>
<span class="sd">            If False, number in reverse, from length of group - 1 to 0.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame([[&#39;a&#39;], [&#39;a&#39;], [&#39;a&#39;], [&#39;b&#39;], [&#39;b&#39;], [&#39;a&#39;]],</span>
<span class="sd">        ...                   columns=[&#39;A&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           A</span>
<span class="sd">        0  a</span>
<span class="sd">        1  a</span>
<span class="sd">        2  a</span>
<span class="sd">        3  b</span>
<span class="sd">        4  b</span>
<span class="sd">        5  a</span>
<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;).cumcount()</span>
<span class="sd">        0    0</span>
<span class="sd">        1    1</span>
<span class="sd">        2    2</span>
<span class="sd">        3    0</span>
<span class="sd">        4    1</span>
<span class="sd">        5    3</span>
<span class="sd">        dtype: int64</span>
<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;).cumcount(ascending=False)</span>
<span class="sd">        0    3</span>
<span class="sd">        1    2</span>
<span class="sd">        2    1</span>
<span class="sd">        3    1</span>
<span class="sd">        4    0</span>
<span class="sd">        5    0</span>
<span class="sd">        dtype: int64</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_group_selection</span><span class="p">()</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">index</span>
        <span class="n">cumcounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cumcount_array</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">cumcounts</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">cumprod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cumulative product for each group&quot;&quot;&quot;</span>
        <span class="n">nv</span><span class="o">.</span><span class="n">validate_groupby_func</span><span class="p">(</span><span class="s1">&#39;cumprod&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_transform</span><span class="p">(</span><span class="s1">&#39;cumprod&#39;</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cumulative sum for each group&quot;&quot;&quot;</span>
        <span class="n">nv</span><span class="o">.</span><span class="n">validate_groupby_func</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shift each group by periods observations</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        periods : integer, default 1</span>
<span class="sd">            number of periods to shift</span>
<span class="sd">        freq : frequency string</span>
<span class="sd">        axis : axis to shift, default 0</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">axis</span><span class="p">))</span>

        <span class="n">labels</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>

        <span class="c1"># filled in by Cython</span>
        <span class="n">indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">_algos</span><span class="o">.</span><span class="n">group_shift_indexer</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">periods</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_slices</span><span class="p">():</span>
            <span class="n">output</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_nd</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">indexer</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_transformed_output</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.head"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.head.html#pandas.GroupBy.head">[docs]</a>    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns first n rows of each group.</span>

<span class="sd">        Essentially equivalent to ``.apply(lambda x: x.head(n))``,</span>
<span class="sd">        except ignores as_index flag.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; df = DataFrame([[1, 2], [1, 4], [5, 6]],</span>
<span class="sd">                           columns=[&#39;A&#39;, &#39;B&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;, as_index=False).head(1)</span>
<span class="sd">           A  B</span>
<span class="sd">        0  1  2</span>
<span class="sd">        2  5  6</span>
<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;).head(1)</span>
<span class="sd">           A  B</span>
<span class="sd">        0  1  2</span>
<span class="sd">        2  5  6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_group_selection</span><span class="p">()</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cumcount_array</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">n</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span></div>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">_doc_template</span><span class="p">)</span>
<div class="viewcode-block" id="GroupBy.tail"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.GroupBy.tail.html#pandas.GroupBy.tail">[docs]</a>    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns last n rows of each group</span>

<span class="sd">        Essentially equivalent to ``.apply(lambda x: x.tail(n))``,</span>
<span class="sd">        except ignores as_index flag.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; df = DataFrame([[&#39;a&#39;, 1], [&#39;a&#39;, 2], [&#39;b&#39;, 1], [&#39;b&#39;, 2]],</span>
<span class="sd">                           columns=[&#39;A&#39;, &#39;B&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;).tail(1)</span>
<span class="sd">           A  B</span>
<span class="sd">        1  a  2</span>
<span class="sd">        3  b  2</span>
<span class="sd">        &gt;&gt;&gt; df.groupby(&#39;A&#39;).head(1)</span>
<span class="sd">           A  B</span>
<span class="sd">        0  a  1</span>
<span class="sd">        2  b  1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_group_selection</span><span class="p">()</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cumcount_array</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span></div>


<span class="nd">@Appender</span><span class="p">(</span><span class="n">GroupBy</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">SeriesGroupBy</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">DataFrameGroupBy</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;invalid type: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">klass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_axes</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">group</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">group</span><span class="o">.</span><span class="n">axes</span>


<span class="k">def</span> <span class="nf">_is_indexed_like</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="bp">False</span>


<span class="k">class</span> <span class="nc">BaseGrouper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is an internal Grouper class, which actually holds</span>
<span class="sd">    the generated groups</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">groupings</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">mutated</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filter_empty_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compressed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupings</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span> <span class="o">=</span> <span class="n">groupings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="n">sort</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_keys</span> <span class="o">=</span> <span class="n">group_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutated</span> <span class="o">=</span> <span class="n">mutated</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ping</span><span class="o">.</span><span class="n">ngroups</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nkeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groupby iterator</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Generator yielding sequence of (name, subsetted object)</span>
<span class="sd">        for each group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">splitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_group_keys</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">splitter</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span>

    <span class="k">def</span> <span class="nf">_get_splitter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">comp_ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>
        <span class="k">return</span> <span class="n">get_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_group_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>
            <span class="c1"># provide &quot;flattened&quot; iterator for multi-group setting</span>
            <span class="n">mapper</span> <span class="o">=</span> <span class="n">_KeyMapper</span><span class="p">(</span><span class="n">comp_ids</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">mapper</span><span class="o">.</span><span class="n">get_key</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngroups</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">mutated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutated</span>
        <span class="n">splitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">group_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_group_keys</span><span class="p">()</span>

        <span class="c1"># oh boy</span>
        <span class="n">f_name</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="n">_get_callable_name</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_plotting_methods</span> <span class="ow">and</span>
                <span class="nb">hasattr</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="s1">&#39;fast_apply&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">values</span><span class="p">,</span> <span class="n">mutated</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">fast_apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">group_keys</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">group_keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">mutated</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">InvalidApply</span><span class="p">):</span>
                <span class="c1"># we detect a mutation of some kind</span>
                <span class="c1"># so take slow path</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># raise this error to the caller</span>
                <span class="k">pass</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">group_keys</span><span class="p">,</span> <span class="n">splitter</span><span class="p">):</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

            <span class="c1"># group might be modified</span>
            <span class="n">group_axes</span> <span class="o">=</span> <span class="n">_get_axes</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_indexed_like</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">group_axes</span><span class="p">):</span>
                <span class="n">mutated</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">result_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">group_keys</span><span class="p">,</span> <span class="n">result_values</span><span class="p">,</span> <span class="n">mutated</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; dict {group name -&gt; group indices} &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">labels</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">_values_from_object</span><span class="p">(</span><span class="n">ping</span><span class="o">.</span><span class="n">group_index</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">_get_indices_dict</span><span class="p">(</span><span class="n">label_list</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">labels</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">group_index</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute group sizes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="n">_ensure_platform_int</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">ids</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">minlength</span><span class="o">=</span><span class="n">ngroup</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">result_index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">_max_groupsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute size of largest group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># For many items in each group this is much faster than</span>
        <span class="c1"># self.size().max(), in worst case marginally slower</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; dict {group name -&gt; group labels} &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">to_groupby</span> <span class="o">=</span> <span class="n">lzip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">ping</span><span class="o">.</span><span class="n">grouper</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">))</span>
            <span class="n">to_groupby</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">to_groupby</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">to_groupby</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">is_monotonic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># return if my group orderings are monotonic</span>
        <span class="k">return</span> <span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_info</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_monotonic</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">group_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_group_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_compressed_labels</span><span class="p">()</span>

        <span class="n">ngroups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs_group_ids</span><span class="p">)</span>
        <span class="n">comp_ids</span> <span class="o">=</span> <span class="n">_ensure_int64</span><span class="p">(</span><span class="n">comp_ids</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_group_ids</span><span class="p">,</span> <span class="n">ngroups</span>

    <span class="k">def</span> <span class="nf">_get_compressed_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">labels</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">group_index</span> <span class="o">=</span> <span class="n">get_group_index</span><span class="p">(</span><span class="n">all_labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                                          <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">xnull</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_compress_group_index</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">)</span>

        <span class="n">ping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ping</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ping</span><span class="o">.</span><span class="n">group_index</span><span class="p">))</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">ngroups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_index</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">recons_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_ids</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">ping</span><span class="o">.</span><span class="n">labels</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">decons_obs_group_ids</span><span class="p">(</span><span class="n">comp_ids</span><span class="p">,</span>
                                    <span class="n">obs_ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">xnull</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">result_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compressed</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">group_index</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">MultiIndex</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">group_index</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">],</span>
                          <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recons_labels</span><span class="p">,</span>
                          <span class="n">verify_integrity</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                          <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_group_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compressed</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">group_index</span><span class="p">]</span>

        <span class="n">name_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ping</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recons_labels</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">_ensure_platform_int</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">levels</span> <span class="o">=</span> <span class="n">ping</span><span class="o">.</span><span class="n">group_index</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

            <span class="n">name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">name_list</span>

    <span class="c1"># ------------------------------------------------------------</span>
    <span class="c1"># Aggregation functions</span>

    <span class="n">_cython_functions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;aggregate&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;add&#39;</span><span class="p">:</span> <span class="s1">&#39;group_add&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prod&#39;</span><span class="p">:</span> <span class="s1">&#39;group_prod&#39;</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="s1">&#39;group_min&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="s1">&#39;group_max&#39;</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="s1">&#39;group_mean&#39;</span><span class="p">,</span>
            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;group_median&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="s1">&#39;group_var&#39;</span><span class="p">,</span>
            <span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;group_nth&#39;</span><span class="p">,</span>
                <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="s1">&#39;last&#39;</span><span class="p">:</span> <span class="s1">&#39;group_last&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ohlc&#39;</span><span class="p">:</span> <span class="s1">&#39;group_ohlc&#39;</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="s1">&#39;transform&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;cumprod&#39;</span><span class="p">:</span> <span class="s1">&#39;group_cumprod&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cumsum&#39;</span><span class="p">:</span> <span class="s1">&#39;group_cumsum&#39;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">_cython_arity</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ohlc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># OHLC</span>
    <span class="p">}</span>

    <span class="n">_name_functions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ohlc&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_get_cython_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">is_numeric</span><span class="p">):</span>

        <span class="n">dtype_str</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>

        <span class="k">def</span> <span class="nf">get_func</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
            <span class="c1"># see if there is a fused-type version of function</span>
            <span class="c1"># only valid for numeric</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_algos</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">is_numeric</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">f</span>

            <span class="c1"># otherwise find dtype-specific version, falling back to object</span>
            <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dtype_str</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_algos</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dtype_str</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">f</span>

        <span class="n">ftype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_functions</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="n">how</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ftype</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">afunc</span> <span class="o">=</span> <span class="n">get_func</span><span class="p">(</span><span class="n">ftype</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="c1"># a sub-function</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">ftype</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">afunc</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="c1"># need to curry our sub-function</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">wrapper</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">get_func</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;function is not implemented for this&quot;</span>
                                      <span class="s2">&quot;dtype: [how-&gt;</span><span class="si">%s</span><span class="s2">,dtype-&gt;</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span>
                                      <span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">dtype_str</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">,</span> <span class="n">dtype_str</span>

    <span class="k">def</span> <span class="nf">_cython_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;aggregate&#39;</span><span class="p">]</span>

        <span class="n">arity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_arity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">vdim</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">swapped</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">vdim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">]</span>
            <span class="n">out_shape</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span><span class="p">,</span> <span class="n">arity</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">swapped</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">arity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;arity of more than 1 is not &quot;</span>
                                          <span class="s2">&quot;supported for the &#39;how&#39; argument&quot;</span><span class="p">)</span>
            <span class="n">out_shape</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span><span class="p">,)</span> <span class="o">+</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">is_numeric</span> <span class="o">=</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_datetime_or_timedelta_dtype</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
            <span class="n">is_numeric</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">_ensure_float64</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_integer_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_numeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_complex_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">_ensure_float64</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">func</span><span class="p">,</span> <span class="n">dtype_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cython_function</span><span class="p">(</span>
                <span class="n">kind</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">is_numeric</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_numeric</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">_ensure_float64</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
                <span class="n">func</span><span class="p">,</span> <span class="n">dtype_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cython_function</span><span class="p">(</span>
                    <span class="n">kind</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">is_numeric</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">if</span> <span class="n">is_numeric</span><span class="p">:</span>
            <span class="n">out_dtype</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_dtype</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span>

        <span class="n">labels</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>

        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;aggregate&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_maybe_fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">out_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out_dtype</span><span class="p">),</span>
                                 <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">is_numeric</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;transform&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_maybe_fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out_dtype</span><span class="p">),</span>
                                 <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

            <span class="c1"># temporary storange for running-total type tranforms</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">out_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out_dtype</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">accum</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">is_numeric</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_integer_dtype</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">result</span> <span class="o">==</span> <span class="n">tslib</span><span class="o">.</span><span class="n">iNaT</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
                <span class="n">result</span><span class="p">[</span><span class="n">result</span> <span class="o">==</span> <span class="n">tslib</span><span class="o">.</span><span class="n">iNaT</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;aggregate&#39;</span> <span class="ow">and</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">_filter_empty_groups</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">counts</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">row_bool_subset</span><span class="p">(</span>
                        <span class="n">result</span><span class="p">,</span> <span class="p">(</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">row_bool_subset_object</span><span class="p">(</span>
                        <span class="n">_ensure_object</span><span class="p">(</span><span class="n">result</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">vdim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">arity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">how</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_functions</span><span class="p">:</span>
            <span class="c1"># TODO</span>
            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_functions</span><span class="p">[</span><span class="n">how</span><span class="p">]()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">swapped</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">names</span>

    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_operation</span><span class="p">(</span><span class="s1">&#39;aggregate&#39;</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_operation</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">agg_func</span><span class="p">,</span>
                   <span class="n">is_numeric</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># punting for now</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;number of dimensions is currently &quot;</span>
                                      <span class="s2">&quot;limited to 3&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>

                <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                <span class="n">agg_func</span><span class="p">(</span><span class="n">result</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">agg_func</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">accum</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">transform_func</span><span class="p">,</span>
                   <span class="n">is_numeric</span><span class="p">):</span>
        <span class="n">comp_ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>
        <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># punting for now</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;number of dimensions is currently &quot;</span>
                                      <span class="s2">&quot;limited to 3&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>

                <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                <span class="n">transform_func</span><span class="p">(</span><span class="n">result</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">values</span><span class="p">,</span>
                               <span class="n">comp_ids</span><span class="p">,</span> <span class="n">accum</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transform_func</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">accum</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">agg_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_series_fast</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_series_pure_python</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_aggregate_series_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_builtin_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">_has_complex_internals</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Incompatible index for Cython grouper&#39;</span><span class="p">)</span>

        <span class="n">group_index</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>

        <span class="c1"># avoids object / Series creation overhead</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_get_values</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>
        <span class="n">indexer</span> <span class="o">=</span> <span class="n">_get_group_index_sorter</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">group_index</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_nd</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="n">indexer</span><span class="p">,</span> <span class="n">allow_fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">grouper</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">SeriesGrouper</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">group_index</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span>
                                    <span class="n">dummy</span><span class="p">)</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">grouper</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">counts</span>

    <span class="k">def</span> <span class="nf">_aggregate_series_pure_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>

        <span class="n">group_index</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_info</span>

        <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ngroups</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">splitter</span> <span class="o">=</span> <span class="n">get_splitter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">group_index</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">splitter</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">or</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Function does not reduce&#39;</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">ngroups</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>

            <span class="n">counts</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">result</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">maybe_convert_objects</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">try_float</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">counts</span>


<span class="k">def</span> <span class="nf">generate_bins_generic</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">binner</span><span class="p">,</span> <span class="n">closed</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate bin edge offsets and bin labels for one array using another array</span>
<span class="sd">    which has bin edge values. Both arrays must be sorted.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : array of values</span>
<span class="sd">    binner : a comparable array of values representing bins into which to bin</span>
<span class="sd">        the first array. Note, &#39;values&#39; end-points must fall within &#39;binner&#39;</span>
<span class="sd">        end-points.</span>
<span class="sd">    closed : which end of bin is closed; left (default), right</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bins : array of offsets (into &#39;values&#39; argument) of bins.</span>
<span class="sd">        Zero and last edge are excluded in result, so for instance the first</span>
<span class="sd">        bin is values[0:bin[0]] and the last is values[bin[-1]:]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lenidx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">lenbin</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binner</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lenidx</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">lenbin</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid length for values or for binner&quot;</span><span class="p">)</span>

    <span class="c1"># check binner fits data</span>
    <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">binner</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Values falls before first bin&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">lenidx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">binner</span><span class="p">[</span><span class="n">lenbin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Values falls after last bin&quot;</span><span class="p">)</span>

    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">lenbin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># index into values</span>
    <span class="n">bc</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># bin count</span>

    <span class="c1"># linear scan, presume nothing about values/binner except that it fits ok</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lenbin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">r_bin</span> <span class="o">=</span> <span class="n">binner</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1"># count values in current bin, advance to next bin</span>
        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">lenidx</span> <span class="ow">and</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r_bin</span> <span class="ow">or</span>
                              <span class="p">(</span><span class="n">closed</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span> <span class="ow">and</span> <span class="n">values</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">r_bin</span><span class="p">)):</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">bins</span><span class="p">[</span><span class="n">bc</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="n">bc</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">bins</span>


<span class="k">class</span> <span class="nc">BinGrouper</span><span class="p">(</span><span class="n">BaseGrouper</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">binlabels</span><span class="p">,</span> <span class="n">filter_empty</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mutated</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="n">_ensure_int64</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span> <span class="o">=</span> <span class="n">_ensure_index</span><span class="p">(</span><span class="n">binlabels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filter_empty_groups</span> <span class="o">=</span> <span class="n">filter_empty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutated</span> <span class="o">=</span> <span class="n">mutated</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; dict {group name -&gt; group labels} &quot;&quot;&quot;</span>

        <span class="c1"># this is mainly for compat</span>
        <span class="c1"># GH 3881</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">tslib</span><span class="o">.</span><span class="n">NaT</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nkeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">get_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groupby iterator</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Generator yielding sequence of (name, subsetted object)</span>
<span class="sd">        for each group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">NDFrame</span><span class="p">):</span>
            <span class="n">slicer</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">start</span><span class="p">,</span> <span class="n">edge</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">_slice</span><span class="p">(</span>
                <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">edge</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slicer</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">start</span><span class="p">,</span> <span class="n">edge</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">edge</span><span class="p">)]</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">edge</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">tslib</span><span class="o">.</span><span class="n">NaT</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">label</span><span class="p">,</span> <span class="n">slicer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">edge</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">edge</span>

        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">slicer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">bin</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">tslib</span><span class="o">.</span><span class="n">NaT</span><span class="p">:</span>
                    <span class="n">indices</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">bin</span><span class="p">))</span>
                <span class="n">i</span> <span class="o">=</span> <span class="nb">bin</span>
        <span class="k">return</span> <span class="n">indices</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">group_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span>
        <span class="n">obs_group_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ngroups</span><span class="p">)</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">])</span>

        <span class="n">rep</span> <span class="o">=</span> <span class="n">_ensure_platform_int</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ngroups</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">):</span>
            <span class="n">comp_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ngroups</span><span class="p">),</span> <span class="n">rep</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ngroups</span><span class="p">)],</span> <span class="n">rep</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">comp_ids</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> \
            <span class="n">obs_group_ids</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="n">ngroups</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">ngroups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_index</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">result_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">isnull</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binlabels</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groupings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Grouping</span><span class="p">(</span><span class="n">lvl</span><span class="p">,</span> <span class="n">lvl</span><span class="p">,</span> <span class="n">in_axis</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lvl</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">agg_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">grouper</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">SeriesBinGrouper</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">grouper</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="c1"># cython aggregation</span>

    <span class="n">_cython_functions</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">BaseGrouper</span><span class="o">.</span><span class="n">_cython_functions</span><span class="p">)</span>
    <span class="n">_cython_functions</span><span class="p">[</span><span class="s1">&#39;aggregate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Grouping</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Holds the grouping information for a single key</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : Index</span>
<span class="sd">    grouper :</span>
<span class="sd">    obj :</span>
<span class="sd">    name :</span>
<span class="sd">    level :</span>
<span class="sd">    in_axis : if the Grouping is a column in self.obj and hence among</span>
<span class="sd">        Groupby.exclusions list</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    **Attributes**:</span>
<span class="sd">      * indices : dict of {group -&gt; index_list}</span>
<span class="sd">      * labels : ndarray, group labels</span>
<span class="sd">      * ids : mapping of label -&gt; group</span>
<span class="sd">      * counts : array of group counts</span>
<span class="sd">      * group_index : unique groups</span>
<span class="sd">      * groups : dict of {group -&gt; label_list}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">grouper</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">in_axis</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">_convert_grouper</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">grouper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="n">sort</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_axis</span> <span class="o">=</span> <span class="n">in_axis</span>

        <span class="c1"># right place for this?</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">))</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">grouper</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">grouper</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># pre-computed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_should_compress</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># we have a single grouper which may be a myriad of things,</span>
        <span class="c1"># some of which are dependent on the passing in level</span>

        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Level </span><span class="si">%s</span><span class="s1"> not in index&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">level</span><span class="p">))</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

            <span class="n">inds</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
            <span class="n">level_index</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>

            <span class="c1"># XXX complete hack</span>

            <span class="k">if</span> <span class="n">grouper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">level_values</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">inds</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">level_values</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># all levels may not be observed</span>
                <span class="n">labels</span><span class="p">,</span> <span class="n">uniques</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">inds</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uniques</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">uniques</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># handle NAs</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">inds</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">ok_labels</span><span class="p">,</span> <span class="n">uniques</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">inds</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

                    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">inds</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                    <span class="n">labels</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ok_labels</span>
                    <span class="n">labels</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uniques</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">level_index</span><span class="p">):</span>
                    <span class="n">level_index</span> <span class="o">=</span> <span class="n">level_index</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">uniques</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">labels</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_group_index</span> <span class="o">=</span> <span class="n">level_index</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">level_index</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="n">_asarray_tuplesafe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>

            <span class="c1"># a passed Categorical</span>
            <span class="k">elif</span> <span class="n">is_categorical_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">):</span>

                <span class="c1"># must have an ordered categorical</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">ordered</span><span class="p">:</span>

                        <span class="c1"># technically we cannot group on an unordered</span>
                        <span class="c1"># Categorical</span>
                        <span class="c1"># but this a user convenience to do so; the ordering</span>
                        <span class="c1"># is preserved and if it&#39;s a reduction it doesn&#39;t make</span>
                        <span class="c1"># any difference</span>
                        <span class="k">pass</span>

                <span class="c1"># fix bug #GH8868 sort=False being ignored in categorical</span>
                <span class="c1"># groupby</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span>
                        <span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>

                <span class="c1"># we make a CategoricalIndex out of the cat grouper</span>
                <span class="c1"># preserving the categories / ordered attributes</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">codes</span>

                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">categories</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_group_index</span> <span class="o">=</span> <span class="n">CategoricalIndex</span><span class="p">(</span>
                    <span class="n">Categorical</span><span class="o">.</span><span class="n">from_codes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span>
                                           <span class="n">categories</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                                           <span class="n">ordered</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">ordered</span><span class="p">))</span>

            <span class="c1"># a passed Grouper like</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="n">Grouper</span><span class="p">):</span>

                <span class="c1"># get the new grouper</span>
                <span class="n">grouper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">_get_binner_for_grouping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">obj</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">grouper</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">grouper</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># we are done</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="n">Grouping</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">grouper</span>

            <span class="c1"># no level passed</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span>
                                <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="s1">&#39;ndim&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grouper for &#39;</span><span class="si">%s</span><span class="s2">&#39; not 1-dimensional&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Grouper result violates len(labels) == &#39;</span>
                              <span class="s1">&#39;len(data)</span><span class="se">\n</span><span class="s1">result: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                              <span class="n">pprint_thing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># Try for sanity</span>
                    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="c1"># if we have a date/time-like grouper, make sure that we have</span>
        <span class="c1"># Timestamps like</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_datetime64_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">):</span>
                <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">to_datetime</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_timedelta64_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">):</span>
                <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">to_timedelta</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span> <span class="o">=</span> <span class="n">to_timedelta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Grouping({0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>

    <span class="n">_labels</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_group_index</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ngroups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_index</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_groupby_indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_labels</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">group_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_labels</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_index</span>

    <span class="k">def</span> <span class="nf">_make_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">,</span> <span class="n">uniques</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">)</span>
            <span class="n">uniques</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">uniques</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">labels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_group_index</span> <span class="o">=</span> <span class="n">uniques</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_grouper</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">mutated</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    create and return a BaseGrouper, which is an internal</span>
<span class="sd">    mapping of how to create the grouper indexers.</span>
<span class="sd">    This may be composed of multiple Grouping objects, indicating</span>
<span class="sd">    multiple groupers</span>

<span class="sd">    Groupers are ultimately index mappings. They can originate as:</span>
<span class="sd">    index mappings, keys to columns, functions, or Groupers</span>

<span class="sd">    Groupers enable local references to axis,level,sort, while</span>
<span class="sd">    the passed in axis, level, and sort are &#39;global&#39;.</span>

<span class="sd">    This routine tries to figure out what the passing in references</span>
<span class="sd">    are and then creates a Grouping for each one, combined into</span>
<span class="sd">    a BaseGrouper.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">group_axis</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

    <span class="c1"># validate that the passed level is compatible with the passed</span>
    <span class="c1"># axis of the object</span>
    <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_axis</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">level</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;level name </span><span class="si">%s</span><span class="s1"> is not the name of the &#39;</span>
                                     <span class="s1">&#39;index&#39;</span> <span class="o">%</span> <span class="n">level</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;level &gt; 0 only valid with MultiIndex&#39;</span><span class="p">)</span>

            <span class="n">level</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">group_axis</span>

    <span class="c1"># a passed-in Grouper, directly convert</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Grouper</span><span class="p">):</span>
        <span class="n">binner</span><span class="p">,</span> <span class="n">grouper</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">_get_grouper</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">grouper</span><span class="p">,</span> <span class="p">[],</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">grouper</span><span class="p">,</span> <span class="nb">set</span><span class="p">([</span><span class="n">key</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span> <span class="n">obj</span>

    <span class="c1"># already have a BaseGrouper, just return it</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">BaseGrouper</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="p">[],</span> <span class="n">obj</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">match_axis_length</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">key</span>
        <span class="n">match_axis_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_axis</span><span class="p">)</span>

    <span class="c1"># what are we after, exactly?</span>
    <span class="n">any_callable</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">callable</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
    <span class="n">any_groupers</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">Grouper</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
    <span class="n">any_arraylike</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">all_in_columns</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">g</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_in_columns</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">all_in_columns</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">any_callable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">all_in_columns</span> <span class="ow">and</span> \
       <span class="ow">not</span> <span class="n">any_arraylike</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">any_groupers</span> <span class="ow">and</span> \
       <span class="n">match_axis_length</span> <span class="ow">and</span> <span class="n">level</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">com</span><span class="o">.</span><span class="n">_asarray_tuplesafe</span><span class="p">(</span><span class="n">keys</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">level</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

    <span class="n">groupings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">exclusions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if the actual grouper should be obj[key]</span>
    <span class="k">def</span> <span class="nf">is_in_axis</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_label_like</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>

        <span class="k">return</span> <span class="bp">True</span>

    <span class="c1"># if the the grouper is obj[name]</span>
    <span class="k">def</span> <span class="nf">is_in_obj</span><span class="p">(</span><span class="n">gpr</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="n">gpr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">gpr</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">gpr</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">levels</span><span class="p">)):</span>

        <span class="k">if</span> <span class="n">is_in_obj</span><span class="p">(</span><span class="n">gpr</span><span class="p">):</span>  <span class="c1"># df.groupby(df[&#39;name&#39;])</span>
            <span class="n">in_axis</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">gpr</span><span class="o">.</span><span class="n">name</span>
            <span class="n">exclusions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">is_in_axis</span><span class="p">(</span><span class="n">gpr</span><span class="p">):</span>  <span class="c1"># df.groupby(&#39;name&#39;)</span>
            <span class="n">in_axis</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">gpr</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">gpr</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">gpr</span><span class="p">]</span>
            <span class="n">exclusions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_axis</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">is_categorical_dtype</span><span class="p">(</span><span class="n">gpr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">gpr</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Categorical dtype grouper must &quot;</span>
                             <span class="s2">&quot;have len(grouper) == len(data)&quot;</span><span class="p">)</span>

        <span class="c1"># create the Grouping</span>
        <span class="c1"># allow us to passing the actual Grouping as the gpr</span>
        <span class="n">ping</span> <span class="o">=</span> <span class="n">Grouping</span><span class="p">(</span><span class="n">group_axis</span><span class="p">,</span>
                        <span class="n">gpr</span><span class="p">,</span>
                        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
                        <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
                        <span class="n">in_axis</span><span class="o">=</span><span class="n">in_axis</span><span class="p">)</span> \
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gpr</span><span class="p">,</span> <span class="n">Grouping</span><span class="p">)</span> <span class="k">else</span> <span class="n">gpr</span>

        <span class="n">groupings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ping</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No group keys passed!&#39;</span><span class="p">)</span>

    <span class="c1"># create the internals grouper</span>
    <span class="n">grouper</span> <span class="o">=</span> <span class="n">BaseGrouper</span><span class="p">(</span><span class="n">group_axis</span><span class="p">,</span> <span class="n">groupings</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span> <span class="n">mutated</span><span class="o">=</span><span class="n">mutated</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grouper</span><span class="p">,</span> <span class="n">exclusions</span><span class="p">,</span> <span class="n">obj</span>


<span class="k">def</span> <span class="nf">_is_label_like</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">_convert_grouper</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">grouper</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">grouper</span><span class="o">.</span><span class="n">get</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grouper</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">grouper</span><span class="o">.</span><span class="n">_values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">grouper</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">_values</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grouper</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Grouper and axis must be same length&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">grouper</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">grouper</span>


<span class="k">def</span> <span class="nf">_whitelist_method_generator</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="n">whitelist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Yields all GroupBy member defs for DataFrame/Series names in _whitelist.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    klass - class where members are defined.  Should be Series or DataFrame</span>

<span class="sd">    whitelist - list of names of klass methods to be constructed</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    The generator yields a sequence of strings, each suitable for exec&#39;ing,</span>
<span class="sd">    that define implementations of the named methods for DataFrameGroupBy</span>
<span class="sd">    or SeriesGroupBy.</span>

<span class="sd">    Since we don&#39;t want to override methods explicitly defined in the</span>
<span class="sd">    base class, any such name is skipped.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">method_wrapper_template</span> <span class="o">=</span> \
        <span class="sd">&quot;&quot;&quot;def %(name)s(%(sig)s) :</span>
<span class="sd">    \&quot;&quot;&quot;</span>
    <span class="o">%</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="n">s</span>
    \<span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    f = </span><span class="si">%(self)s</span><span class="s2">.__getattr__(&#39;</span><span class="si">%(name)s</span><span class="s2">&#39;)</span>
<span class="s2">    return f(</span><span class="si">%(args)s</span><span class="s2">)&quot;&quot;&quot;</span>
    <span class="n">property_wrapper_template</span> <span class="o">=</span> \
        <span class="sd">&quot;&quot;&quot;@property</span>
<span class="sd">def %(name)s(self) :</span>
<span class="sd">    \&quot;&quot;&quot;</span>
    <span class="o">%</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="n">s</span>
    \<span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    return self.__getattr__(&#39;</span><span class="si">%(name)s</span><span class="s2">&#39;)&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">whitelist</span><span class="p">:</span>
        <span class="c1"># don&#39;t override anything that was explicitly defined</span>
        <span class="c1"># in the base class</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">GroupBy</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="c1"># ugly, but we need the name string itself in the method.</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">__doc__</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="n">wrapper_template</span> <span class="o">=</span> <span class="n">method_wrapper_template</span>
            <span class="n">decl</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">make_signature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="c1"># pass args by name to f because otherwise</span>
            <span class="c1"># GroupBy._make_wrapper won&#39;t know whether</span>
            <span class="c1"># we passed in an axis parameter.</span>
            <span class="n">args_by_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;{0}={0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                      <span class="s1">&#39;doc&#39;</span><span class="p">:</span> <span class="n">doc</span><span class="p">,</span>
                      <span class="s1">&#39;sig&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decl</span><span class="p">),</span>
                      <span class="s1">&#39;self&#39;</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                      <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_by_name</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wrapper_template</span> <span class="o">=</span> <span class="n">property_wrapper_template</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;doc&#39;</span><span class="p">:</span> <span class="n">doc</span><span class="p">}</span>
        <span class="k">yield</span> <span class="n">wrapper_template</span> <span class="o">%</span> <span class="n">params</span>


<span class="k">class</span> <span class="nc">SeriesGroupBy</span><span class="p">(</span><span class="n">GroupBy</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="c1"># Make class defs of attributes on SeriesGroupBy whitelist</span>
    <span class="n">_apply_whitelist</span> <span class="o">=</span> <span class="n">_series_apply_whitelist</span>
    <span class="k">for</span> <span class="n">_def_str</span> <span class="ow">in</span> <span class="n">_whitelist_method_generator</span><span class="p">(</span><span class="n">Series</span><span class="p">,</span>
                                                <span class="n">_series_apply_whitelist</span><span class="p">):</span>
        <span class="k">exec</span><span class="p">(</span><span class="n">_def_str</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        since we are a series, we by definition only have</span>
<span class="sd">        a single name, but may be the result of a selection or</span>
<span class="sd">        the name of our object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span>

    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_or_funcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply aggregation function or functions to groups, yielding most likely</span>
<span class="sd">        Series but in some cases DataFrame depending on the output of the</span>
<span class="sd">        aggregation function</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func_or_funcs : function or list / dict of functions</span>
<span class="sd">            List/dict of functions will produce DataFrame with column names</span>
<span class="sd">            determined by the function names themselves (list) or the keys in</span>
<span class="sd">            the dict</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        agg is an alias for aggregate. Use it.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; series</span>
<span class="sd">        bar    1.0</span>
<span class="sd">        baz    2.0</span>
<span class="sd">        qot    3.0</span>
<span class="sd">        qux    4.0</span>

<span class="sd">        &gt;&gt;&gt; mapper = lambda x: x[0] # first letter</span>
<span class="sd">        &gt;&gt;&gt; grouped = series.groupby(mapper)</span>

<span class="sd">        &gt;&gt;&gt; grouped.aggregate(np.sum)</span>
<span class="sd">        b    3.0</span>
<span class="sd">        q    7.0</span>

<span class="sd">        &gt;&gt;&gt; grouped.aggregate([np.sum, np.mean, np.std])</span>
<span class="sd">           mean  std  sum</span>
<span class="sd">        b  1.5   0.5  3</span>
<span class="sd">        q  3.5   0.5  7</span>

<span class="sd">        &gt;&gt;&gt; grouped.agg({&#39;result&#39; : lambda x: x.mean() / x.std(),</span>
<span class="sd">        ...              &#39;total&#39; : np.sum})</span>
<span class="sd">           result  total</span>
<span class="sd">        b  2.121   3</span>
<span class="sd">        q  4.95    7</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        apply, transform</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Series or DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_level</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_level&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_or_funcs</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_multiple_funcs</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">,</span>
                                                 <span class="p">(</span><span class="n">_level</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cyfunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cython_func</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cyfunc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cyfunc</span><span class="p">)()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">nkeys</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_agg_general</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_agg_general</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_named</span><span class="p">(</span><span class="n">func_or_funcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Warning, ignoring as_index=True&#39;</span><span class="p">)</span>

        <span class="c1"># _level handled at higher</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_level</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">concat</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="k">def</span> <span class="nf">_aggregate_multiple_funcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">_level</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span>
                   <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">]</span>

            <span class="c1"># indicated column order</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">lzip</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># list of functions / function names</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                    <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># protect against callables without names</span>
                    <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">com</span><span class="o">.</span><span class="n">_get_callable_name</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">lzip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SpecificationError</span><span class="p">(</span><span class="s1">&#39;Function names must be unique, &#39;</span>
                                         <span class="s1">&#39;found multiple named </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

            <span class="c1"># reset the cache so that we</span>
            <span class="c1"># only include the named selection</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">_reset_cache</span><span class="p">()</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">_selection</span> <span class="o">=</span> <span class="n">name</span>
            <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">compat</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">results</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
                      <span class="n">DataFrame</span><span class="p">):</span>

            <span class="c1"># let higher level handle</span>
            <span class="k">if</span> <span class="n">_level</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">results</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">compat</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">results</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; common agg/transform wrapping logic &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">name</span>
            <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_aggregated_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_output</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
                                 <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">,</span>
                                 <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_transformed_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_output</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
                                 <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_applied_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">not_indexed_same</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># GH #6265</span>
            <span class="k">return</span> <span class="n">Series</span><span class="p">([],</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_get_index</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">nkeys</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">index</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># GH #823</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">_get_index</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_objects</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span>
                                        <span class="n">not_indexed_same</span><span class="o">=</span><span class="n">not_indexed_same</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># possible that Series -&gt; DataFrame by applied function</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_objects</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span>
                                        <span class="n">not_indexed_same</span><span class="o">=</span><span class="n">not_indexed_same</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># GH #6265</span>
            <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">_get_index</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_aggregate_named</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">group</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must produce aggregated value&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call function producing a like-indexed Series on each group and return</span>
<span class="sd">        a Series with the transformed values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : function</span>
<span class="sd">            To apply to each group. Should return a Series with the same index</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; grouped.transform(lambda x: (x - x.mean()) / x.std())</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        transformed : Series</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cython_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">or</span> <span class="n">func</span>

        <span class="c1"># if string function</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">_cython_transforms</span><span class="p">:</span>
                <span class="c1"># cythonized transform</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># cythonized aggregation and merge</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_fast</span><span class="p">(</span>
                    <span class="k">lambda</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="c1"># reg transform</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">wrapper</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">wrapper</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">values</span>

            <span class="c1"># may need to astype</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">common_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">common_type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">result</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">common_type</span> <span class="o">!=</span> <span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">common_type</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">indexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">_possibly_downcast_to_dtype</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">,</span>
                                            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fast version of transform, only applicable to</span>
<span class="sd">        builtin/cythonizable functions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">cast</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_1d</span><span class="p">(</span><span class="n">func</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cast</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># noqa</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of a Series excluding elements from groups that</span>
<span class="sd">        do not satisfy the boolean criterion specified by func.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func : function</span>
<span class="sd">            To apply to each group. Should return True or False.</span>
<span class="sd">        dropna : Drop groups that do not pass the filter. True by default;</span>
<span class="sd">            if False, groups that evaluate False are filled with NaNs.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; grouped.filter(lambda x: x.mean() &gt; 0)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filtered : Series</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">wrapper</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wrapper</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Interpret np.nan as False.</span>
        <span class="k">def</span> <span class="nf">true_and_notnull</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">wrapper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">b</span> <span class="ow">and</span> <span class="n">notnull</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span>
                       <span class="k">if</span> <span class="n">true_and_notnull</span><span class="p">(</span><span class="n">group</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;the filter must return a boolean result&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;the filter must return a boolean result&quot;</span><span class="p">)</span>

        <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_filter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">dropna</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">filtered</span>

<div class="viewcode-block" id="SeriesGroupBy.nunique"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.SeriesGroupBy.nunique.html#pandas.SeriesGroupBy.nunique">[docs]</a>    <span class="k">def</span> <span class="nf">nunique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns number of unique elements in the group &quot;&quot;&quot;</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">val</span><span class="p">,</span> <span class="n">ids</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># catches object dtypes</span>
            <span class="k">assert</span> <span class="n">val</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">object</span><span class="p">,</span> \
                <span class="s1">&#39;val.dtype must be object, got </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">val</span><span class="o">.</span><span class="n">dtype</span>
            <span class="n">val</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">val</span><span class="p">,</span> <span class="n">ids</span><span class="p">))</span>
            <span class="n">_isnull</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_isnull</span> <span class="o">=</span> <span class="n">isnull</span>

        <span class="n">ids</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span>

        <span class="c1"># group boundaries are where group ids change</span>
        <span class="c1"># unique observations are where sorted values change</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">ids</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">val</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="c1"># 1st item of each group is a new unique observation</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">_isnull</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
            <span class="n">inc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">inc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inc</span><span class="p">[</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="n">mask</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">inc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">inc</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">out</span> <span class="k">if</span> <span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>

        <span class="c1"># we might have duplications among the bins</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ri</span><span class="p">):</span>
            <span class="n">res</span><span class="p">,</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ri</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="n">res</span>
            <span class="n">res</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span>

        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">res</span><span class="p">,</span>
                      <span class="n">index</span><span class="o">=</span><span class="n">ri</span><span class="p">,</span>
                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

    <span class="nd">@deprecate_kwarg</span><span class="p">(</span><span class="s1">&#39;take_last&#39;</span><span class="p">,</span> <span class="s1">&#39;keep&#39;</span><span class="p">,</span>
                     <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="bp">True</span><span class="p">:</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">:</span> <span class="s1">&#39;first&#39;</span><span class="p">})</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="n">nlargest</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
<div class="viewcode-block" id="SeriesGroupBy.nlargest"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.SeriesGroupBy.nlargest.html#pandas.SeriesGroupBy.nlargest">[docs]</a>    <span class="k">def</span> <span class="nf">nlargest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">):</span>
        <span class="c1"># ToDo: When we remove deprecate_kwargs, we can remote these methods</span>
        <span class="c1"># and include nlargest and nsmallest to _series_apply_whitelist</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="n">keep</span><span class="p">))</span></div>

    <span class="nd">@deprecate_kwarg</span><span class="p">(</span><span class="s1">&#39;take_last&#39;</span><span class="p">,</span> <span class="s1">&#39;keep&#39;</span><span class="p">,</span>
                     <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="bp">True</span><span class="p">:</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">:</span> <span class="s1">&#39;first&#39;</span><span class="p">})</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="n">nsmallest</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
<div class="viewcode-block" id="SeriesGroupBy.nsmallest"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.SeriesGroupBy.nsmallest.html#pandas.SeriesGroupBy.nsmallest">[docs]</a>    <span class="k">def</span> <span class="nf">nsmallest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="n">keep</span><span class="p">))</span></div>

<div class="viewcode-block" id="SeriesGroupBy.value_counts"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.SeriesGroupBy.value_counts.html#pandas.SeriesGroupBy.value_counts">[docs]</a>    <span class="k">def</span> <span class="nf">value_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                     <span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>

        <span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
        <span class="kn">from</span> <span class="nn">pandas.tools.tile</span> <span class="kn">import</span> <span class="n">cut</span>
        <span class="kn">from</span> <span class="nn">pandas.tools.merge</span> <span class="kn">import</span> <span class="n">_get_join_indexers</span>

        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
            <span class="c1"># scalar bins cannot be done at top level</span>
            <span class="c1"># in a backward compatible way</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Series</span><span class="o">.</span><span class="n">value_counts</span><span class="p">,</span>
                              <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span>
                              <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
                              <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">,</span>
                              <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>

        <span class="c1"># groupby removes null keys from groupings</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">ids</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">lab</span><span class="p">,</span> <span class="n">lev</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cat</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">cut</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">retbins</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="c1"># bins[:-1] for backward compat;</span>
            <span class="c1"># o.w. cat.categories could be better</span>
            <span class="n">lab</span><span class="p">,</span> <span class="n">lev</span><span class="p">,</span> <span class="n">dropna</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="p">,</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">False</span>

        <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">lab</span><span class="p">,</span> <span class="n">ids</span><span class="p">))</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">lab</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span> <span class="n">lab</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span>

        <span class="c1"># group boundaries are where group ids change</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">ids</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># new values are where sorted labels change</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="n">lab</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">lab</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">inc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c1"># group boundaries are also new values</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">inc</span><span class="p">,</span> <span class="bp">True</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># value counts</span>

        <span class="c1"># num. of times each group should be repeated</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">inc</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>

        <span class="c1"># multi-index components</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">rep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">recons_labels</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="n">lab</span><span class="p">[</span><span class="n">inc</span><span class="p">]]</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">group_index</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groupings</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">lev</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">dropna</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">lab</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">_np_version_under1p8</span><span class="p">:</span>
                    <span class="n">mi</span><span class="p">,</span> <span class="n">ml</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">ml</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">ml</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">acc</span> <span class="o">=</span> <span class="n">rep</span><span class="p">(</span><span class="n">d</span><span class="p">)[</span><span class="n">mask</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">acc</span> <span class="o">=</span> <span class="n">rep</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">/=</span> <span class="n">acc</span>

        <span class="k">if</span> <span class="n">sort</span> <span class="ow">and</span> <span class="n">bins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">cat</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">inc</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span> <span class="k">if</span> <span class="n">dropna</span> <span class="k">else</span> <span class="n">ids</span><span class="p">[</span><span class="n">inc</span><span class="p">]</span>
            <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">out</span> <span class="k">if</span> <span class="n">ascending</span> <span class="k">else</span> <span class="o">-</span><span class="n">out</span><span class="p">,</span> <span class="n">cat</span><span class="p">))</span>
            <span class="n">out</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">sorter</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mi</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
                            <span class="n">verify_integrity</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_integer_dtype</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">_ensure_int64</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">mi</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># for compat. with algos.value_counts need to ensure every</span>
        <span class="c1"># bin is present at every index level, null filled with zeros</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">diff</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="n">lab</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">lab</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">ncat</span><span class="p">,</span> <span class="n">nbin</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">left</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ncat</span><span class="p">),</span> <span class="n">nbin</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nbin</span><span class="p">),</span> <span class="n">ncat</span><span class="p">)]</span>

        <span class="n">right</span> <span class="o">=</span> <span class="p">[</span><span class="n">diff</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">_get_join_indexers</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sort</span><span class="p">:</span>
            <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">out</span> <span class="k">if</span> <span class="n">ascending</span> <span class="k">else</span> <span class="o">-</span><span class="n">out</span><span class="p">,</span> <span class="n">left</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">out</span><span class="p">,</span> <span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">sorter</span><span class="p">],</span> <span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">sorter</span><span class="p">]</span>

        <span class="c1"># build the multi-index w/ full levels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">lab</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">diff</span><span class="p">],</span> <span class="n">nbin</span><span class="p">),</span> <span class="n">labels</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">mi</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
                        <span class="n">verify_integrity</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_integer_dtype</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">_ensure_int64</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">mi</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compute count of group, excluding missing values &quot;&quot;&quot;</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">ids</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">isnull</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="n">_ensure_platform_int</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">minlength</span><span class="o">=</span><span class="n">ngroups</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">out</span><span class="p">,</span>
                      <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">,</span>
                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_to_column_groupbys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; return a pass thru &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">NDFrameGroupBy</span><span class="p">(</span><span class="n">GroupBy</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_iterate_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># kludge</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">slice_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">slice_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection_list</span>
            <span class="n">slicer</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slice_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span>
            <span class="n">slicer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">xs</span>

        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">slice_axis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclusions</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">yield</span> <span class="n">val</span><span class="p">,</span> <span class="n">slicer</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cython_agg_general</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">new_items</span><span class="p">,</span> <span class="n">new_blocks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cython_agg_blocks</span><span class="p">(</span>
            <span class="n">how</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="n">numeric_only</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_agged_blocks</span><span class="p">(</span><span class="n">new_items</span><span class="p">,</span> <span class="n">new_blocks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_agged_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">blocks</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>

        <span class="n">new_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

        <span class="c1"># more kludge</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_axes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>

        <span class="c1"># Make sure block manager integrity check passes.</span>
        <span class="k">assert</span> <span class="n">new_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="n">new_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">items</span>

        <span class="n">mgr</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">new_axes</span><span class="p">)</span>

        <span class="n">new_obj</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)(</span><span class="n">mgr</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_process_cython_aggregate</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>

    <span class="n">_block_agg_axis</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_cython_agg_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">agg_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_to_aggregate</span><span class="p">()</span>

        <span class="n">new_blocks</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">numeric_only</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_numeric_data</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>

            <span class="n">result</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
                <span class="n">block</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">agg_axis</span><span class="p">)</span>

            <span class="c1"># see if we can cast the block back to the original dtype</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">_try_coerce_and_cast_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

            <span class="n">newb</span> <span class="o">=</span> <span class="n">make_block</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">placement</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">mgr_locs</span><span class="p">)</span>
            <span class="n">new_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newb</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_blocks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="s1">&#39;No numeric types to aggregate&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">,</span> <span class="n">new_blocks</span>

    <span class="k">def</span> <span class="nf">_get_data_to_aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>

    <span class="k">def</span> <span class="nf">_post_process_cython_aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="c1"># undoing kludge from below</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">_level</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_level&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">_level</span><span class="o">=</span><span class="n">_level</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

            <span class="c1"># grouper specific aggregations</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">nkeys</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_python_agg_general</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="c1"># try to treat as if we are passing a list</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_multiple_funcs</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">arg</span><span class="p">],</span> <span class="n">_level</span><span class="o">=</span><span class="n">_level</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_generic</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_insert_inaxis_grouper_inplace</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="k">def</span> <span class="nf">_aggregate_generic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">nkeys</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Number of keys must be 1&#39;</span><span class="p">)</span>

        <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">!=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_info_axis_number</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
                                                  <span class="n">data</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_item_by_item</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
                                                  <span class="n">data</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">wrapper</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_generic_output</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_aggregated_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AbstractMethodError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_aggregate_item_by_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># only for axis==0</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cannot_agg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
                <span class="n">colg</span> <span class="o">=</span> <span class="n">SeriesGroupBy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">item</span><span class="p">,</span>
                                     <span class="n">grouper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>
                <span class="n">result</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span>
                    <span class="n">colg</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">cannot_agg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">cannot_agg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">errors</span> <span class="o">=</span> <span class="n">e</span>
                <span class="k">continue</span>

        <span class="n">result_columns</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">cannot_agg</span><span class="p">:</span>
            <span class="n">result_columns</span> <span class="o">=</span> <span class="n">result_columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">cannot_agg</span><span class="p">)</span>

            <span class="c1"># GH6337</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_columns</span><span class="p">)</span> <span class="ow">and</span> <span class="n">errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">errors</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">result_columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_decide_output_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
            <span class="n">output_keys</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">output_keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">):</span>
                <span class="n">output_keys</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">output_keys</span><span class="p">,</span>
                                                     <span class="n">names</span><span class="o">=</span><span class="n">labels</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output_keys</span>

    <span class="k">def</span> <span class="nf">_wrap_applied_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">not_indexed_same</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas.core.index</span> <span class="kn">import</span> <span class="n">_all_indexes_same</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>

        <span class="n">key_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span>

        <span class="c1"># GH12824.</span>
        <span class="k">def</span> <span class="nf">first_non_None_value</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">first_non_None_value</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># GH9684. If all values are None, then this will throw an error.</span>
            <span class="c1"># We&#39;d prefer it return an empty dataframe.</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_objects</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span>
                                        <span class="n">not_indexed_same</span><span class="o">=</span><span class="n">not_indexed_same</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groupings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groupings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">key_index</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">key_names</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">ping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groupings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="n">ping</span><span class="o">.</span><span class="n">ngroups</span><span class="p">:</span>
                    <span class="n">key_index</span> <span class="o">=</span> <span class="n">ping</span><span class="o">.</span><span class="n">group_index</span>
                    <span class="n">key_index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">key_lookup</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
                    <span class="n">indexer</span> <span class="o">=</span> <span class="n">key_lookup</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">key_index</span><span class="p">)</span>

                    <span class="c1"># reorder the values</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexer</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>

                    <span class="n">key_index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># don&#39;t use the key indexer</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>
                    <span class="n">key_index</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="c1"># make Nones an empty object</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">first_non_None_value</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">NDFrame</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="o">**</span><span class="n">v</span><span class="o">.</span><span class="n">_construct_axes_dict</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span>
                <span class="p">]</span>

            <span class="n">v</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">Series</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
                    <span class="n">applied_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
                    <span class="n">all_indexed_same</span> <span class="o">=</span> <span class="n">_all_indexes_same</span><span class="p">([</span>
                        <span class="n">x</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span>
                    <span class="p">])</span>
                    <span class="n">singular_series</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
                                       <span class="n">applied_index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="c1"># GH3596</span>
                    <span class="c1"># provide a reduction (Frame -&gt; Series) if groups are</span>
                    <span class="c1"># unique</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">squeeze</span><span class="p">:</span>

                        <span class="c1"># assign the name to this series</span>
                        <span class="k">if</span> <span class="n">singular_series</span><span class="p">:</span>
                            <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                            <span class="c1"># GH2893</span>
                            <span class="c1"># we have series in the values array, we want to</span>
                            <span class="c1"># produce a series:</span>
                            <span class="c1"># if any of the sub-series are not indexed the same</span>
                            <span class="c1"># OR we don&#39;t have a multi-index and we have only a</span>
                            <span class="c1"># single values</span>
                            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_objects</span><span class="p">(</span>
                                <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">not_indexed_same</span><span class="o">=</span><span class="n">not_indexed_same</span>
                            <span class="p">)</span>

                        <span class="c1"># still a series</span>
                        <span class="c1"># path added as of GH 5545</span>
                        <span class="k">elif</span> <span class="n">all_indexed_same</span><span class="p">:</span>
                            <span class="kn">from</span> <span class="nn">pandas.tools.merge</span> <span class="kn">import</span> <span class="n">concat</span>
                            <span class="k">return</span> <span class="n">concat</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_indexed_same</span><span class="p">:</span>
                        <span class="c1"># GH 8467</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_objects</span><span class="p">(</span>
                            <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">not_indexed_same</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                        <span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># GH6124 if the list of Series have a consistent name,</span>
                        <span class="c1"># then propagate that name to the result.</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="c1"># Only propagate the series name to the result</span>
                            <span class="c1"># if all series have a consistent name.  If the</span>
                            <span class="c1"># series do not have a consistent name, do</span>
                            <span class="c1"># nothing.</span>
                            <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                        <span class="c1"># normally use vstack as its faster than concat</span>
                        <span class="c1"># and if we have mi-columns</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                      <span class="n">MultiIndex</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key_index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="n">stacked_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
                            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">stacked_values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">key_index</span><span class="p">,</span>
                                               <span class="n">columns</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># GH5788 instead of stacking; concat gets the</span>
                            <span class="c1"># dtypes correct</span>
                            <span class="kn">from</span> <span class="nn">pandas.tools.merge</span> <span class="kn">import</span> <span class="n">concat</span>
                            <span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">key_index</span><span class="p">,</span>
                                            <span class="n">names</span><span class="o">=</span><span class="n">key_index</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
                                            <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">index</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">stacked_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">stacked_values</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                           <span class="n">columns</span><span class="o">=</span><span class="n">key_index</span><span class="p">)</span>

                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                    <span class="c1"># GH1738: values is list of arrays of unequal lengths fall</span>
                    <span class="c1"># through to the outer else caluse</span>
                    <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">key_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

                <span class="c1"># if we have date/time like in the original, then coerce dates</span>
                <span class="c1"># as we are stacking can easily have object dtypes here</span>
                <span class="n">so</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">so</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">_DATELIKE_DTYPES</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()):</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">numeric</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                    <span class="n">date_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span>
                        <span class="n">include</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">_DATELIKE_DTYPES</span><span class="p">))</span><span class="o">.</span><span class="n">columns</span>
                    <span class="n">date_cols</span> <span class="o">=</span> <span class="n">date_cols</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">date_cols</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">date_cols</span><span class="p">]</span>
                                         <span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                                   <span class="nb">coerce</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_output</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

            <span class="c1"># values are not series or array-like but scalars</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># only coerce dates if we find at least 1 datetime</span>
                <span class="nb">coerce</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Timestamp</span><span class="p">)</span>
                                      <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span> <span class="k">else</span> <span class="bp">False</span>
                <span class="c1"># self.name not passed through to Series as the result</span>
                <span class="c1"># should not take the name of original selection of columns</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">key_index</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                  <span class="nb">coerce</span><span class="o">=</span><span class="nb">coerce</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Handle cases like BinGrouper</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_objects</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span>
                                        <span class="n">not_indexed_same</span><span class="o">=</span><span class="n">not_indexed_same</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform_general</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas.tools.merge</span> <span class="kn">import</span> <span class="n">concat</span>

        <span class="n">applied</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">get_iterator</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">fast_path</span><span class="p">,</span> <span class="n">slow_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_paths</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># Try slow path and fast path.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">path</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_path</span><span class="p">(</span><span class="n">fast_path</span><span class="p">,</span> <span class="n">slow_path</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_item_by_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">fast_path</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;transform must return a scalar value for each group&#39;</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">path</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

            <span class="c1"># broadcasting</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">res</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">values</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">res</span>

                <span class="n">applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

        <span class="n">concat_index</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span>
        <span class="n">concatenated</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">applied</span><span class="p">,</span> <span class="n">join_axes</span><span class="o">=</span><span class="p">[</span><span class="n">concat_index</span><span class="p">],</span>
                              <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_result_index_ordered</span><span class="p">(</span><span class="n">concatenated</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call function producing a like-indexed DataFrame on each group and</span>
<span class="sd">        return a DataFrame having the same indexes as the original object</span>
<span class="sd">        filled with the transformed values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : function</span>
<span class="sd">            Function to apply to each subframe</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Each subframe is endowed the attribute &#39;name&#39; in case you need to know</span>
<span class="sd">        which group you are working on.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; grouped = df.groupby(lambda x: mapping[x])</span>
<span class="sd">        &gt;&gt;&gt; grouped.transform(lambda x: (x - x.mean()) / x.std())</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># optimized transforms</span>
        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cython_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">or</span> <span class="n">func</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">_cython_transforms</span><span class="p">:</span>
                <span class="c1"># cythonized transform</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># cythonized aggregation and merge</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_general</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># a reduction transform</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_general</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>
        <span class="c1"># nuiscance columns</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_general</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_fast</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transform_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fast transform path for aggregations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if there were groups with no observations (Categorical only?)</span>
        <span class="c1"># try casting data to original dtype</span>
        <span class="n">cast</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>

        <span class="c1"># for each col, reshape to to size of original frame</span>
        <span class="c1"># by take operation</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_1d</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cast</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_cast</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">_from_arrays</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                                      <span class="n">index</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_define_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">fast_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">slow_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">group</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fast_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">slow_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">group</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fast_path</span><span class="p">,</span> <span class="n">slow_path</span>

    <span class="k">def</span> <span class="nf">_choose_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fast_path</span><span class="p">,</span> <span class="n">slow_path</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">slow_path</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">slow_path</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

        <span class="c1"># if we make it here, test if we can use the fast path</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res_fast</span> <span class="o">=</span> <span class="n">fast_path</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

            <span class="c1"># compare that we get the same results</span>
            <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">res_fast</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="n">res_r</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
                <span class="n">res_fast_r</span> <span class="o">=</span> <span class="n">res_fast</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">notnull</span><span class="p">(</span><span class="n">res_r</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">res_r</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">==</span> <span class="n">res_fast_r</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">fast_path</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">_transform_item_by_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">wrapper</span><span class="p">):</span>
        <span class="c1"># iterate through columns</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">output</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
                <span class="n">inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Transform function invalid for data types&#39;</span><span class="p">)</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">inds</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># noqa</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of a DataFrame excluding elements from groups that</span>
<span class="sd">        do not satisfy the boolean criterion specified by func.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        f : function</span>
<span class="sd">            Function to apply to each subframe. Should return True or False.</span>
<span class="sd">        dropna : Drop groups that do not pass the filter. True by default;</span>
<span class="sd">            if False, groups that evaluate False are filled with NaNs.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Each subframe is endowed the attribute &#39;name&#39; in case you need to know</span>
<span class="sd">        which group you are working on.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; grouped = df.groupby(lambda x: mapping[x])</span>
<span class="sd">        &gt;&gt;&gt; grouped.filter(lambda x: x[&#39;A&#39;].sum() + x[&#39;B&#39;].sum() &gt; 0)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">get_iterator</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># allow e.g., scalars and frames to pass</span>
                <span class="k">pass</span>

            <span class="c1"># interpret the result of the filter</span>
            <span class="k">if</span> <span class="n">is_bool</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">is_scalar</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isnull</span><span class="p">(</span><span class="n">res</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">res</span> <span class="ow">and</span> <span class="n">notnull</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># non scalars aren&#39;t allowed</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;filter function returned a </span><span class="si">%s</span><span class="s2">, &quot;</span>
                                <span class="s2">&quot;but expected a scalar bool&quot;</span> <span class="o">%</span>
                                <span class="nb">type</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_filter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">dropna</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">DataFrameGroupBy</span><span class="p">(</span><span class="n">NDFrameGroupBy</span><span class="p">):</span>
    <span class="n">_apply_whitelist</span> <span class="o">=</span> <span class="n">_dataframe_apply_whitelist</span>
    <span class="c1">#</span>
    <span class="c1"># Make class defs of attributes on DataFrameGroupBy whitelist.</span>
    <span class="k">for</span> <span class="n">_def_str</span> <span class="ow">in</span> <span class="n">_whitelist_method_generator</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">_apply_whitelist</span><span class="p">):</span>
        <span class="k">exec</span><span class="p">(</span><span class="n">_def_str</span><span class="p">)</span>

    <span class="n">_block_agg_axis</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">SelectionMixin</span><span class="o">.</span><span class="n">_see_also_template</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">SelectionMixin</span><span class="o">.</span><span class="n">_agg_doc</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DataFrameGroupBy</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="k">def</span> <span class="nf">_gotitem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sub-classes to define</span>
<span class="sd">        return a sliced object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : string / list of selections</span>
<span class="sd">        ndim : 1,2</span>
<span class="sd">            requested ndim of result</span>
<span class="sd">        subset : object, default None</span>
<span class="sd">            subset to act on</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
            <span class="k">return</span> <span class="n">DataFrameGroupBy</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                                    <span class="n">grouper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span>
                                    <span class="n">exclusions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exclusions</span><span class="p">,</span>
                                    <span class="n">as_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">SeriesGroupBy</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                                 <span class="n">grouper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;invalid ndim for _gotitem&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_generic_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">result_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                             <span class="n">columns</span><span class="o">=</span><span class="n">result_index</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                             <span class="n">columns</span><span class="o">=</span><span class="n">result_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_data_to_aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_insert_inaxis_grouper_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="c1"># zip in reverse so we can always insert at loc 0</span>
        <span class="n">izip</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span> <span class="nb">map</span><span class="p">(</span><span class="nb">reversed</span><span class="p">,</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">get_group_levels</span><span class="p">(),</span>
            <span class="p">[</span><span class="n">grp</span><span class="o">.</span><span class="n">in_axis</span> <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groupings</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">lev</span><span class="p">,</span> <span class="n">in_axis</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">in_axis</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lev</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_aggregated_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">agg_axis</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">agg_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span><span class="o">.</span><span class="n">_get_axis</span><span class="p">(</span><span class="n">agg_axis</span><span class="p">)</span>

        <span class="n">output_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decide_output_index</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">agg_labels</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">output_keys</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_insert_inaxis_grouper_inplace</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">consolidate</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">output_keys</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">T</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_output</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_transformed_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_agged_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">blocks</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">mgr</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="p">[</span><span class="n">items</span><span class="p">,</span> <span class="n">index</span><span class="p">])</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_insert_inaxis_grouper_inplace</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">consolidate</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
            <span class="n">mgr</span> <span class="o">=</span> <span class="n">BlockManager</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="p">[</span><span class="n">items</span><span class="p">,</span> <span class="n">index</span><span class="p">])</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">T</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_output</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">_convert</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reindex_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if we have categorical groupers, then we want to make sure that</span>
<span class="sd">        we have a fully reindex-output to the levels. These may have not</span>
<span class="sd">        participated in the groupings (e.g. may have all been</span>
<span class="sd">        nan groups)</span>

<span class="sd">        This can re-expand the output space</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">groupings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">groupings</span>
        <span class="k">if</span> <span class="n">groupings</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ping</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span> <span class="p">(</span><span class="n">Categorical</span><span class="p">,</span> <span class="n">CategoricalIndex</span><span class="p">))</span>
                      <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="n">groupings</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="n">levels_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ping</span><span class="o">.</span><span class="n">group_index</span> <span class="k">for</span> <span class="n">ping</span> <span class="ow">in</span> <span class="n">groupings</span><span class="p">]</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
            <span class="n">levels_list</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">sortlevel</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_get_axis_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">):</span> <span class="n">index</span><span class="p">,</span> <span class="s1">&#39;copy&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>

        <span class="c1"># GH 13204</span>
        <span class="c1"># Here, the categorical in-axis groupers, which need to be fully</span>
        <span class="c1"># expanded, are columns in `result`. An idea is to do:</span>
        <span class="c1"># result = result.set_index(self.grouper.names)</span>
        <span class="c1">#                .reindex(index).reset_index()</span>
        <span class="c1"># but special care has to be taken because of possible not-in-axis</span>
        <span class="c1"># groupers.</span>
        <span class="c1"># So, we manually select and drop the in-axis grouper columns,</span>
        <span class="c1"># reindex `result`, and then reset the in-axis grouper columns.</span>

        <span class="c1"># Select in-axis groupers</span>
        <span class="n">in_axis_grps</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">ping</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ping</span><span class="p">)</span>
                        <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groupings</span><span class="p">)</span> <span class="k">if</span> <span class="n">ping</span><span class="o">.</span><span class="n">in_axis</span><span class="p">]</span>
        <span class="n">g_nums</span><span class="p">,</span> <span class="n">g_names</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">in_axis_grps</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">g_names</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Set a temp index and reindex (possibly expanding)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
                                  <span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c1"># Reset in-axis grouper columns</span>
        <span class="c1"># (using level numbers `g_nums` because level names may not be unique)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">g_nums</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_iterate_column_groupbys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">colname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">colname</span><span class="p">,</span> <span class="n">SeriesGroupBy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                                         <span class="n">selection</span><span class="o">=</span><span class="n">colname</span><span class="p">,</span>
                                         <span class="n">grouper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">,</span>
                                         <span class="n">exclusions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exclusions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_to_column_groupbys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pandas.tools.merge</span> <span class="kn">import</span> <span class="n">concat</span>
        <span class="k">return</span> <span class="n">concat</span><span class="p">(</span>
            <span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">col_groupby</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">col_groupby</span>
             <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_column_groupbys</span><span class="p">()),</span>
            <span class="n">keys</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrameGroupBy.count"><a class="viewcode-back" href="../../../generated/pandas.core.groupby.DataFrameGroupBy.count.html#pandas.DataFrameGroupBy.count">[docs]</a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compute count of group, excluding missing values &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
        <span class="kn">from</span> <span class="nn">pandas.lib</span> <span class="kn">import</span> <span class="n">count_level_2d</span>
        <span class="kn">from</span> <span class="nn">pandas.types.missing</span> <span class="kn">import</span> <span class="n">_isnull_ndarraylike</span> <span class="k">as</span> <span class="n">isnull</span>

        <span class="n">data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_to_aggregate</span><span class="p">()</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ngroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">group_info</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">ids</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">val</span> <span class="o">=</span> <span class="p">((</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">isnull</span><span class="p">(</span><span class="n">blk</span><span class="o">.</span><span class="n">get_values</span><span class="p">()))</span> <span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">blocks</span><span class="p">)</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="n">blk</span><span class="o">.</span><span class="n">mgr_locs</span> <span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">blocks</span><span class="p">)</span>

        <span class="n">counter</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">count_level_2d</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">max_bin</span><span class="o">=</span><span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">blk</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">make_block</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">val</span><span class="p">),</span> <span class="n">loc</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_agged_blocks</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">blk</span><span class="p">))</span></div>


<span class="kn">from</span> <span class="nn">pandas.tools.plotting</span> <span class="kn">import</span> <span class="n">boxplot_frame_groupby</span>  <span class="c1"># noqa</span>
<span class="n">DataFrameGroupBy</span><span class="o">.</span><span class="n">boxplot</span> <span class="o">=</span> <span class="n">boxplot_frame_groupby</span>


<span class="k">class</span> <span class="nc">PanelGroupBy</span><span class="p">(</span><span class="n">NDFrameGroupBy</span><span class="p">):</span>

    <span class="nd">@Substitution</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;groupby&#39;</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">SelectionMixin</span><span class="o">.</span><span class="n">_see_also_template</span><span class="p">)</span>
    <span class="nd">@Appender</span><span class="p">(</span><span class="n">SelectionMixin</span><span class="o">.</span><span class="n">_agg_doc</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PanelGroupBy</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="k">def</span> <span class="nf">_iterate_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># kludge</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">slice_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="o">.</span><span class="n">items</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">slice_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection_list</span>
            <span class="n">slicer</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected_obj</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;axis other than 0 is not supported&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">slice_axis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclusions</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">yield</span> <span class="n">val</span><span class="p">,</span> <span class="n">slicer</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate using input function or dict of {column -&gt; function}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        arg : function or dict</span>
<span class="sd">            Function to use for aggregating groups. If a function, must either</span>
<span class="sd">            work when passed a Panel or when passed to Panel.apply. If</span>
<span class="sd">            pass a dict, the keys must be DataFrame column names</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aggregated : Panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">compat</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_generic</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_generic_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="n">new_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">axes</span>
            <span class="n">new_axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">axes</span>
            <span class="n">new_axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">Panel</span><span class="o">.</span><span class="n">_from_axes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">new_axes</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_aggregate_item_by_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_with_exclusions</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">itemg</span> <span class="o">=</span> <span class="n">DataFrameGroupBy</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">item</span><span class="p">],</span>
                                             <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                             <span class="n">grouper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="p">)</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">itemg</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="k">raise</span>
            <span class="n">new_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="n">new_axes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouper</span><span class="o">.</span><span class="n">result_index</span>
            <span class="k">return</span> <span class="n">Panel</span><span class="o">.</span><span class="n">_from_axes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">new_axes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;axis value must be greater than 0&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wrap_aggregated_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AbstractMethodError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">NDArrayGroupBy</span><span class="p">(</span><span class="n">GroupBy</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># Splitting / application</span>


<span class="k">class</span> <span class="nc">DataSplitter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">_ensure_int64</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span> <span class="o">=</span> <span class="n">ngroups</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">slabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sorted labels</span>
        <span class="k">return</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_nd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_idx</span><span class="p">,</span> <span class="n">allow_fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">sort_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Counting sort indexer</span>
        <span class="k">return</span> <span class="n">_get_group_index_sorter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sorted_data</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>

        <span class="n">starts</span><span class="p">,</span> <span class="n">ends</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">generate_slices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slabels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">)):</span>
            <span class="c1"># Since I&#39;m now compressing the group ids, it&#39;s now not &quot;possible&quot;</span>
            <span class="c1"># to produce empty slices because such groups would not be observed</span>
            <span class="c1"># in the data</span>
            <span class="c1"># if start &gt;= end:</span>
            <span class="c1">#     raise AssertionError(&#39;Start %s must be less than end %s&#39;</span>
            <span class="c1">#                          % (str(start), str(end)))</span>
            <span class="k">yield</span> <span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chop</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_sorted_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_idx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_chop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sdata</span><span class="p">,</span> <span class="n">slice_obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sdata</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">slice_obj</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AbstractMethodError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ArraySplitter</span><span class="p">(</span><span class="n">DataSplitter</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">SeriesSplitter</span><span class="p">(</span><span class="n">DataSplitter</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_chop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sdata</span><span class="p">,</span> <span class="n">slice_obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sdata</span><span class="o">.</span><span class="n">_get_values</span><span class="p">(</span><span class="n">slice_obj</span><span class="p">)</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">FrameSplitter</span><span class="p">(</span><span class="n">DataSplitter</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FrameSplitter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fast_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
        <span class="c1"># must return keys::list, values::list, mutated::bool</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">starts</span><span class="p">,</span> <span class="n">ends</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">generate_slices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slabels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngroups</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># fails when all -1</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="bp">True</span>

        <span class="n">sdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sorted_data</span><span class="p">()</span>
        <span class="n">results</span><span class="p">,</span> <span class="n">mutated</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">apply_frame_axis0</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">mutated</span>

    <span class="k">def</span> <span class="nf">_chop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sdata</span><span class="p">,</span> <span class="n">slice_obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sdata</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">slice_obj</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sdata</span><span class="o">.</span><span class="n">_slice</span><span class="p">(</span><span class="n">slice_obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ix[:, slice_obj]</span>


<span class="k">class</span> <span class="nc">NDFrameSplitter</span><span class="p">(</span><span class="n">DataSplitter</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NDFrameSplitter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_constructor</span>

    <span class="k">def</span> <span class="nf">_get_sorted_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># this is the BlockManager</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_data</span>

        <span class="c1"># this is sort of wasteful but...</span>
        <span class="n">sorted_axis</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_idx</span><span class="p">)</span>
        <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="n">sorted_axis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sorted_data</span>

    <span class="k">def</span> <span class="nf">_chop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sdata</span><span class="p">,</span> <span class="n">slice_obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">sdata</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="n">slice_obj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">get_splitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">SeriesSplitter</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">FrameSplitter</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">klass</span> <span class="o">=</span> <span class="n">NDFrameSplitter</span>

    <span class="k">return</span> <span class="n">klass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># Misc utilities</span>


<span class="k">def</span> <span class="nf">get_group_index</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">xnull</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the particular label_list, gets the offsets into the hypothetical list</span>
<span class="sd">    representing the totally ordered cartesian product of all possible label</span>
<span class="sd">    combinations, *as long as* this space fits within int64 bounds;</span>
<span class="sd">    otherwise, though group indices identify unique combinations of</span>
<span class="sd">    labels, they cannot be deconstructed.</span>
<span class="sd">    - If `sort`, rank of returned ids preserve lexical ranks of labels.</span>
<span class="sd">      i.e. returned id&#39;s can be used to do lexical sort on labels;</span>
<span class="sd">    - If `xnull` nulls (-1 labels) are passed through.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels: sequence of arrays</span>
<span class="sd">        Integers identifying levels at each location</span>
<span class="sd">    shape: sequence of ints same length as labels</span>
<span class="sd">        Number of unique levels at each location</span>
<span class="sd">    sort: boolean</span>
<span class="sd">        If the ranks of returned ids should match lexical ranks of labels</span>
<span class="sd">    xnull: boolean</span>
<span class="sd">        If true nulls are excluded. i.e. -1 values in the labels are</span>
<span class="sd">        passed through</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An array of type int64 where two elements are equal if their corresponding</span>
<span class="sd">    labels are equal at all location.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_int64_cut_off</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
        <span class="n">acc</span> <span class="o">=</span> <span class="nb">long</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mul</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
            <span class="n">acc</span> <span class="o">*=</span> <span class="nb">long</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">acc</span> <span class="o">&lt;</span> <span class="n">_INT64_MAX</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="c1"># how many levels can be done without overflow:</span>
        <span class="n">nlev</span> <span class="o">=</span> <span class="n">_int64_cut_off</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

        <span class="c1"># compute flat ids for the first `nlev` levels</span>
        <span class="n">stride</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">nlev</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">stride</span> <span class="o">*</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlev</span><span class="p">):</span>
            <span class="n">stride</span> <span class="o">//=</span> <span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">stride</span>

        <span class="k">if</span> <span class="n">xnull</span><span class="p">:</span>  <span class="c1"># exclude nulls</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">nlev</span><span class="p">]:</span>
                <span class="n">mask</span> <span class="o">|=</span> <span class="n">lab</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">out</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">nlev</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>  <span class="c1"># all levels done!</span>
            <span class="k">return</span> <span class="n">out</span>

        <span class="c1"># compress what has been done so far in order to avoid overflow</span>
        <span class="c1"># to retain lexical ranks, obs_ids should be sorted</span>
        <span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_ids</span> <span class="o">=</span> <span class="n">_compress_group_index</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">)</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">comp_ids</span><span class="p">]</span> <span class="o">+</span> <span class="n">labels</span><span class="p">[</span><span class="n">nlev</span><span class="p">:]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">obs_ids</span><span class="p">)]</span> <span class="o">+</span> <span class="n">shape</span><span class="p">[</span><span class="n">nlev</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">loop</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">maybe_lift</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>  <span class="c1"># pormote nan values</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">lab</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">lab</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">_ensure_int64</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xnull</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">maybe_lift</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">loop</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>


<span class="n">_INT64_MAX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>


<span class="k">def</span> <span class="nf">_int64_overflow_possible</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">the_prod</span> <span class="o">=</span> <span class="nb">long</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">:</span>
        <span class="n">the_prod</span> <span class="o">*=</span> <span class="nb">long</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">the_prod</span> <span class="o">&gt;=</span> <span class="n">_INT64_MAX</span>


<span class="k">def</span> <span class="nf">decons_group_index</span><span class="p">(</span><span class="n">comp_labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
    <span class="c1"># reconstruct labels</span>
    <span class="k">if</span> <span class="n">_int64_overflow_possible</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
        <span class="c1"># at some point group indices are factorized,</span>
        <span class="c1"># and may not be deconstructed here! wrong path!</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot deconstruct factorized group indices!&#39;</span><span class="p">)</span>

    <span class="n">label_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">comp_labels</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">))):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">factor</span> <span class="o">*</span> <span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">//</span> <span class="n">factor</span>
        <span class="n">np</span><span class="o">.</span><span class="n">putmask</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">comp_labels</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">label_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="n">factor</span> <span class="o">*=</span> <span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">label_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">decons_obs_group_ids</span><span class="p">(</span><span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_ids</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">xnull</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    reconstruct labels from observed group ids</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xnull: boolean,</span>
<span class="sd">        if nulls are excluded; i.e. -1 labels are passed through</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pandas.hashtable</span> <span class="kn">import</span> <span class="n">unique_label_indices</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">xnull</span><span class="p">:</span>
        <span class="n">lift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(((</span><span class="n">a</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">lift</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">_int64_overflow_possible</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
        <span class="c1"># obs ids are deconstructable! take the fast route!</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">decons_group_index</span><span class="p">(</span><span class="n">obs_ids</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span> <span class="k">if</span> <span class="n">xnull</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">lift</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> \
            <span class="k">else</span> <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">lift</span><span class="p">)]</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">unique_label_indices</span><span class="p">(</span><span class="n">comp_ids</span><span class="p">)</span>
    <span class="n">i8copy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">i8copy</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_indexer_from_factorized</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="n">get_group_index</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">xnull</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">compress</span><span class="p">:</span>
        <span class="n">ngroups</span> <span class="o">=</span> <span class="p">(</span><span class="n">ids</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="n">ids</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ids</span><span class="p">,</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">_compress_group_index</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ngroups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_get_group_index_sorter</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_lexsort_indexer</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_position</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="n">orders</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">orders</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">orders</span><span class="p">):</span>

        <span class="c1"># we are already a Categorical</span>
        <span class="k">if</span> <span class="n">is_categorical_dtype</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">key</span>

        <span class="c1"># create the Categorical</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">na_position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid na_position: {!r}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na_position</span><span class="p">))</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">codes</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order</span><span class="p">:</span>  <span class="c1"># ascending</span>
            <span class="k">if</span> <span class="n">na_position</span> <span class="o">==</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span>
                <span class="n">codes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">na_position</span> <span class="o">==</span> <span class="s1">&#39;first&#39;</span><span class="p">:</span>
                <span class="n">codes</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># not order means descending</span>
            <span class="k">if</span> <span class="n">na_position</span> <span class="o">==</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span>
                <span class="n">codes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">codes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">na_position</span> <span class="o">==</span> <span class="s1">&#39;first&#39;</span><span class="p">:</span>
                <span class="n">codes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">codes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">codes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_indexer_from_factorized</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_nargsort</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;quicksort&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">na_position</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is intended to be a drop-in replacement for np.argsort which</span>
<span class="sd">    handles NaNs. It adds ascending and na_position parameters.</span>
<span class="sd">    GH #6399, #5231</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># specially handle Categorical</span>
    <span class="k">if</span> <span class="n">is_categorical_dtype</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>

    <span class="n">items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">isnull</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="n">non_nans</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">non_nan_idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">nan_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ascending</span><span class="p">:</span>
        <span class="n">non_nans</span> <span class="o">=</span> <span class="n">non_nans</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">non_nan_idx</span> <span class="o">=</span> <span class="n">non_nan_idx</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">indexer</span> <span class="o">=</span> <span class="n">non_nan_idx</span><span class="p">[</span><span class="n">non_nans</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ascending</span><span class="p">:</span>
        <span class="n">indexer</span> <span class="o">=</span> <span class="n">indexer</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Finally, place the NaNs at the end or the beginning according to</span>
    <span class="c1"># na_position</span>
    <span class="k">if</span> <span class="n">na_position</span> <span class="o">==</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span>
        <span class="n">indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">indexer</span><span class="p">,</span> <span class="n">nan_idx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">na_position</span> <span class="o">==</span> <span class="s1">&#39;first&#39;</span><span class="p">:</span>
        <span class="n">indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">nan_idx</span><span class="p">,</span> <span class="n">indexer</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid na_position: {!r}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na_position</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">indexer</span>


<span class="k">class</span> <span class="nc">_KeyMapper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ease my suffering. Map compressed group id -&gt; key tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp_ids</span> <span class="o">=</span> <span class="n">comp_ids</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="n">_hash</span><span class="o">.</span><span class="n">Int64HashTable</span><span class="p">(</span><span class="n">ngroups</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tables</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populate_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">labs</span><span class="p">,</span> <span class="n">table</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comp_ids</span><span class="p">,</span> <span class="n">labs</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_id</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">level</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="n">comp_id</span><span class="p">)]</span>
                     <span class="k">for</span> <span class="n">table</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_get_indices_dict</span><span class="p">(</span><span class="n">label_list</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">keys</span><span class="p">))</span>

    <span class="n">group_index</span> <span class="o">=</span> <span class="n">get_group_index</span><span class="p">(</span><span class="n">label_list</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">xnull</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ngroups</span> <span class="o">=</span> <span class="p">((</span><span class="n">group_index</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="n">group_index</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> \
        <span class="k">if</span> <span class="n">_int64_overflow_possible</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> \
        <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>

    <span class="n">sorter</span> <span class="o">=</span> <span class="n">_get_group_index_sorter</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">)</span>

    <span class="n">sorted_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">lab</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">sorter</span><span class="p">)</span> <span class="k">for</span> <span class="n">lab</span> <span class="ow">in</span> <span class="n">label_list</span><span class="p">]</span>
    <span class="n">group_index</span> <span class="o">=</span> <span class="n">group_index</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">sorter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lib</span><span class="o">.</span><span class="n">indices_fast</span><span class="p">(</span><span class="n">sorter</span><span class="p">,</span> <span class="n">group_index</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">sorted_labels</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># sorting levels...cleverly?</span>

<span class="k">def</span> <span class="nf">_get_group_index_sorter</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="n">ngroups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    _algos.groupsort_indexer implements `counting sort` and it is at least</span>
<span class="sd">    O(ngroups), where</span>
<span class="sd">        ngroups = prod(shape)</span>
<span class="sd">        shape = map(len, keys)</span>
<span class="sd">    that is, linear in the number of combinations (cartesian product) of unique</span>
<span class="sd">    values of groupby keys. This can be huge when doing multi-key groupby.</span>
<span class="sd">    np.argsort(kind=&#39;mergesort&#39;) is O(count x log(count)) where count is the</span>
<span class="sd">    length of the data-frame;</span>
<span class="sd">    Both algorithms are `stable` sort and that is necessary for correctness of</span>
<span class="sd">    groupby operations. e.g. consider:</span>
<span class="sd">        df.groupby(key)[col].transform(&#39;first&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_index</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># taking complexities literally; there may be</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># some room for fine-tuning these parameters</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">ngroups</span> <span class="o">&lt;</span> <span class="n">count</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
        <span class="n">sorter</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_algos</span><span class="o">.</span><span class="n">groupsort_indexer</span><span class="p">(</span><span class="n">_ensure_int64</span><span class="p">(</span><span class="n">group_index</span><span class="p">),</span>
                                             <span class="n">ngroups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_ensure_platform_int</span><span class="p">(</span><span class="n">sorter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">group_index</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_compress_group_index</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Group_index is offsets into cartesian product of all possible labels. This</span>
<span class="sd">    space can be huge, so this function compresses it, by computing offsets</span>
<span class="sd">    (comp_ids) into the list of unique labels (obs_group_ids).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">size_hint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_index</span><span class="p">),</span> <span class="n">_hash</span><span class="o">.</span><span class="n">_SIZE_HINT_LIMIT</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">_hash</span><span class="o">.</span><span class="n">Int64HashTable</span><span class="p">(</span><span class="n">size_hint</span><span class="p">)</span>

    <span class="n">group_index</span> <span class="o">=</span> <span class="n">_ensure_int64</span><span class="p">(</span><span class="n">group_index</span><span class="p">)</span>

    <span class="c1"># note, group labels come out ascending (ie, 1,2,3 etc)</span>
    <span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_group_ids</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">get_labels_groupby</span><span class="p">(</span><span class="n">group_index</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sort</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs_group_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">obs_group_ids</span><span class="p">,</span> <span class="n">comp_ids</span> <span class="o">=</span> <span class="n">_reorder_by_uniques</span><span class="p">(</span><span class="n">obs_group_ids</span><span class="p">,</span> <span class="n">comp_ids</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">comp_ids</span><span class="p">,</span> <span class="n">obs_group_ids</span>


<span class="k">def</span> <span class="nf">_reorder_by_uniques</span><span class="p">(</span><span class="n">uniques</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="c1"># sorter is index where elements ought to go</span>
    <span class="n">sorter</span> <span class="o">=</span> <span class="n">uniques</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>

    <span class="c1"># reverse_indexer is where elements came from</span>
    <span class="n">reverse_indexer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorter</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">reverse_indexer</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">sorter</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorter</span><span class="p">)))</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="c1"># move labels to right locations (ie, unsort ascending labels)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_nd</span><span class="p">(</span><span class="n">reverse_indexer</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">allow_fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">putmask</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># sort observed ids</span>
    <span class="n">uniques</span> <span class="o">=</span> <span class="n">algos</span><span class="o">.</span><span class="n">take_nd</span><span class="p">(</span><span class="n">uniques</span><span class="p">,</span> <span class="n">sorter</span><span class="p">,</span> <span class="n">allow_fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">uniques</span><span class="p">,</span> <span class="n">labels</span>


<span class="k">def</span> <span class="nf">_groupby_indices</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">is_categorical_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>

        <span class="c1"># we have a categorical, so we can do quite a bit</span>
        <span class="c1"># bit better than factorizing again</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">categories</span><span class="p">))</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">_hash</span><span class="o">.</span><span class="n">value_count_int64</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reverse</span><span class="p">,</span> <span class="n">codes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">_algos</span><span class="o">.</span><span class="n">group_labels</span><span class="p">(</span>
            <span class="n">_values_from_object</span><span class="p">(</span><span class="n">_ensure_object</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">_algos</span><span class="o">.</span><span class="n">groupby_indices</span><span class="p">(</span><span class="n">reverse</span><span class="p">,</span> <span class="n">codes</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">numpy_groupby</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">keys</span><span class="p">,</span> <span class="n">inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">groups_at</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ordered_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">group_sums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">ordered_data</span><span class="p">,</span> <span class="n">groups_at</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">group_sums</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>